/**
 * @license almond 0.3.3 Copyright jQuery Foundation and other contributors.
 * Released under MIT license, http://github.com/requirejs/almond/LICENSE
 */

/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */

// Snap.svg 0.4.1
//
// Copyright (c) 2013 – 2015 Adobe Systems Incorporated. All rights reserved.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//
// build: 2015-04-13

// Copyright (c) 2013 Adobe Systems Incorporated. All rights reserved.
// 
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
// 
// http://www.apache.org/licenses/LICENSE-2.0
// 
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
// ┌────────────────────────────────────────────────────────────┐ \\
// │ Eve 0.4.2 - JavaScript Events Library                      │ \\
// ├────────────────────────────────────────────────────────────┤ \\
// │ Author Dmitry Baranovskiy (http://dmitry.baranovskiy.com/) │ \\
// └────────────────────────────────────────────────────────────┘ \\

// Copyright (c) 2013 Adobe Systems Incorporated. All rights reserved.
// 
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
// 
// http://www.apache.org/licenses/LICENSE-2.0
// 
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// Copyright (c) 2013 - 2015 Adobe Systems Incorporated. All rights reserved.
// 
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
// 
// http://www.apache.org/licenses/LICENSE-2.0
// 
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// Copyright (c) 2013 Adobe Systems Incorporated. All rights reserved.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// Copyright (c) 2014 Adobe Systems Incorporated. All rights reserved.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

/*!
 *
 * Copyright 2009-2017 Kris Kowal under the terms of the MIT
 * license found at https://github.com/kriskowal/q/blob/v1/LICENSE
 *
 * With parts by Tyler Close
 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
 * at http://www.opensource.org/licenses/mit-license.html
 * Forked at ref_send.js version: 2009-05-11
 *
 * With parts by Mark Miller
 * Copyright (C) 2011 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */

/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */

!function(t,e){"function"==typeof define&&define.amd?define(e):t.sd=e()}("undefined"!=typeof window?window:this,function(){var t,e,n;!function(r){function i(t,e){return w.call(t,e)}function o(t,e){var n,r,i,o,s,a,u,l,c,h,f,p,d=e&&e.split("/"),v=x.map,m=v&&v["*"]||{};if(t){for(t=t.split("/"),s=t.length-1,x.nodeIdCompat&&S.test(t[s])&&(t[s]=t[s].replace(S,"")),"."===t[0].charAt(0)&&d&&(p=d.slice(0,d.length-1),t=p.concat(t)),c=0;c<t.length;c++)if(f=t[c],"."===f)t.splice(c,1),c-=1;else if(".."===f){if(0===c||1===c&&".."===t[2]||".."===t[c-1])continue;c>0&&(t.splice(c-1,2),c-=2)}t=t.join("/")}if((d||m)&&v){for(n=t.split("/"),c=n.length;c>0;c-=1){if(r=n.slice(0,c).join("/"),d)for(h=d.length;h>0;h-=1)if(i=v[d.slice(0,h).join("/")],i&&(i=i[r])){o=i,a=c;break}if(o)break;!u&&m&&m[r]&&(u=m[r],l=c)}!o&&u&&(o=u,a=l),o&&(n.splice(0,a,o),t=n.join("/"))}return t}function s(t,e){return function(){var n=k.call(arguments,0);return"string"!=typeof n[0]&&1===n.length&&n.push(null),d.apply(r,n.concat([t,e]))}}function a(t){return function(e){return o(e,t)}}function u(t){return function(e){g[t]=e}}function l(t){if(i(y,t)){var e=y[t];delete y[t],b[t]=!0,p.apply(r,e)}if(!i(g,t)&&!i(b,t))throw new Error("No "+t);return g[t]}function c(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function h(t){return t?c(t):[]}function f(t){return function(){return x&&x.config&&x.config[t]||{}}}var p,d,v,m,g={},y={},x={},b={},w=Object.prototype.hasOwnProperty,k=[].slice,S=/\.js$/;v=function(t,e){var n,r=c(t),i=r[0],s=e[1];return t=r[1],i&&(i=o(i,s),n=l(i)),i?t=n&&n.normalize?n.normalize(t,a(s)):o(t,s):(t=o(t,s),r=c(t),i=r[0],t=r[1],i&&(n=l(i))),{f:i?i+"!"+t:t,n:t,pr:i,p:n}},m={require:function(t){return s(t)},exports:function(t){var e=g[t];return"undefined"!=typeof e?e:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:f(t)}}},p=function(t,e,n,o){var a,c,f,p,d,x,w,k=[],S=typeof n;if(o=o||t,x=h(o),"undefined"===S||"function"===S){for(e=!e.length&&n.length?["require","exports","module"]:e,d=0;d<e.length;d+=1)if(p=v(e[d],x),c=p.f,"require"===c)k[d]=m.require(t);else if("exports"===c)k[d]=m.exports(t),w=!0;else if("module"===c)a=k[d]=m.module(t);else if(i(g,c)||i(y,c)||i(b,c))k[d]=l(c);else{if(!p.p)throw new Error(t+" missing "+c);p.p.load(p.n,s(o,!0),u(c),{}),k[d]=g[c]}f=n?n.apply(g[t],k):void 0,t&&(a&&a.exports!==r&&a.exports!==g[t]?g[t]=a.exports:f===r&&w||(g[t]=f))}else t&&(g[t]=n)},t=e=d=function(t,e,n,i,o){if("string"==typeof t)return m[t]?m[t](e):l(v(t,h(e)).f);if(!t.splice){if(x=t,x.deps&&d(x.deps,x.callback),!e)return;e.splice?(t=e,e=n,n=null):t=r}return e=e||function(){},"function"==typeof n&&(n=i,i=o),i?p(r,t,e,n):setTimeout(function(){p(r,t,e,n)},4),d},d.config=function(t){return d(t)},t._defined=g,n=function(t,e,n){if("string"!=typeof t)throw new Error("See almond README: incorrect module build, no module name");e.splice||(n=e,e=[]),i(g,t)||i(y,t)||(y[t]=[t,e,n])},n.amd={jQuery:!0}}(),n("../bower_components/almond/almond",function(){}),n("common",["require","exports"],function(t,e){"use strict";var n=function(){function t(){}return t.ERR_VERSION="bad xml or unknown smile version",t.ERR_BAD_TIME="bad time (control) data",t}();e.Errors=n,e.builtins={max:{},min:{},pulse:{usesTime:!0}},e.reserved={if:!0,then:!0,else:!0}}),n("xmile",["require","exports"],function(t,e){"use strict";function n(t){for(var e=0;(e=t.indexOf("_"))>=0&&e<t.length-1;)t=t.slice(0,e)+t.slice(e+1,e+2).toUpperCase()+t.slice(e+2);return t}function r(t){return t.split(",").map(function(t){return t.trim()})}function i(t){return t.map(function(t){return parseFloat(t)})}function o(t){return 0|t}function s(t,e){for(var n=0;n<t.attributes.length;n++){var r=t.attributes.item(n);if(r.name.toLowerCase()===e)return r.value}return null}function a(t){var e="";if(t.hasChildNodes())for(var n=0;n<t.childNodes.length;n++){var r=t.childNodes.item(n);switch(r.nodeType){case 3:e+=r.nodeValue.trim();break;case 4:e+=r.nodeValue}}return e}function u(t){if("undefined"==typeof t||null===t)return[0,null];if("number"==typeof t)return[t,null];var e=parseFloat(t);return isFinite(e)?[e,null]:[NaN,new h("not number: "+t)]}function l(t){if("undefined"==typeof t||null===t)return[!1,null];if("boolean"==typeof t)return[t,null];if("string"==typeof t){if("true"===t)return[!0,null];if("false"===t)return[!1,null]}return[!1,new h("not boolean: "+t)]}function c(t){var e=!1;if(t.length>1){var n=t.slice(0,1),r=t.slice(t.length-1);e='"'===n&&'"'===r}return t=t.toLowerCase(),t=t.replace(/\\n/g,"_"),t=t.replace(/\\\\/g,"\\"),t=t.replace(/\\"/g,"\\"),t=t.replace(/[_\r\n\t \xa0]+/g,"_"),e?t.slice(1,-1):t}e.camelCase=n,e.splitOnComma=r,e.numberize=i,e.i32=o;var h=function(){function t(t){this.error=t}return t}();e.Error=h;var f=function(){function t(){}return t.Build=function(e){for(var n,r=new t,i=0;i<e.attributes.length;i++){var o=e.attributes.item(i);switch(o.name.toLowerCase()){case"x":if(s=u(o.value),r.x=s[0],n=s[1],n)return[null,new h("x not num: "+n.error)];break;case"y":if(a=u(o.value),r.y=a[0],n=a[1],n)return[null,new h("y not num: "+n.error)]}}return[r,n];var s,a},t.prototype.toXml=function(t,e){return!0},t}();e.Point=f;var p=function(){function t(t){}return t.prototype.toXml=function(t,e){return!0},t}();e.Size=p;var d=function(){function t(t){}return t.prototype.toXml=function(t,e){return!0},t}();e.Rect=d;var v=function(){function t(){this.namespace="https://docs.oasis-open.org/xmile/ns/XMILE/v1.0",this.dimensions=[],this.units=[],this.models=[]}return t.Build=function(e){for(var n=new t,r=null,i=0;i<e.attributes.length;i++){var o=e.attributes.item(i);switch(o.name.toLowerCase()){case"version":n.version=o.value;break;case"xmlns":n.namespace=o.value}}for(var i=0;i<e.childNodes.length;i++){var s=void 0,a=e.childNodes.item(i);if(1===a.nodeType)switch(a.nodeName.toLowerCase()){case"header":if(u=x.Build(a),n.header=u[0],r=u[1],r)return[null,new h("Header: "+r.error)];break;case"sim_specs":if(l=m.Build(a),n.simSpec=l[0],r=l[1],r)return[null,new h("SimSpec: "+r.error)];break;case"model":if(c=_.Build(a),s=c[0],r=c[1],r)return[null,new h("SimSpec: "+r.error)];n.models.push(s)}}return[n,r];var u,l,c},t.prototype.toXml=function(t,e){return!0},t}();e.File=v;var m=function(){function t(){this.start=0,this.stop=1,this.dt=1,this.saveStep=0,this.method="euler",this.timeUnits=""}return t.Build=function(e){for(var r,i=new t,o=0;o<e.childNodes.length;o++){var l=e.childNodes.item(o);if(1===l.nodeType){var c=n(l.nodeName.toLowerCase());if("savestep"===c&&(c="saveStep"),i.hasOwnProperty(c))if("method"===c||"timeUnits"===c)i[c]=a(l).toLowerCase();else{if(f=u(a(l)),i[c]=f[0],r=f[1],r)return[null,new h(l.nodeName+": "+r.error)];"dt"===c&&"true"===s(l,"reciprocal")&&(i.dtReciprocal=i.dt,i.dt=1/i.dt)}}}switch(i.saveStep||(i.saveStep=i.dt),i.method){case"euler":break;case"rk4":case"rk2":case"rk45":case"gear":console.log("valid but unsupported integration method: "+i.method+". using euler"),i.method="euler";break;default:return[null,new h("unknown integration method "+i.method)]}return[i,null];var f},t.prototype.toXml=function(t,e){return!0},t}();e.SimSpec=m;var g=function(){function t(t){}return t.prototype.toXml=function(t,e){return!0},t}();e.Unit=g;var y=function(){function t(){this.name="unknown",this.lang="English",this.version=""}return t.Build=function(e){var n=new t;n.name=a(e);for(var r=0;r<e.attributes.length;r++){var i=e.attributes.item(r);switch(i.name.toLowerCase()){case"version":n.version=i.value;break;case"lang":n.lang=i.value}}return[n,null]},t.prototype.toXml=function(t,e){return!0},t}();e.Product=y;var x=function(){function t(){}return t.Build=function(e){for(var n,r=new t,i=0;i<e.childNodes.length;i++){var o=e.childNodes.item(i);if(1===o.nodeType)switch(o.nodeName.toLowerCase()){case"vendor":r.vendor=a(o);break;case"product":if(s=y.Build(o),r.product=s[0],n=s[1],n)return[null,new h("Product: "+n.error)];break;case"options":if(u=w.Build(o),r.options=u[0],n=u[1],n)return[null,new h("Options: "+n.error)];break;case"name":r.name=a(o);break;case"version":r.version=a(o);break;case"caption":r.caption=a(o);break;case"author":r.author=a(o);break;case"affiliation":r.affiliation=a(o);break;case"client":r.client=a(o);break;case"copyright":r.copyright=a(o);break;case"created":r.created=a(o);break;case"modified":r.modified=a(o);break;case"uuid":r.uuid=a(o)}}return[r,n];var s,u},t.prototype.toXml=function(t,e){return!0},t}();e.Header=x;var b=function(){function t(){this.name="",this.size=""}return t.Build=function(e){var n=new t;return[n,null]},t.prototype.toXml=function(t,e){return!0},t}();e.Dimension=b;var w=function(){function t(){this.namespaces=[],this.usesArrays=!1,this.usesMacros=!1,this.usesConveyor=!1,this.usesQueue=!1,this.usesSubmodels=!1,this.usesEventPosters=!1,this.hasModelView=!1,this.usesOutputs=!1,this.usesInputs=!1,this.usesAnnotation=!1,this.maximumDimensions=1,this.invalidIndexValue=0,this.recursiveMacros=!1,this.optionFilters=!1,this.arrest=!1,this.leak=!1,this.overflow=!1,this.messages=!1,this.numericDisplay=!1,this.lamp=!1,this.gauge=!1,this.numericInput=!1,this.list=!1,this.graphicalInput=!1}return t.Build=function(e){for(var i,a=new t,l=0;l<e.attributes.length;l++){var c=e.attributes.item(l);switch(c.name.toLowerCase()){case"namespace":a.namespaces=r(c.value)}}for(var l=0;l<e.childNodes.length;l++){var h=e.childNodes.item(l);if(1===h.nodeType){var f=h.nodeName.toLowerCase(),p=void 0;if("uses_"===f.slice(0,5)?p=4:"has_"!==f.substring(0,4)&&(p=3),p&&(f=n(f),a.hasOwnProperty(f)&&(a[f]=!0,"usesArrays"===f))){var d=void 0;if(d=s(h,"maximum_dimensions")){var v=void 0;m=u(d),v=m[0],i=m[1],i&&(console.log("bad max_dimensions( "+d+"): "+i.error),v=1),v!==o(v)&&console.log("non-int max_dimensions: "+d),a.maximumDimensions=o(v)}d=s(h,"invalid_index_value"),"NaN"===d&&(a.invalidIndexValue=NaN)}}}return[a,i];var m},t.prototype.toXml=function(t,e){return!0},t}();e.Options=w;var k=function(){function t(){this.allNonNegative=!1,this.stockNonNegative=!1,this.flowNonNegative=!1}return t.Build=function(e){var n=new t;return[n,null]},t.prototype.toXml=function(t,e){return!0},t}();e.Behavior=k;var S=function(){function t(t){}return t.prototype.toXml=function(t,e){return!0},t}();e.Style=S;var T=function(){function t(t){}return t.prototype.toXml=function(t,e){return!0},t}();e.Data=T;var _=function(){function t(){this.name="",this.run=!1,this.variables=[],this.views=[]}return t.Build=function(e){for(var n,r=new t,i=0;i<e.attributes.length;i++){var o=e.attributes.item(i);switch(o.name.toLowerCase()){case"name":r.name=o.value}}for(var i=0;i<e.childNodes.length;i++){var s=e.childNodes.item(i);if(1===s.nodeType)switch(s.nodeName.toLowerCase()){case"variables":for(var a=0;a<s.childNodes.length;a++){var u=s.childNodes.item(a);if(1===u.nodeType){var l=void 0;if(f=P.Build(u),l=f[0],n=f[1],n)return[null,new h(s.nodeName+" var: "+n.error)];r.variables.push(l)}}break;case"views":for(var a=0;a<s.childNodes.length;a++){var u=s.childNodes.item(a);if(1===u.nodeType&&"view"===u.nodeName.toLowerCase()){var c=void 0;if(p=O.Build(u),c=p[0],n=p[1],n)return[null,new h("view: "+n.error)];r.views.push(c)}}}}return[r,null];var f,p},Object.defineProperty(t.prototype,"ident",{get:function(){return c(this.name)},enumerable:!0,configurable:!0}),t.prototype.toXml=function(t,e){return!0},t}();e.Model=_;var C=function(){function t(){this.subscript=[]}return t.Build=function(e){var n=new t;return console.log("TODO: array element"),[n,null]},t.prototype.toXml=function(t,e){return!0},t}();e.ArrayElement=C;var N=function(){function t(){}return t.Build=function(e){var n=new t;return console.log("TODO: range element"),[n,null]},t.prototype.toXml=function(t,e){return!0},t}();e.Range=N;var E=function(){function t(){this.precision="",this.scaleBy="1",this.displayAs="number",this.delimit000s=!1}return t.Build=function(e){var n=new t;return console.log("TODO: format element"),[n,null]},t.prototype.toXml=function(t,e){return!0},t}();e.Format=E;var P=function(){function t(){this.eqn=""}return t.Build=function(e){var n,r=new t;r.type=e.nodeName.toLowerCase();for(var i=0;i<e.attributes.length;i++){var o=e.attributes.item(i);switch(o.name.toLowerCase()){case"name":r.name=o.value;break;case"resource":r.resource=o.value}}for(var i=0;i<e.childNodes.length;i++){var s=e.childNodes.item(i);if(1===s.nodeType)switch(s.nodeName.toLowerCase()){case"eqn":r.eqn=a(s);break;case"inflow":r.inflows||(r.inflows=[]),r.inflows.push(c(a(s)));break;case"outflow":r.outflows||(r.outflows=[]),r.outflows.push(c(a(s)));break;case"gf":if(l=M.Build(s),r.gf=l[0],n=l[1],n)return[null,new h(r.name+" GF: "+n.error)];break;case"connect":var u=void 0;if(f=L.Build(s),u=f[0],n=f[1],n)return[null,new h(r.name+" conn: "+n.error)];r.connections||(r.connections=[]),r.connections.push(u)}}return[r,n];var l,f},Object.defineProperty(t.prototype,"ident",{get:function(){return c(this.name)},enumerable:!0,configurable:!0}),t.prototype.toXml=function(t,e){return!0},t}();e.Variable=P;var j=function(){function t(){}return t.Build=function(e){for(var n,r=new t,i=0;i<e.attributes.length;i++){var o=e.attributes.item(i);switch(o.name.toLowerCase()){case"type":if(r.type=o.value.toLowerCase(),!(r.type in t.Types))return[null,new h("bad type: "+r.type)];break;case"width":if(s=u(o.value),r.width=s[0],n=s[1],n)return[null,new h("bad width: "+n.error)];break;case"height":if(a=u(o.value),r.height=a[0],n=a[1],n)return[null,new h("bad height: "+n.error)];break;case"radius":if(l=u(o.value),r.radius=l[0],n=l[1],n)return[null,new h("bad radius: "+n.error)]}}return[r,n];var s,a,l},t.prototype.toXml=function(t,e){return!0},t.Types=["rectangle","circle","name_only"],t}();e.Shape=j;var A=function(){function t(){}return t.Build=function(e){var n,r=new t;r.type=e.nodeName.toLowerCase();for(var i=0;i<e.attributes.length;i++){var o=e.attributes.item(i);switch(o.name.toLowerCase()){case"name":r.name=o.value;break;case"x":if(v=u(o.value),r.x=v[0],n=v[1],n)return[null,new h("x: "+n.error)];break;case"y":if(m=u(o.value),r.y=m[0],n=m[1],n)return[null,new h("y: "+n.error)];break;case"width":if(g=u(o.value),r.width=g[0],n=g[1],n)return[null,new h("width: "+n.error)];break;case"height":if(y=u(o.value),r.height=y[0],n=y[1],n)return[null,new h("height: "+n.error)];break;case"label_side":r.labelSide=o.value.toLowerCase();break;case"label_angle":if(x=u(o.value),r.labelAngle=x[0],n=x[1],n)return[null,new h("label_angle: "+n.error)];break;case"color":r.color=o.value.toLowerCase();break;case"angle":if(b=u(o.value),r.angle=b[0],n=b[1],n)return[null,new h("angle: "+n.error)]}}for(var i=0;i<e.childNodes.length;i++){var s=e.childNodes.item(i);if(1===s.nodeType)switch(s.nodeName.toLowerCase()){case"to":r.to=c(a(s));break;case"from":r.from=c(a(s));break;case"of":r.of=c(a(s));break;case"pts":for(var l=0;l<s.childNodes.length;l++){var p=s.childNodes.item(l);if(1===p.nodeType&&"pt"===p.nodeName.toLowerCase()){var d=void 0;if(w=f.Build(p),d=w[0],n=w[1],n)return[null,new h("pt: "+n.error)];"undefined"==typeof r.pts&&(r.pts=[]),r.pts.push(d)}}break;case"shape":if(k=j.Build(s),r.shape=k[0],n=k[1],n)return[null,new h("shape: "+n.error)]}}return[r,n];var v,m,g,y,x,b,w,k},Object.defineProperty(t.prototype,"ident",{get:function(){return c(this.name)},enumerable:!0,configurable:!0}),t.prototype.toXml=function(t,e){return!0},t}();e.ViewElement=A;var O=function(){function t(){this.type="stock_flow",this.zoom=100,this.scrollX=0,this.scrollY=0,this.homePage=0,this.homeView=!1,this.elements=[]}return t.Build=function(e){for(var n,r=new t,i=0;i<e.attributes.length;i++){var o=e.attributes.item(i);switch(o.name.toLowerCase()){case"type":r.type=o.value.toLowerCase();break;case"order":if(c=u(o.value),r.order=c[0],n=c[1],n)return[null,new h("order: "+n.error)];break;case"width":if(f=u(o.value),r.width=f[0],n=f[1],n)return[null,new h("width: "+n.error)];break;case"height":if(p=u(o.value),r.height=p[0],n=p[1],n)return[null,new h("height: "+n.error)];break;case"zoom":if(d=u(o.value),r.zoom=d[0],n=d[1],n)return[null,new h("zoom: "+n.error)];break;case"scroll_x":if(v=u(o.value),r.scrollX=v[0],n=v[1],n)return[null,new h("scroll_x: "+n.error)];break;case"scroll_y":if(m=u(o.value),r.scrollY=m[0],n=m[1],n)return[null,new h("scroll_y: "+n.error)];break;case"background":r.background=o.value.toLowerCase();break;case"page_width":if(g=u(o.value),r.pageWidth=g[0],n=g[1],n)return[null,new h("page_width: "+n.error)];break;case"page_height":if(y=u(o.value),r.pageHeight=y[0],n=y[1],n)return[null,new h("page_height: "+n.error)];break;case"page_sequence":r.pageSequence=o.value.toLowerCase();break;case"page_orientation":r.pageOrientation=o.value.toLowerCase();break;case"show_pages":if(x=l(o.value),r.showPages=x[0],n=x[1],n)return[null,new h("show_pages: "+n.error)];break;case"home_page":if(b=u(o.value),r.homePage=b[0],n=b[1],n)return[null,new h("home_page: "+n.error)];break;case"home_view":if(w=l(o.value),r.homeView=w[0],n=w[1],n)return[null,new h("home_view: "+n.error)]}}for(var i=0;i<e.childNodes.length;i++){var s=e.childNodes.item(i);if(1===s.nodeType){var a=void 0;if(k=A.Build(s),a=k[0],n=k[1],n)return[null,new h("viewEl: "+n.error)];r.elements.push(a)}}return[r,n];var c,f,p,d,v,m,g,y,x,b,w,k},t.prototype.toXml=function(t,e){return!0},t}();e.View=O;var M=function(){function t(){this.type="continuous"}return t.Build=function(e){for(var n,o=new t,s=0;s<e.attributes.length;s++){var u=e.attributes.item(s);switch(u.name.toLowerCase()){case"type":if(o.type=u.value.toLowerCase(),!(o.type in t.Types))return[null,new h("bad type: "+o.type)]}}for(var s=0;s<e.childNodes.length;s++){var l=e.childNodes.item(s);if(1===l.nodeType)switch(l.nodeName.toLowerCase()){case"xscale":if(c=R.Build(l),o.xScale=c[0],n=c[1],n)return[null,new h("xscale: "+n.error)];break;case"yscale":if(f=R.Build(l),o.yScale=f[0],n=f[1],n)return[null,new h("yscale: "+n.error)];break;case"xpts":o.xPoints=i(r(a(l)));break;case"ypts":o.yPoints=i(r(a(l)))}}return o.yPoints?("continuous"!==o.type&&console.log("WARN: unimplemented table type: "+o.type),[o,n]):[null,new h("table missing ypts")];var c,f},t.prototype.toXml=function(t,e){return!0},t.Types=["continuous","extrapolate","discrete"],t}();e.GF=M;var R=function(){function t(){}return t.Build=function(e){for(var n,r=new t,i=0;i<e.attributes.length;i++){var o=e.attributes.item(i);switch(o.name.toLowerCase()){case"min":if(s=u(o.value),r.min=s[0],n=s[1],n)return[null,new h("bad min: "+o.value)];break;case"max":if(a=u(o.value),r.max=a[0],n=a[1],n)return[null,new h("bad max: "+o.value)]}}return r.hasOwnProperty("min")&&r.hasOwnProperty("max")?[r,null]:[null,new h("scale requires both min and max")];var s,a},t.prototype.toXml=function(t,e){return!0},t}();e.Scale=R;var L=function(){function t(){}return t.Build=function(e){for(var n=new t,r=0;r<e.attributes.length;r++){var i=e.attributes.item(r);switch(i.name.toLowerCase()){case"to":n.to=c(i.value);break;case"from":n.from=c(i.value)}}return n.hasOwnProperty("to")&&n.hasOwnProperty("from")?[n,null]:[null,new h("connect requires both to and from")]},t.prototype.toXml=function(t,e){return!0},t}();e.Connection=L,e.canonicalize=c}),n("util",["require","exports"],function(t,e){"use strict";function n(t){return t.replace(/(?:^|\s)\w/g,function(t){return t.toUpperCase()})}function r(t){return t.replace(/\\n/g,"\n").replace(/_/g," ")}function i(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];for(var n={},r=0;r<t.length;++r)n[t[r]]=!0;return n}function o(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function s(t,e,n,r){var i=t[r];o(t,r,n);for(var s=e,a=e;a<n;++a)t[a].lessThan(i)&&(o(t,a,s),s+=1);return o(t,s,n),s}function a(t,e,n,r){if(void 0===e&&(e=0),void 0===n&&(n=t.length-1),void 0===r&&(r=s),!(e>=n)){var i=Math.floor(e+(n-e)/2),o=r(t,e,n,i);a(t,e,o-1,r),a(t,o+1,n,r)}}function u(t,e){var n=t.x.length;if(0===n)return NaN;var r=t.x,i=t.y;if(e<=r[0])return i[0];if(e>=r[n-1])return i[n-1];for(var o,s=0,a=n;s<a;)o=Math.floor(s+(a-s)/2),r[o]<e?s=o+1:a=o;var u=s;if(r[u]===e)return i[u];var l=(i[u]-i[u-1])/(r[u]-r[u-1]);return(e-r[u-1])*l+i[u-1]}function l(t,e){return t<e?t:e}function c(t){for(var e=[],n=0;n<t.length;n++)e.push(parseFloat(t[n]));return e}function h(t,e){return parseFloat(t.getAttribute(e))}function f(t,e){if(t.querySelector)return t.querySelector(e);var n,r=e.split(">"),i=t;t:for(var o=0;i&&o<r.length;o++){for(var s=0;s<i.childNodes.length;s++)if(n=i.childNodes[s],n.tagName&&n.tagName.toLowerCase()===r[o].toLowerCase()){i=n;continue t}i=null}return i}function p(t,e){var n,r=e[0],i=e.slice(1),o=[];for(var s in t.childNodes)t.hasOwnProperty(s)&&(n=t.childNodes[s],n.tagName&&n.tagName.toLowerCase()===r&&(i.length?o=o.concat(p(n,i)):o.push(n)));return o}function d(t,e){if(t.querySelectorAll)return t.querySelectorAll(e);var n=e.split(">").map(function(t){return t.toLowerCase()});return p(t,n)}function v(t){return t!==t}e.titleCase=n,e.dName=r,e.set=i,e.partition=s,e.sort=a,e.lookup=u,e.min=l,e.numArr=c,e.floatAttr=h,e.qs=f,e.querySelectorInner=p,e.qsa=d,e.isNaN=v}),n("lex",["require","exports","./common","./util"],function(t,e,n,r){"use strict";function i(t){return/\s/.test(t)}function o(t){return/[\d\.]/.test(t)}function s(t){return/[=><\[\]\(\)\^\+\-\*\/,]/.test(t)}function a(t){return!o(t)&&!i(t)&&(/[_\"]/.test(t)||!s(t))}function u(t){for(var e,r=new f(t),i={};e=r.nextTok();)1!==e.type||e.tok in n.builtins||(i[e.tok]=!0);return i}var l={not:"!",and:"&",or:"|",mod:"%"};e.RESERVED=r.set("if","then","else");var c=function(){function t(t,e){this.line=t,this.pos=e}return t.prototype.off=function(e){return new t(this.line,this.pos+e)},t}();e.SourceLoc=c;var h=function(){function t(t,e,n,r){this.tok=t,this.type=e,this.startLoc=n,this.endLoc=r}return Object.defineProperty(t.prototype,"value",{get:function(){if(3===this.type)return parseFloat(this.tok)},enumerable:!0,configurable:!0}),t}();e.Token=h;var f=function(){function t(t){this.text=t.toLowerCase(),this.orig=t,this.len=t.length,this.pos=0,this.line=0,this.lstart=0,this.rpeek=this.text[0],this.tpeek=null}return t.prototype.peek=function(){return this.tpeek||(this.tpeek=this.nextTok()),this.tpeek},t.prototype.nextTok=function(){if(this.tpeek){var t=this.tpeek;return this.tpeek=null,t}this.skipWhitespace();var e=this.rpeek;if(null===e||void 0===e)return null;var n=this.pos-this.lstart,r=new c(this.line,n);if(o(e))return this.lexNumber(r);if(a(e))return this.lexIdentifier(r);var i=this.pos,s=1;switch(e){case"=":this.nextRune(),"="===this.rpeek&&(this.nextRune(),s++);break;case"<":this.nextRune(),"="!==this.rpeek&&">"!==this.rpeek||(this.nextRune(),s++);break;case">":this.nextRune(),"="===this.rpeek&&(this.nextRune(),s++);break;default:this.nextRune()}var u=this.text.substring(i,i+s);switch(u){case">=":u="≥";break;case"<=":u="≤";break;case"<>":u="≠"}return new h(u,0,r,r.off(s))},t.prototype.nextRune=function(){return this.pos<this.len-1?this.rpeek=this.text[this.pos+1]:this.rpeek=null,this.pos++,this.rpeek},t.prototype.skipWhitespace=function(){var t=!1;do if("\n"===this.rpeek&&(this.line++,this.lstart=this.pos+1),t)"}"===this.rpeek&&(t=!1);else if("{"!==this.rpeek){if(!i(this.rpeek))break}else t=!0;while(null!==this.nextRune())},t.prototype.fastForward=function(t){this.pos+=t,this.pos<this.len?this.rpeek=this.text[this.pos]:this.rpeek=null},t.prototype.lexIdentifier=function(t){var n='"'===this.rpeek,r=(this.line,this.pos);n&&this.nextRune();for(var o;o=this.nextRune();)if(!(a(o)&&'"'!==o||/\d/.test(o))){if(n){if('"'===o){this.nextRune();break}if(i(o))continue}break}var s=this.pos-r,u=this.text.substring(r,r+s),c=1;return u in e.RESERVED?c=2:u in l&&(c=0,u=l[u]),new h(u,c,t,t.off(s))},t.prototype.lexNumber=function(t){var e=/\d*(\.\d*)?(e(\d?(\.\d*)?)?)?/.exec(this.text.substring(this.pos))[0],n=e.length;return this.fastForward(n),new h(e,3,t,new c(t.line,t.pos+n))},t}();e.Lexer=f,e.identifierSet=u}),n("ast",["require","exports","./xmile"],function(t,e,n){"use strict";var r=function(){function t(t,e){this.ident=n.canonicalize(e),this.pos=t,this.len=e.length}return Object.defineProperty(t.prototype,"end",{get:function(){return this.pos.off(this.len)},enumerable:!0,configurable:!0}),t.prototype.walk=function(t){return t.ident(this)},t}();e.Ident=r;var i=function(){function t(t,e){this.value=parseFloat(e),this._pos=t,this._len=e.length}return Object.defineProperty(t.prototype,"pos",{get:function(){return this._pos},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this._pos.off(this._len)},enumerable:!0,configurable:!0}),t.prototype.walk=function(t){return t.constant(this)},t}();e.Constant=i;var o=function(){function t(t,e,n){this.x=e,this._lPos=t,this._rPos=n}return Object.defineProperty(t.prototype,"pos",{get:function(){return this._lPos},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this._rPos.off(1)},enumerable:!0,configurable:!0}),t.prototype.walk=function(t){return t.paren(this)},t}();e.ParenExpr=o;var s=function(){function t(t,e,n,r){this.fun=t,this.args=n,this._lParenPos=e,this._rParenPos=r}return Object.defineProperty(t.prototype,"pos",{get:function(){return this.fun.pos},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this._rParenPos.off(1)},enumerable:!0,configurable:!0}),t.prototype.walk=function(t){return t.call(this)},t}();e.CallExpr=s;var a=function(){function t(t,e,n){this.op=e,this.x=n,this._opPos=t}return Object.defineProperty(t.prototype,"pos",{get:function(){return this._opPos},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this.x.end},enumerable:!0,configurable:!0}),t.prototype.walk=function(t){return t.unary(this)},t}();e.UnaryExpr=a;var u=function(){function t(t,e,n,r){this.l=t,this.op=n,this.r=r,this._opPos=e}return Object.defineProperty(t.prototype,"pos",{get:function(){return this.l.pos},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this.r.end},enumerable:!0,configurable:!0}),t.prototype.walk=function(t){return t.binary(this)},t}();e.BinaryExpr=u;var l=function(){function t(t,e,n,r,i,o){this.cond=e,this.t=r,this.f=o,this._ifPos=t,this._thenPos=n,this._elsePos=i}return Object.defineProperty(t.prototype,"pos",{get:function(){return this._ifPos},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this.f.end},enumerable:!0,configurable:!0}),t.prototype.walk=function(t){return t.if(this)},t}();e.IfExpr=l}),n("parse",["require","exports","./ast","./lex"],function(t,e,n,r){"use strict";function i(t){var e=new u(t),n=e.expr();return e.errs&&e.errs.length?[null,e.errs]:[n,null]}function o(t,e,r){return function(){var i=e.lexer.peek();if(!i)return null;var o=e.levels[t+1],s=o();if(!s)return null;for(var a=e.consumeAnyOf(r);a;a=e.consumeAnyOf(r)){var u=o();if(!u)return e.errs.push('expected rhs of expr after "'+a.tok+'"'),null;s=new n.BinaryExpr(s,a.startLoc,a.tok,u)}return s}}var s="+-!",a=["^","!","*/%","+-","><≥≤","=≠","&","|"];e.eqn=i;var u=function(){function t(t){this.errs=[],this.levels=[],this.lexer=new r.Lexer(t);for(var e=0;e<a.length;e++)this.levels.push(o(e,this,a[e]));this.levels.push(this.factor.bind(this))}return Object.defineProperty(t.prototype,"errors",{get:function(){return this.errs},enumerable:!0,configurable:!0}),t.prototype.expr=function(){return this.levels[0]()},t.prototype.factor=function(){var t,e;if(e=this.consumeTok("(")){if(t=this.expr(),!t)return this.errs.push("expected an expression after an opening paren"),null;var r=void 0;return(r=this.consumeTok(")"))?new n.ParenExpr(e,t,r):(this.errs.push('expected ")", not end-of-equation'),null)}var i;if(i=this.consumeAnyOf(s))return t=this.expr(),t?new n.UnaryExpr(i.startLoc,i.tok,t):(this.errs.push('unary operator "'+i.tok+'" without operand.'),null);if(t=this.num())return t;var o;if(o=this.consumeReserved("if")){var a=this.expr();if(!a)return this.errs.push('expected an expr to follow "IF"'),null;var u=void 0;if(!(u=this.consumeReserved("then")))return this.errs.push('expected "THEN"'),null;var l=this.expr();if(!l)return this.errs.push('expected an expr to follow "THEN"'),null;var c=void 0;if(!(c=this.consumeReserved("else")))return this.errs.push('expected "ELSE"'),null;var h=this.expr();return h?new n.IfExpr(o,a,u,l,c,h):(this.errs.push('expected an expr to follow "ELSE"'),null)}if(t=this.ident()){var f=void 0;return(f=this.consumeTok("("))?this.call(t,f):t}return null},t.prototype.consumeAnyOf=function(t){var e=this.lexer.peek();if(!e||0!==e.type)return null;for(var n=0;n<t.length;n++)if(e.tok===t[n])return this.lexer.nextTok();return null},t.prototype.consumeTok=function(t){var e=this.lexer.peek();return e&&0===e.type&&e.tok===t?(this.lexer.nextTok(),e.startLoc):null},t.prototype.consumeReserved=function(t){var e=this.lexer.peek();return e&&2===e.type&&e.tok===t?(this.lexer.nextTok(),e.startLoc):null},t.prototype.num=function(){var t=this.lexer.peek();return t&&3===t.type?(this.lexer.nextTok(),new n.Constant(t.startLoc,t.tok)):null},t.prototype.ident=function(){var t=this.lexer.peek();return t&&1===t.type?(this.lexer.nextTok(),new n.Ident(t.startLoc,t.tok)):null},t.prototype.call=function(t,e){var r,i=[];if(r=this.consumeTok(")"))return new n.CallExpr(t,e,i,r);for(;;){var o=this.expr();if(!o)return this.errs.push("expected expression as arg in function call"),null;if(i.push(o),!this.consumeTok(",")){if(r=this.consumeTok(")"))break;return this.errs.push('call: expected "," or ")"'),null}}return new n.CallExpr(t,e,i,r)},t}()});var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};return n("vars",["require","exports","./common","./lex","./parse"],function(t,e,n,i,o){"use strict";var s={"&":"&&","|":"||","≥":">=","≤":"<=","≠":"!==","=":"==="},a=function(){function t(t,e){this.code="",this.offsets=t,this.isMain=e,this.scope=e?"curr":"globalCurr"}return t.prototype.ident=function(t){return"time"===t.ident?this.refTime():t.ident in this.offsets?this.refDirect(t.ident):this.refIndirect(t.ident),!0},t.prototype.constant=function(t){return this.code+=""+t.value,!0},t.prototype.call=function(t){if(!t.fun.hasOwnProperty("ident"))return console.log("// for now, only idents can be used as fns."),console.log(t),!1;var e=t.fun.ident;if(!(e in n.builtins))return console.log("// unknown builtin: "+e),!1;this.code+=e,this.code+="(",n.builtins[e].usesTime&&(this.code+="dt, ",this.refTime(),t.args.length&&(this.code+=", "));for(var r=0;r<t.args.length;r++)t.args[r].walk(this),r!==t.args.length-1&&(this.code+=", ");return this.code+=")",!0},t.prototype.if=function(t){return this.code+="(",t.cond.walk(this),this.code+=" ? ",t.t.walk(this),this.code+=" : ",t.f.walk(this),this.code+=")",!0},t.prototype.paren=function(t){return this.code+="(",t.x.walk(this),this.code+=")",!0},t.prototype.unary=function(t){var e="!"===t.op?"+!":t.op;return this.code+=e,t.x.walk(this),!0},t.prototype.binary=function(t){if("^"===t.op)return this.code+="Math.pow(",t.l.walk(this),this.code+=",",t.r.walk(this),this.code+=")",!0;var e=t.op;return t.op in s&&(e=s[t.op]),this.code+="(",t.l.walk(this),this.code+=e,t.r.walk(this),this.code+=")",!0},t.prototype.refTime=function(){this.code+=this.scope,this.code+="[0]"},t.prototype.refDirect=function(t){this.code+="curr[",this.code+=this.offsets[t],this.code+="]"},t.prototype.refIndirect=function(t){this.code+="globalCurr[this.ref['",this.code+=t,this.code+="']]"},t}();e.CodegenVisitor=a;var u=function(){function t(t,e){if(arguments.length){this.model=t,this.xmile=e,this.ident=e.ident,this.eqn=e.eqn||"";var n;r=o.eqn(this.eqn),this.ast=r[0],n=r[1],n?(console.log("// parse failed for "+this.ident+": "+n[0]),this.valid=!1):this.valid=!0,this._deps=i.identifierSet(this.eqn);var r}}return t.prototype.initialEquation=function(){return this.eqn},t.prototype.code=function(t){if(this.isConst())return"this.initials['"+this.ident+"']";
var e=new a(t,"main"===this.model.ident),n=this.ast.walk(e);return n?e.code:(console.log("// codegen failed for "+this.ident),"")},t.prototype.getDeps=function(){if(this._allDeps)return this._allDeps;var t={};for(var e in this._deps)if(!(e in t)){t[e]=!0;var n=this.model.vars[e];if(n){var r=n.getDeps();for(var i in r)r.hasOwnProperty(i)&&(t[i]=!0)}}return this._allDeps=t,t},t.prototype.lessThan=function(t){return this.ident in t.getDeps()},t.prototype.isConst=function(){return isFinite(this.eqn)},t}();e.Variable=u;var l=function(t){function e(e,n){t.call(this,e,n),this.initial=n.eqn||"",this.inflows=n.inflows||[],this.outflows=n.outflows||[]}return r(e,t),e.prototype.initialEquation=function(){return this.initial},e.prototype.code=function(t){var e="curr["+t[this.ident]+"] + (";return this.inflows.length>0&&(e+=this.inflows.map(function(e){return"curr["+t[e]+"]"}).join("+")),this.outflows.length>0&&(e+="- ("+this.outflows.map(function(e){return"curr["+t[e]+"]"}).join("+")+")"),0===this.inflows.length&&0===this.outflows.length&&(e+="0"),e+=")*dt"},e}(u);e.Stock=l;var c=function(t){function e(e,n){t.call(this,e,n),this.x=[],this.y=[],this.ok=!0;for(var r=n.gf.yPoints,i=n.gf.xPoints,o=n.gf.xScale,s=o?o.min:0,a=o?o.max:0,u=0;u<r.length;u++){var l=void 0;l=i?i[u]:u/(r.length-1)*(a-s)+s,this.x.push(l),this.y.push(r[u])}}return r(e,t),e.prototype.code=function(e){if(!this.eqn)return null;var n=t.prototype.code.call(this,e);return"lookup(this.tables['"+this.ident+"'], "+n+")"},e}(u);e.Table=c;var h=function(t){function e(e,n,r){t.call(this),this.project=e,this.parent=n,this.xmile=r,this.ident=r.ident,this.modelName=this.ident,this.refs={},this._deps={};for(var i=0;r.connections&&i<r.connections.length;i++){var o=new f(r.connections[i]);this.refs[o.ident]=o,this._deps[o.ptr]=!0}}return r(e,t),e.prototype.getDeps=function(){if(this._allDeps)return this._allDeps;var t={};for(var e in this._deps)if(this._deps.hasOwnProperty(e)&&!(e in t)){var n=void 0;"."===e[0]?(n=this.project.model(this.project.main.modelName),e=e.substr(1)):n=this.parent;var r=e.split("."),i=n.lookup(e);if(i){i instanceof l||(t[r[0]]=!0);var o=i.getDeps();for(var s in o)o.hasOwnProperty(s)&&(t[s]=!0)}else console.log("couldnt find "+e)}return this._allDeps=t,t},e.prototype.referencedModels=function(t){t||(t={});var e=this.project.model(this.modelName),n=e.name;t[n]?t[n].modules.push(this):t[n]={model:e,modules:[this]};for(var r in e.modules)e.modules.hasOwnProperty(r)&&e.modules[r].referencedModels(t);return t},e}(u);e.Module=h;var f=function(t){function e(e){t.call(this),this.xmile=null,this.xmileConn=e,this.ident=e.to,this.ptr=e.from}return r(e,t),e.prototype.code=function(t){return'curr["'+this.ptr+'"]'},e.prototype.lessThan=function(t){return this.ptr in t.getDeps()},e.prototype.isConst=function(){return!1},e}(u);e.Reference=f}),n("runtime",["require","exports"],function(t,e){"use strict";e.preamble="'use strict';\nfunction i32(n) {\n    'use strict';\n    return n | 0;\n}\nvar Simulation = (function () {\n    function Simulation() {\n    }\n    Simulation.prototype.lookupOffset = function (id) {\n        if (id === 'time')\n            return 0;\n        if (id[0] === '.')\n            id = id.substr(1);\n        if (id in this.offsets)\n            return this._shift + this.offsets[id];\n        var parts = id.split('.');\n        if (parts.length === 1 && id === \"\" && this.name in this.offsets)\n            return this._shift + this.offsets[this.name];\n        var nextSim = this.modules[parts[0]];\n        if (!nextSim)\n            return -1;\n        return nextSim.lookupOffset(parts.slice(1).join('.'));\n    };\n    Simulation.prototype.root = function () {\n        if (!this.parent)\n            return this;\n        return this.parent.root();\n    };\n    Simulation.prototype.resolveAllSymbolicRefs = function () {\n        for (var n in this.symRefs) {\n            if (!this.symRefs.hasOwnProperty(n))\n                continue;\n            var ctx = void 0;\n            if (this.symRefs[n][0] === '.') {\n                ctx = this.root();\n            }\n            else {\n                ctx = this.parent;\n            }\n            this.ref[n] = ctx.lookupOffset(this.symRefs[n]);\n        }\n        for (var n in this.modules) {\n            if (!this.modules.hasOwnProperty(n))\n                continue;\n            this.modules[n].resolveAllSymbolicRefs();\n        }\n    };\n    Simulation.prototype.varNames = function () {\n        var result = Object.keys(this.offsets).slice();\n        for (var v in this.modules) {\n            if (!this.modules.hasOwnProperty(v))\n                continue;\n            var ids = [];\n            var modVarNames = this.modules[v].varNames();\n            for (var n in modVarNames) {\n                if (modVarNames.hasOwnProperty(n))\n                    ids.push(v + '.' + modVarNames[n]);\n            }\n            result = result.concat(ids);\n        }\n        if (this.name === 'main')\n            result.push('time');\n        return result;\n    };\n    Simulation.prototype.getNVars = function () {\n        var nVars = Object.keys(this.offsets).length;\n        for (var n in this.modules) {\n            if (this.modules.hasOwnProperty(n))\n                nVars += this.modules[n].getNVars();\n        }\n        if (this.name === 'main')\n            nVars++;\n        return nVars;\n    };\n    Simulation.prototype.reset = function () {\n        var spec = this.simSpec;\n        var nSaveSteps = i32((spec.stop - spec.start) / spec.saveStep + 1);\n        this.stepNum = 0;\n        this.slab = new Float64Array(this.nVars * (nSaveSteps + 1));\n        var curr = this.curr();\n        curr[0] = spec.start;\n        this.saveEvery = Math.max(1, i32(spec.saveStep / spec.dt + 0.5));\n        this.calcInitial(this.simSpec.dt, curr);\n    };\n    Simulation.prototype.dominance = function (forced, indicators) {\n        var dt = this.simSpec.dt;\n        var curr = this.curr().slice();\n        var next = new Float64Array(curr.length);\n        for (var name_1 in forced) {\n            if (!forced.hasOwnProperty(name_1))\n                continue;\n            var off = this.lookupOffset(name_1);\n            if (off === -1) {\n                console.log(\"WARNING: variable '\" + name_1 + \"' not found.\");\n                return {};\n            }\n            curr[off] = forced[name_1];\n        }\n        this.calcFlows(dt, curr);\n        this.calcStocks(dt, curr, next);\n        next[0] = curr[0] + dt;\n        var result = {};\n        for (var i = 0; i < indicators.length; i++) {\n            var name_2 = indicators[i];\n            var off = this.lookupOffset(name_2);\n            if (off === -1) {\n                console.log(\"WARNING: variable '\" + name_2 + \"' not found.\");\n                continue;\n            }\n            result[name_2] = next[off];\n        }\n        return result;\n    };\n    Simulation.prototype.runTo = function (endTime) {\n        var dt = this.simSpec.dt;\n        var curr = this.curr();\n        var next = this.slab.subarray((this.stepNum + 1) * this.nVars, (this.stepNum + 2) * this.nVars);\n        while (curr[0] <= endTime) {\n            this.calcFlows(dt, curr);\n            this.calcStocks(dt, curr, next);\n            next[0] = curr[0] + dt;\n            if (this.stepNum++ % this.saveEvery !== 0) {\n                curr.set(next);\n            }\n            else {\n                curr = next;\n                next = this.slab.subarray((i32(this.stepNum / this.saveEvery) + 1) * this.nVars, (i32(this.stepNum / this.saveEvery) + 2) * this.nVars);\n            }\n        }\n    };\n    Simulation.prototype.runToEnd = function () {\n        return this.runTo(this.simSpec.stop + 0.5 * this.simSpec.dt);\n    };\n    Simulation.prototype.curr = function () {\n        return this.slab.subarray((this.stepNum) * this.nVars, (this.stepNum + 1) * this.nVars);\n    };\n    Simulation.prototype.setValue = function (name, value) {\n        var off = this.lookupOffset(name);\n        if (off === -1)\n            return;\n        this.curr()[off] = value;\n    };\n    Simulation.prototype.value = function (name) {\n        var off = this.lookupOffset(name);\n        if (off === -1)\n            return;\n        var saveNum = i32(this.stepNum / this.saveEvery);\n        var slabOff = this.nVars * saveNum;\n        return this.slab.subarray(slabOff, slabOff + this.nVars)[off];\n    };\n    Simulation.prototype.series = function (name) {\n        var saveNum = i32(this.stepNum / this.saveEvery);\n        var time = new Float64Array(saveNum);\n        var values = new Float64Array(saveNum);\n        var off = this.lookupOffset(name);\n        if (off === -1)\n            return;\n        for (var i = 0; i < time.length; i++) {\n            var curr = this.slab.subarray(i * this.nVars, (i + 1) * this.nVars);\n            time[i] = curr[0];\n            values[i] = curr[off];\n        }\n        return {\n            'name': name,\n            'time': time,\n            'values': values,\n        };\n    };\n    return Simulation;\n}());\nvar cmds;\nfunction handleMessage(e) {\n    'use strict';\n    var id = e.data[0];\n    var cmd = e.data[1];\n    var args = e.data.slice(2);\n    var result;\n    if (cmds.hasOwnProperty(cmd)) {\n        result = cmds[cmd].apply(null, args);\n    }\n    else {\n        result = [null, 'unknown command \"' + cmd + '\"'];\n    }\n    if (!Array.isArray(result))\n        result = [null, 'no result for [' + e.data.join(', ') + ']'];\n    var msg = [id, result];\n    this.postMessage(msg);\n}\nvar desiredSeries = null;\nfunction initCmds(main) {\n    'use strict';\n    return {\n        'reset': function () {\n            main.reset();\n            return ['ok', null];\n        },\n        'set_val': function (name, val) {\n            main.setValue(name, val);\n            return ['ok', null];\n        },\n        'get_val': function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i - 0] = arguments[_i];\n            }\n            var result = {};\n            for (var i = 0; i < args.length; i++)\n                result[args[i]] = main.value(args[i]);\n            return [result, null];\n        },\n        'get_series': function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i - 0] = arguments[_i];\n            }\n            var result = {};\n            for (var i = 0; i < args.length; i++)\n                result[args[i]] = main.series(args[i]);\n            return [result, null];\n        },\n        'dominance': function (overrides, indicators) {\n            return [main.dominance(overrides, indicators), null];\n        },\n        'run_to': function (time) {\n            main.runTo(time);\n            return [main.value('time'), null];\n        },\n        'run_to_end': function () {\n            var result = {};\n            main.runToEnd();\n            if (desiredSeries) {\n                for (var i = 0; i < desiredSeries.length; i++)\n                    result[desiredSeries[i]] = main.series(desiredSeries[i]);\n                return [result, null];\n            }\n            else {\n                return [main.value('time'), null];\n            }\n        },\n        'var_names': function () {\n            return [main.varNames(), null];\n        },\n        'set_desired_series': function (names) {\n            desiredSeries = names;\n            return ['ok', null];\n        },\n    };\n}\nfunction lookup(table, index) {\n    'use strict';\n    var size = table.x.length;\n    if (size === 0)\n        return NaN;\n    var x = table.x;\n    var y = table.y;\n    if (index <= x[0]) {\n        return y[0];\n    }\n    else if (index >= x[size - 1]) {\n        return y[size - 1];\n    }\n    var low = 0;\n    var high = size;\n    var mid;\n    while (low < high) {\n        mid = Math.floor(low + (high - low) / 2);\n        if (x[mid] < index) {\n            low = mid + 1;\n        }\n        else {\n            high = mid;\n        }\n    }\n    var i = low;\n    if (x[i] === index) {\n        return y[i];\n    }\n    else {\n        var slope = (y[i] - y[i - 1]) / (x[i] - x[i - 1]);\n        return (index - x[i - 1]) * slope + y[i - 1];\n    }\n}\nfunction max(a, b) {\n    'use strict';\n    a = +a;\n    b = +b;\n    return a > b ? a : b;\n}\nfunction min(a, b) {\n    'use strict';\n    a = +a;\n    b = +b;\n    return a < b ? a : b;\n}\nfunction pulse(dt, time, volume, firstPulse, interval) {\n    'use strict';\n    if (time < firstPulse)\n        return 0;\n    var nextPulse = firstPulse;\n    while (time >= nextPulse) {\n        if (time < nextPulse + dt) {\n            return volume / dt;\n        }\n        else if (interval <= 0.0) {\n            break;\n        }\n        else {\n            nextPulse += interval;\n        }\n    }\n    return 0;\n}",e.epilogue="var pr;\nif (typeof console === 'undefined') {\n    pr = print;\n}\nelse {\n    pr = console.log;\n}\nmain.runToEnd();\nvar series = {};\nvar header = 'time\\t';\nvar vars = main.varNames();\nfor (var i = 0; i < vars.length; i++) {\n    var v = vars[i];\n    if (v === 'time')\n        continue;\n    header += v + '\\t';\n    series[v] = main.series(v);\n}\npr(header.substr(0, header.length - 1));\nvar nSteps = main.series('time').time.length;\nfor (var i = 0; i < nSteps; i++) {\n    var msg = '';\n    for (var v in series) {\n        if (!series.hasOwnProperty(v))\n            continue;\n        if (msg === '')\n            msg += series[v].time[i] + '\\t';\n        msg += series[v].values[i] + '\\t';\n    }\n    pr(msg.substr(0, msg.length - 1));\n}",e.drawCSS='<defs><style>\n/* <![CDATA[ */\n.spark-axis {\n    stroke-width: 0.125;\n    stroke-linecap: round;\n    stroke: #999;\n    fill: none;\n}\n\n.spark-line {\n    stroke-width: 0.5;\n    stroke-linecap: round;\n    stroke: #2299dd;\n    fill: none;\n}\n\ntext {\n    font-size: 12px;\n    font-family: "Roboto", "Open Sans", Arial, sans-serif;\n    font-weight: 300;\n    text-anchor: middle;\n    white-space: nowrap;\n    vertical-align: middle;\n}\n\n.left-aligned {\n    text-anchor: start;\n}\n\n.right-aligned {\n    text-anchor: end;\n}\n/* ]]> */\n</style></defs>\n'}),function(t,e,r,i){"use strict";function o(t,e,n){return setTimeout(c(t,n),e)}function s(t,e,n){return!!Array.isArray(t)&&(a(t,n[e],n),!0)}function a(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==i)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function u(e,n,r){var i="DEPRECATED METHOD: "+n+"\n"+r+" AT \n";return function(){var n=new Error("get-stack-trace"),r=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=t.console&&(t.console.warn||t.console.log);return o&&o.call(t.console,i,r),e.apply(this,arguments)}}function l(t,e,n){var r,i=e.prototype;r=t.prototype=Object.create(i),r.constructor=t,r._super=i,n&&ft(r,n)}function c(t,e){return function(){return t.apply(e,arguments)}}function h(t,e){return typeof t==vt?t.apply(e?e[0]||i:i,e):t}function f(t,e){return t===i?e:t}function p(t,e,n){a(g(e),function(e){t.addEventListener(e,n,!1)})}function d(t,e,n){a(g(e),function(e){t.removeEventListener(e,n,!1)})}function v(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function m(t,e){return t.indexOf(e)>-1}function g(t){return t.trim().split(/\s+/g)}function y(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function x(t){return Array.prototype.slice.call(t,0)}function b(t,e,n){for(var r=[],i=[],o=0;o<t.length;){var s=e?t[o][e]:t[o];y(i,s)<0&&r.push(t[o]),i[o]=s,o++}return n&&(r=e?r.sort(function(t,n){return t[e]>n[e]}):r.sort()),r}function w(t,e){for(var n,r,o=e[0].toUpperCase()+e.slice(1),s=0;s<pt.length;){if(n=pt[s],r=n?n+o:e,r in t)return r;s++}return i}function k(){return wt++}function S(e){var n=e.ownerDocument||e;return n.defaultView||n.parentWindow||t}function T(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){h(t.options.enable,[t])&&n.handler(e)},this.init()}function _(t){var e,n=t.options.inputClass;return new(e=n?n:Tt?D:_t?z:St?U:q)(t,C)}function C(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,o=e&At&&r-i===0,s=e&(Mt|Rt)&&r-i===0;n.isFirst=!!o,n.isFinal=!!s,o&&(t.session={}),n.eventType=e,N(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function N(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=j(e)),i>1&&!n.firstMultiple?n.firstMultiple=j(e):1===i&&(n.firstMultiple=!1);var o=n.firstInput,s=n.firstMultiple,a=s?s.center:o.center,u=e.center=A(r);e.timeStamp=yt(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=L(a,u),e.distance=R(a,u),E(n,e),e.offsetDirection=M(e.deltaX,e.deltaY);var l=O(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=l.x,e.overallVelocityY=l.y,e.overallVelocity=gt(l.x)>gt(l.y)?l.x:l.y,e.scale=s?F(s.pointers,r):1,e.rotation=s?B(s.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,P(n,e);var c=t.element;v(e.srcEvent.target,c)&&(c=e.srcEvent.target),e.target=c}function E(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};e.eventType!==At&&o.eventType!==Mt||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}function P(t,e){var n,r,o,s,a=t.lastInterval||e,u=e.timeStamp-a.timeStamp;if(e.eventType!=Rt&&(u>jt||a.velocity===i)){var l=e.deltaX-a.deltaX,c=e.deltaY-a.deltaY,h=O(u,l,c);r=h.x,o=h.y,n=gt(h.x)>gt(h.y)?h.x:h.y,s=M(l,c),t.lastInterval=e}else n=a.velocity,r=a.velocityX,o=a.velocityY,s=a.direction;e.velocity=n,e.velocityX=r,e.velocityY=o,e.direction=s}function j(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:mt(t.pointers[n].clientX),clientY:mt(t.pointers[n].clientY)},n++;return{timeStamp:yt(),pointers:e,center:A(e),deltaX:t.deltaX,deltaY:t.deltaY}}function A(t){var e=t.length;if(1===e)return{x:mt(t[0].clientX),y:mt(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:mt(n/e),y:mt(r/e)}}function O(t,e,n){return{x:e/t||0,y:n/t||0}}function M(t,e){return t===e?Lt:gt(t)>=gt(e)?t<0?Bt:Ft:e<0?qt:Dt}function R(t,e,n){n||(n=Xt);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function L(t,e,n){n||(n=Xt);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}function B(t,e){return L(e[1],e[0],Ut)+L(t[1],t[0],Ut)}function F(t,e){return R(e[0],e[1],Ut)/R(t[0],t[1],Ut)}function q(){this.evEl=Yt,this.evWin=Ht,this.pressed=!1,T.apply(this,arguments)}function D(){this.evEl=Qt,this.evWin=Zt,T.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function V(){this.evTarget=Kt,this.evWin=te,this.started=!1,T.apply(this,arguments)}function I(t,e){var n=x(t.touches),r=x(t.changedTouches);return e&(Mt|Rt)&&(n=b(n.concat(r),"identifier",!0)),[n,r]}function z(){this.evTarget=ne,this.targetIds={},T.apply(this,arguments)}function X(t,e){var n=x(t.touches),r=this.targetIds;if(e&(At|Ot)&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,s=x(t.changedTouches),a=[],u=this.target;if(o=n.filter(function(t){return v(t.target,u)}),e===At)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<s.length;)r[s[i].identifier]&&a.push(s[i]),e&(Mt|Rt)&&delete r[s[i].identifier],i++;return a.length?[b(o.concat(a),"identifier",!0),a]:void 0}function U(){T.apply(this,arguments);var t=c(this.handler,this);this.touch=new z(this.manager,t),this.mouse=new q(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function G(t,e){t&At?(this.primaryTouch=e.changedPointers[0].identifier,Y.call(this,e)):t&(Mt|Rt)&&Y.call(this,e)}function Y(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches,i=function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)};setTimeout(i,re)}}function H(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(e-i.x),s=Math.abs(n-i.y);if(o<=ie&&s<=ie)return!0}return!1}function W(t,e){this.manager=t,this.set(e)}function $(t){if(m(t,ce))return ce;var e=m(t,he),n=m(t,fe);return e&&n?ce:e||n?e?he:fe:m(t,le)?le:ue}function Q(){if(!se)return!1;var e={},n=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(r){e[r]=!n||t.CSS.supports("touch-action",r)}),e}function Z(t){this.options=ft({},this.defaults,t||{}),this.id=k(),this.manager=null,this.options.enable=f(this.options.enable,!0),this.state=de,this.simultaneous={},this.requireFail=[]}function J(t){return t&xe?"cancel":t&ge?"end":t&me?"move":t&ve?"start":""}function K(t){return t==Dt?"down":t==qt?"up":t==Bt?"left":t==Ft?"right":""}function tt(t,e){var n=e.manager;return n?n.get(t):t}function et(){Z.apply(this,arguments)}function nt(){et.apply(this,arguments),this.pX=null,this.pY=null}function rt(){et.apply(this,arguments)}function it(){Z.apply(this,arguments),this._timer=null,this._input=null}function ot(){et.apply(this,arguments)}function st(){et.apply(this,arguments)}function at(){Z.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ut(t,e){return e=e||{},e.recognizers=f(e.recognizers,ut.defaults.preset),new lt(t,e)}function lt(t,e){this.options=ft({},ut.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=_(this),this.touchAction=new W(this,this.options.touchAction),ct(this,!0),a(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function ct(t,e){var n=t.element;if(n.style){var r;a(t.options.cssProps,function(i,o){r=w(n.style,o),e?(t.oldCssProps[r]=n.style[r],n.style[r]=i):n.style[r]=t.oldCssProps[r]||""}),e||(t.oldCssProps={})}}function ht(t,n){var r=e.createEvent("Event");r.initEvent(t,!0,!0),r.gesture=n,n.target.dispatchEvent(r)}var ft,pt=["","webkit","Moz","MS","ms","o"],dt=e.createElement("div"),vt="function",mt=Math.round,gt=Math.abs,yt=Date.now;ft="function"!=typeof Object.assign?function(t){if(t===i||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==i&&null!==r)for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o])}return e}:Object.assign;var xt=u(function(t,e,n){for(var r=Object.keys(e),o=0;o<r.length;)(!n||n&&t[r[o]]===i)&&(t[r[o]]=e[r[o]]),o++;return t},"extend","Use `assign`."),bt=u(function(t,e){return xt(t,e,!0)},"merge","Use `assign`."),wt=1,kt=/mobile|tablet|ip(ad|hone|od)|android/i,St="ontouchstart"in t,Tt=w(t,"PointerEvent")!==i,_t=St&&kt.test(navigator.userAgent),Ct="touch",Nt="pen",Et="mouse",Pt="kinect",jt=25,At=1,Ot=2,Mt=4,Rt=8,Lt=1,Bt=2,Ft=4,qt=8,Dt=16,Vt=Bt|Ft,It=qt|Dt,zt=Vt|It,Xt=["x","y"],Ut=["clientX","clientY"];T.prototype={handler:function(){},init:function(){this.evEl&&p(this.element,this.evEl,this.domHandler),this.evTarget&&p(this.target,this.evTarget,this.domHandler),this.evWin&&p(S(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&d(this.element,this.evEl,this.domHandler),this.evTarget&&d(this.target,this.evTarget,this.domHandler),this.evWin&&d(S(this.element),this.evWin,this.domHandler)}};var Gt={mousedown:At,mousemove:Ot,mouseup:Mt},Yt="mousedown",Ht="mousemove mouseup";l(q,T,{handler:function(t){var e=Gt[t.type];e&At&&0===t.button&&(this.pressed=!0),e&Ot&&1!==t.which&&(e=Mt),this.pressed&&(e&Mt&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:Et,srcEvent:t}))}});var Wt={pointerdown:At,pointermove:Ot,pointerup:Mt,pointercancel:Rt,pointerout:Rt},$t={2:Ct,3:Nt,4:Et,5:Pt},Qt="pointerdown",Zt="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(Qt="MSPointerDown",Zt="MSPointerMove MSPointerUp MSPointerCancel"),l(D,T,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=Wt[r],o=$t[t.pointerType]||t.pointerType,s=o==Ct,a=y(e,t.pointerId,"pointerId");i&At&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):i&(Mt|Rt)&&(n=!0),a<0||(e[a]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(a,1))}});var Jt={touchstart:At,touchmove:Ot,touchend:Mt,touchcancel:Rt},Kt="touchstart",te="touchstart touchmove touchend touchcancel";l(V,T,{handler:function(t){var e=Jt[t.type];if(e===At&&(this.started=!0),this.started){var n=I.call(this,t,e);e&(Mt|Rt)&&n[0].length-n[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:Ct,srcEvent:t})}}});var ee={touchstart:At,touchmove:Ot,touchend:Mt,touchcancel:Rt},ne="touchstart touchmove touchend touchcancel";l(z,T,{handler:function(t){var e=ee[t.type],n=X.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:Ct,srcEvent:t})}});var re=2500,ie=25;l(U,T,{handler:function(t,e,n){var r=n.pointerType==Ct,i=n.pointerType==Et;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)G.call(this,e,n);else if(i&&H.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var oe=w(dt.style,"touchAction"),se=oe!==i,ae="compute",ue="auto",le="manipulation",ce="none",he="pan-x",fe="pan-y",pe=Q();W.prototype={set:function(t){t==ae&&(t=this.compute()),se&&this.manager.element.style&&pe[t]&&(this.manager.element.style[oe]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return a(this.manager.recognizers,function(e){h(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),$(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)return void e.preventDefault();var r=this.actions,i=m(r,ce)&&!pe[ce],o=m(r,fe)&&!pe[fe],s=m(r,he)&&!pe[he];if(i){var a=1===t.pointers.length,u=t.distance<2,l=t.deltaTime<250;if(a&&u&&l)return}return s&&o?void 0:i||o&&n&Vt||s&&n&It?this.preventSrc(e):void 0},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var de=1,ve=2,me=4,ge=8,ye=ge,xe=16,be=32;Z.prototype={defaults:{},set:function(t){return ft(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(s(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=tt(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return s(t,"dropRecognizeWith",this)?this:(t=tt(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(s(t,"requireFailure",this))return this;var e=this.requireFail;return t=tt(t,this),y(e,t)===-1&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(s(t,"dropRequireFailure",this))return this;t=tt(t,this);var e=y(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){function e(e){n.manager.emit(e,t)}var n=this,r=this.state;r<ge&&e(n.options.event+J(r)),e(n.options.event),t.additionalEvent&&e(t.additionalEvent),r>=ge&&e(n.options.event+J(r))},tryEmit:function(t){return this.canEmit()?this.emit(t):void(this.state=be)},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(be|de)))return!1;t++}return!0},recognize:function(t){var e=ft({},t);return h(this.options.enable,[this,e])?(this.state&(ye|xe|be)&&(this.state=de),this.state=this.process(e),void(this.state&(ve|me|ge|xe)&&this.tryEmit(e))):(this.reset(),void(this.state=be))},process:function(t){},getTouchAction:function(){},reset:function(){}},l(et,Z,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=e&(ve|me),i=this.attrTest(t);return r&&(n&Rt||!i)?e|xe:r||i?n&Mt?e|ge:e&ve?e|me:ve:be}}),l(nt,et,{defaults:{event:"pan",threshold:10,pointers:1,direction:zt},getTouchAction:function(){var t=this.options.direction,e=[];return t&Vt&&e.push(fe),t&It&&e.push(he),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,s=t.deltaY;return i&e.direction||(e.direction&Vt?(i=0===o?Lt:o<0?Bt:Ft,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===s?Lt:s<0?qt:Dt,n=s!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return et.prototype.attrTest.call(this,t)&&(this.state&ve||!(this.state&ve)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=K(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),l(rt,et,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ce]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&ve)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),l(it,Z,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ue]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||t.eventType&(Mt|Rt)&&!i)this.reset();else if(t.eventType&At)this.reset(),this._timer=o(function(){this.state=ye,this.tryEmit()},e.time,this);else if(t.eventType&Mt)return ye;return be},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===ye&&(t&&t.eventType&Mt?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=yt(),this.manager.emit(this.options.event,this._input)))}}),l(ot,et,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ce]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&ve)}}),l(st,et,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Vt|It,pointers:1},getTouchAction:function(){return nt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&(Vt|It)?e=t.overallVelocity:n&Vt?e=t.overallVelocityX:n&It&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&gt(e)>this.options.velocity&&t.eventType&Mt},emit:function(t){var e=K(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),l(at,Z,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[le]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),t.eventType&At&&0===this.count)return this.failTimeout();if(r&&i&&n){if(t.eventType!=Mt)return this.failTimeout();var s=!this.pTime||t.timeStamp-this.pTime<e.interval,a=!this.pCenter||R(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,a&&s?this.count+=1:this.count=1,this._input=t;var u=this.count%e.taps;if(0===u)return this.hasRequireFailures()?(this._timer=o(function(){this.state=ye,this.tryEmit()},e.interval,this),ve):ye}return be},failTimeout:function(){return this._timer=o(function(){this.state=be},this.options.interval,this),be},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ye&&(this._input.tapCount=this.count,
this.manager.emit(this.options.event,this._input))}}),ut.VERSION="2.0.7",ut.defaults={domEvents:!1,touchAction:ae,enable:!0,inputTarget:null,inputClass:null,preset:[[ot,{enable:!1}],[rt,{enable:!1},["rotate"]],[st,{direction:Vt}],[nt,{direction:Vt},["swipe"]],[at],[at,{event:"doubletap",taps:2},["tap"]],[it]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var we=1,ke=2;lt.prototype={set:function(t){return ft(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?ke:we},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var n,r=this.recognizers,i=e.curRecognizer;(!i||i&&i.state&ye)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],e.stopped===ke||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&n.state&(ve|me|ge)&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof Z)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(s(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(s(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=y(e,t);n!==-1&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==i&&e!==i){var n=this.handlers;return a(g(t),function(t){n[t]=n[t]||[],n[t].push(e)}),this}},off:function(t,e){if(t!==i){var n=this.handlers;return a(g(t),function(t){e?n[t]&&n[t].splice(y(n[t],e),1):delete n[t]}),this}},emit:function(t,e){this.options.domEvents&&ht(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&ct(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},ft(ut,{INPUT_START:At,INPUT_MOVE:Ot,INPUT_END:Mt,INPUT_CANCEL:Rt,STATE_POSSIBLE:de,STATE_BEGAN:ve,STATE_CHANGED:me,STATE_ENDED:ge,STATE_RECOGNIZED:ye,STATE_CANCELLED:xe,STATE_FAILED:be,DIRECTION_NONE:Lt,DIRECTION_LEFT:Bt,DIRECTION_RIGHT:Ft,DIRECTION_UP:qt,DIRECTION_DOWN:Dt,DIRECTION_HORIZONTAL:Vt,DIRECTION_VERTICAL:It,DIRECTION_ALL:zt,Manager:lt,Input:T,TouchAction:W,TouchInput:z,MouseInput:q,PointerEventInput:D,TouchMouseInput:U,SingleTouchInput:V,Recognizer:Z,AttrRecognizer:et,Tap:at,Pan:nt,Swipe:st,Pinch:rt,Rotate:ot,Press:it,on:p,off:d,each:a,merge:bt,extend:xt,assign:ft,inherit:l,bindFn:c,prefixed:w});var Se="undefined"!=typeof t?t:"undefined"!=typeof self?self:{};Se.Hammer=ut,"function"==typeof n&&n.amd?n("../bower_components/hammerjs/hammer",[],function(){return ut}):"undefined"!=typeof module&&module.exports?module.exports=ut:t[r]=ut}(window,document,"Hammer"),function(t){var e,r,i="0.4.2",o="hasOwnProperty",s=/[\.\/]/,a=/\s*,\s*/,u="*",l=function(t,e){return t-e},c={n:{}},h=function(){for(var t=0,e=this.length;t<e;t++)if("undefined"!=typeof this[t])return this[t]},f=function(){for(var t=this.length;--t;)if("undefined"!=typeof this[t])return this[t]},p=function(t,n){t=String(t);var i,o=r,s=Array.prototype.slice.call(arguments,2),a=p.listeners(t),u=0,c=[],d={},v=[],m=e;v.firstDefined=h,v.lastDefined=f,e=t,r=0;for(var g=0,y=a.length;g<y;g++)"zIndex"in a[g]&&(c.push(a[g].zIndex),a[g].zIndex<0&&(d[a[g].zIndex]=a[g]));for(c.sort(l);c[u]<0;)if(i=d[c[u++]],v.push(i.apply(n,s)),r)return r=o,v;for(g=0;g<y;g++)if(i=a[g],"zIndex"in i)if(i.zIndex==c[u]){if(v.push(i.apply(n,s)),r)break;do if(u++,i=d[c[u]],i&&v.push(i.apply(n,s)),r)break;while(i)}else d[i.zIndex]=i;else if(v.push(i.apply(n,s)),r)break;return r=o,e=m,v};p._events=c,p.listeners=function(t){var e,n,r,i,o,a,l,h,f=t.split(s),p=c,d=[p],v=[];for(i=0,o=f.length;i<o;i++){for(h=[],a=0,l=d.length;a<l;a++)for(p=d[a].n,n=[p[f[i]],p[u]],r=2;r--;)e=n[r],e&&(h.push(e),v=v.concat(e.f||[]));d=h}return v},p.on=function(t,e){if(t=String(t),"function"!=typeof e)return function(){};for(var n=t.split(a),r=0,i=n.length;r<i;r++)!function(t){for(var n,r=t.split(s),i=c,o=0,a=r.length;o<a;o++)i=i.n,i=i.hasOwnProperty(r[o])&&i[r[o]]||(i[r[o]]={n:{}});for(i.f=i.f||[],o=0,a=i.f.length;o<a;o++)if(i.f[o]==e){n=!0;break}!n&&i.f.push(e)}(n[r]);return function(t){+t==+t&&(e.zIndex=+t)}},p.f=function(t){var e=[].slice.call(arguments,1);return function(){p.apply(null,[t,null].concat(e).concat([].slice.call(arguments,0)))}},p.stop=function(){r=1},p.nt=function(t){return t?new RegExp("(?:\\.|\\/|^)"+t+"(?:\\.|\\/|$)").test(e):e},p.nts=function(){return e.split(s)},p.off=p.unbind=function(t,e){if(!t)return void(p._events=c={n:{}});var n=t.split(a);if(n.length>1)for(var r=0,i=n.length;r<i;r++)p.off(n[r],e);else{n=t.split(s);var l,h,f,r,i,d,v,m=[c];for(r=0,i=n.length;r<i;r++)for(d=0;d<m.length;d+=f.length-2){if(f=[d,1],l=m[d].n,n[r]!=u)l[n[r]]&&f.push(l[n[r]]);else for(h in l)l[o](h)&&f.push(l[h]);m.splice.apply(m,f)}for(r=0,i=m.length;r<i;r++)for(l=m[r];l.n;){if(e){if(l.f){for(d=0,v=l.f.length;d<v;d++)if(l.f[d]==e){l.f.splice(d,1);break}!l.f.length&&delete l.f}for(h in l.n)if(l.n[o](h)&&l.n[h].f){var g=l.n[h].f;for(d=0,v=g.length;d<v;d++)if(g[d]==e){g.splice(d,1);break}!g.length&&delete l.n[h].f}}else{delete l.f;for(h in l.n)l.n[o](h)&&l.n[h].f&&delete l.n[h].f}l=l.n}}},p.once=function(t,e){var n=function(){return p.unbind(t,n),e.apply(this,arguments)};return p.on(t,n)},p.version=i,p.toString=function(){return"You are running Eve "+i},"undefined"!=typeof module&&module.exports?module.exports=p:"function"==typeof n&&n.amd?n("eve",[],function(){return p}):t.eve=p}(this),function(t,r){if("function"==typeof n&&n.amd)n("../bower_components/Snap.svg/dist/snap.svg",["eve"],function(e){return r(t,e)});else if("undefined"!=typeof exports){var i=e("eve");module.exports=r(t,i)}else r(t,t.eve)}(window||this,function(t,e){var n=function(e){var n={},r=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(t){setTimeout(t,16)},i=Array.isArray||function(t){return t instanceof Array||"[object Array]"==Object.prototype.toString.call(t)},o=0,s="M"+(+new Date).toString(36),a=function(){return s+(o++).toString(36)},u=Date.now||function(){return+new Date},l=function(t){var e=this;if(null==t)return e.s;var n=e.s-t;e.b+=e.dur*n,e.B+=e.dur*n,e.s=t},c=function(t){var e=this;return null==t?e.spd:void(e.spd=t)},h=function(t){var e=this;return null==t?e.dur:(e.s=e.s*t/e.dur,void(e.dur=t))},f=function(){var t=this;delete n[t.id],t.update(),e("mina.stop."+t.id,t)},p=function(){var t=this;t.pdif||(delete n[t.id],t.update(),t.pdif=t.get()-t.b)},d=function(){var t=this;t.pdif&&(t.b=t.get()-t.pdif,delete t.pdif,n[t.id]=t)},v=function(){var t,e=this;if(i(e.start)){t=[];for(var n=0,r=e.start.length;n<r;n++)t[n]=+e.start[n]+(e.end[n]-e.start[n])*e.easing(e.s)}else t=+e.start+(e.end-e.start)*e.easing(e.s);e.set(t)},m=function(){var t=0;for(var i in n)if(n.hasOwnProperty(i)){var o=n[i],s=o.get();t++,o.s=(s-o.b)/(o.dur/o.spd),o.s>=1&&(delete n[i],o.s=1,t--,function(t){setTimeout(function(){e("mina.finish."+t.id,t)})}(o)),o.update()}t&&r(m)},g=function(t,e,i,o,s,u,y){var x={id:a(),start:t,end:e,b:i,s:0,dur:o-i,spd:1,get:s,set:u,easing:y||g.linear,status:l,speed:c,duration:h,stop:f,pause:p,resume:d,update:v};n[x.id]=x;var b,w=0;for(b in n)if(n.hasOwnProperty(b)&&(w++,2==w))break;return 1==w&&r(m),x};return g.time=u,g.getById=function(t){return n[t]||null},g.linear=function(t){return t},g.easeout=function(t){return Math.pow(t,1.7)},g.easein=function(t){return Math.pow(t,.48)},g.easeinout=function(t){if(1==t)return 1;if(0==t)return 0;var e=.48-t/1.04,n=Math.sqrt(.1734+e*e),r=n-e,i=Math.pow(Math.abs(r),1/3)*(r<0?-1:1),o=-n-e,s=Math.pow(Math.abs(o),1/3)*(o<0?-1:1),a=i+s+.5;return 3*(1-a)*a*a+a*a*a},g.backin=function(t){if(1==t)return 1;var e=1.70158;return t*t*((e+1)*t-e)},g.backout=function(t){if(0==t)return 0;t-=1;var e=1.70158;return t*t*((e+1)*t+e)+1},g.elastic=function(t){return t==!!t?t:Math.pow(2,-10*t)*Math.sin((t-.075)*(2*Math.PI)/.3)+1},g.bounce=function(t){var e,n=7.5625,r=2.75;return t<1/r?e=n*t*t:t<2/r?(t-=1.5/r,e=n*t*t+.75):t<2.5/r?(t-=2.25/r,e=n*t*t+.9375):(t-=2.625/r,e=n*t*t+.984375),e},t.mina=g,g}("undefined"==typeof e?function(){}:e),r=function(t){function n(t,e){if(t){if(t.nodeType)return k(t);if(i(t,"array")&&n.set)return n.set.apply(n,t);if(t instanceof y)return t;if(null==e)return t=T.doc.querySelector(String(t)),k(t)}return t=null==t?"100%":t,e=null==e?"100%":e,new w(t,e)}function r(t,e){if(e){if("#text"==t&&(t=T.doc.createTextNode(e.text||e["#text"]||"")),"#comment"==t&&(t=T.doc.createComment(e.text||e["#text"]||"")),"string"==typeof t&&(t=r(t)),"string"==typeof e)return 1==t.nodeType?"xlink:"==e.substring(0,6)?t.getAttributeNS(G,e.substring(6)):"xml:"==e.substring(0,4)?t.getAttributeNS(Y,e.substring(4)):t.getAttribute(e):"text"==e?t.nodeValue:null;if(1==t.nodeType){for(var n in e)if(e[_](n)){var i=C(e[n]);i?"xlink:"==n.substring(0,6)?t.setAttributeNS(G,n.substring(6),i):"xml:"==n.substring(0,4)?t.setAttributeNS(Y,n.substring(4),i):t.setAttribute(n,i):t.removeAttribute(n)}}else"text"in e&&(t.nodeValue=e.text)}else t=T.doc.createElementNS(Y,t);return t}function i(t,e){return e=C.prototype.toLowerCase.call(e),"finite"==e?isFinite(t):!("array"!=e||!(t instanceof Array||Array.isArray&&Array.isArray(t)))||("null"==e&&null===t||e==typeof t&&null!==t||"object"==e&&t===Object(t)||L.call(t).slice(8,-1).toLowerCase()==e)}function o(t){if("function"==typeof t||Object(t)!==t)return t;var e=new t.constructor;for(var n in t)t[_](n)&&(e[n]=o(t[n]));return e}function s(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return t.push(t.splice(n,1)[0])}function a(t,e,n){function r(){var i=Array.prototype.slice.call(arguments,0),o=i.join("␀"),a=r.cache=r.cache||{},u=r.count=r.count||[];return a[_](o)?(s(u,o),n?n(a[o]):a[o]):(u.length>=1e3&&delete a[u.shift()],u.push(o),a[o]=t.apply(e,i),n?n(a[o]):a[o])}return r}function u(t,e,n,r,i,o){if(null==i){var s=t-n,a=e-r;return s||a?(180+180*P.atan2(-a,-s)/M+360)%360:0}return u(t,e,i,o)-u(n,r,i,o)}function l(t){return t%360*M/180}function c(t){return 180*t/M%360}function h(t){var e=[];return t=t.replace(/(?:^|\s)(\w+)\(([^)]+)\)/g,function(t,n,r){return r=r.split(/\s*,\s*|\s+/),"rotate"==n&&1==r.length&&r.push(0,0),"scale"==n&&(r.length>2?r=r.slice(0,2):2==r.length&&r.push(0,0),1==r.length&&r.push(r[0],0,0)),"skewX"==n?e.push(["m",1,0,P.tan(l(r[0])),1,0,0]):"skewY"==n?e.push(["m",1,P.tan(l(r[0])),0,1,0,0]):e.push([n.charAt(0)].concat(r)),t}),e}function f(t,e){var r=tt(t),i=new n.Matrix;if(r)for(var o=0,s=r.length;o<s;o++){var a,u,l,c,h,f=r[o],p=f.length,d=C(f[0]).toLowerCase(),v=f[0]!=d,m=v?i.invert():0;"t"==d&&2==p?i.translate(f[1],0):"t"==d&&3==p?v?(a=m.x(0,0),u=m.y(0,0),l=m.x(f[1],f[2]),c=m.y(f[1],f[2]),i.translate(l-a,c-u)):i.translate(f[1],f[2]):"r"==d?2==p?(h=h||e,i.rotate(f[1],h.x+h.width/2,h.y+h.height/2)):4==p&&(v?(l=m.x(f[2],f[3]),c=m.y(f[2],f[3]),i.rotate(f[1],l,c)):i.rotate(f[1],f[2],f[3])):"s"==d?2==p||3==p?(h=h||e,i.scale(f[1],f[p-1],h.x+h.width/2,h.y+h.height/2)):4==p?v?(l=m.x(f[2],f[3]),c=m.y(f[2],f[3]),i.scale(f[1],f[1],l,c)):i.scale(f[1],f[1],f[2],f[3]):5==p&&(v?(l=m.x(f[3],f[4]),c=m.y(f[3],f[4]),i.scale(f[1],f[2],l,c)):i.scale(f[1],f[2],f[3],f[4])):"m"==d&&7==p&&i.add(f[1],f[2],f[3],f[4],f[5],f[6])}return i}function p(t){var e=t.node.ownerSVGElement&&k(t.node.ownerSVGElement)||t.node.parentNode&&k(t.node.parentNode)||n.select("svg")||n(0,0),r=e.select("defs"),i=null!=r&&r.node;return i||(i=b("defs",e.node).node),i}function d(t){return t.node.ownerSVGElement&&k(t.node.ownerSVGElement)||n.select("svg")}function v(t,e,n){function i(t){if(null==t)return R;if(t==+t)return t;r(l,{width:t});try{return l.getBBox().width}catch(t){return 0}}function o(t){if(null==t)return R;if(t==+t)return t;r(l,{height:t});try{return l.getBBox().height}catch(t){return 0}}function s(r,i){null==e?u[r]=i(t.attr(r)||0):r==e&&(u=i(null==n?t.attr(r)||0:n))}var a=d(t).node,u={},l=a.querySelector(".svg---mgr");switch(l||(l=r("rect"),r(l,{x:-9e9,y:-9e9,width:10,height:10,class:"svg---mgr",fill:"none"}),a.appendChild(l)),t.type){case"rect":s("rx",i),s("ry",o);case"image":s("width",i),s("height",o);case"text":s("x",i),s("y",o);break;case"circle":s("cx",i),s("cy",o),s("r",i);break;case"ellipse":s("cx",i),s("cy",o),s("rx",i),s("ry",o);break;case"line":s("x1",i),s("x2",i),s("y1",o),s("y2",o);break;case"marker":s("refX",i),s("markerWidth",i),s("refY",o),s("markerHeight",o);break;case"radialGradient":s("fx",i),s("fy",o);break;case"tspan":s("dx",i),s("dy",o);break;default:s(e,i)}return a.removeChild(l),u}function m(t){i(t,"array")||(t=Array.prototype.slice.call(arguments,0));for(var e=0,n=0,r=this.node;this[e];)delete this[e++];for(e=0;e<t.length;e++)"set"==t[e].type?t[e].forEach(function(t){r.appendChild(t.node)}):r.appendChild(t[e].node);var o=r.childNodes;for(e=0;e<o.length;e++)this[n++]=k(o[e]);return this}function y(t){if(t.snap in H)return H[t.snap];var e;try{e=t.ownerSVGElement}catch(t){}this.node=t,e&&(this.paper=new w(e)),this.type=t.tagName||t.nodeName;var n=this.id=U(this);if(this.anims={},this._={transform:[]},t.snap=n,H[n]=this,"g"==this.type&&(this.add=m),this.type in{g:1,mask:1,pattern:1,symbol:1})for(var r in w.prototype)w.prototype[_](r)&&(this[r]=w.prototype[r])}function x(t){this.node=t}function b(t,e){var n=r(t);e.appendChild(n);var i=k(n);return i}function w(t,e){var n,i,o,s=w.prototype;if(t&&"svg"==t.tagName){if(t.snap in H)return H[t.snap];var a=t.ownerDocument;n=new y(t),i=t.getElementsByTagName("desc")[0],o=t.getElementsByTagName("defs")[0],i||(i=r("desc"),i.appendChild(a.createTextNode("Created with Snap")),n.node.appendChild(i)),o||(o=r("defs"),n.node.appendChild(o)),n.defs=o;for(var u in s)s[_](u)&&(n[u]=s[u]);n.paper=n.root=n}else n=b("svg",T.doc.body),r(n.node,{height:e,version:1.1,width:t,xmlns:Y});return n}function k(t){return t?t instanceof y||t instanceof x?t:t.tagName&&"svg"==t.tagName.toLowerCase()?new w(t):t.tagName&&"object"==t.tagName.toLowerCase()&&"image/svg+xml"==t.type?new w(t.contentDocument.getElementsByTagName("svg")[0]):new y(t):t}function S(t,e){for(var n=0,r=t.length;n<r;n++){var i={type:t[n].type,attr:t[n].attr()},o=t[n].children();e.push(i),o.length&&S(o,i.childNodes=[])}}n.version="0.4.0",n.toString=function(){return"Snap v"+this.version},n._={};var T={win:t.window,doc:t.window.document};n._.glob=T;var _="hasOwnProperty",C=String,N=parseFloat,E=parseInt,P=Math,j=P.max,A=P.min,O=P.abs,M=(P.pow,P.PI),R=(P.round,""),L=Object.prototype.toString,B=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?%?)\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?%?)\s*\))\s*$/i,F=(n._.separator=/[,\s]+/,/[\s]*,[\s]*/),q={hs:1,rg:1},D=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\s]*,?[\s]*)+)/gi,V=/([rstm])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\s]*,?[\s]*)+)/gi,I=/(-?\d*\.?\d*(?:e[\-+]?\\d+)?)[\s]*,?[\s]*/gi,z=0,X="S"+(+new Date).toString(36),U=function(t){return(t&&t.type?t.type:R)+X+(z++).toString(36)},G="http://www.w3.org/1999/xlink",Y="http://www.w3.org/2000/svg",H={};n.url=function(t){return"url('#"+t+"')"};n._.$=r,n._.id=U,n.format=function(){var t=/\{([^\}]+)\}/g,e=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,n=function(t,n,r){var i=r;return n.replace(e,function(t,e,n,r,o){e=e||r,i&&(e in i&&(i=i[e]),"function"==typeof i&&o&&(i=i()))}),i=(null==i||i==r?t:i)+""};return function(e,r){return C(e).replace(t,function(t,e){return n(t,e,r)})}}(),n._.clone=o,n._.cacher=a,n.rad=l,n.deg=c,n.sin=function(t){return P.sin(n.rad(t))},n.tan=function(t){return P.tan(n.rad(t))},n.cos=function(t){return P.cos(n.rad(t))},n.asin=function(t){return n.deg(P.asin(t))},n.acos=function(t){return n.deg(P.acos(t))},n.atan=function(t){return n.deg(P.atan(t))},n.atan2=function(t){return n.deg(P.atan2(t))},n.angle=u,n.len=function(t,e,r,i){return Math.sqrt(n.len2(t,e,r,i))},n.len2=function(t,e,n,r){return(t-n)*(t-n)+(e-r)*(e-r)},n.closestPoint=function(t,e,n){function r(t){var r=t.x-e,i=t.y-n;return r*r+i*i}for(var i,o,s,a,u=t.node,l=u.getTotalLength(),c=l/u.pathSegList.numberOfItems*.125,h=1/0,f=0;f<=l;f+=c)(a=r(s=u.getPointAtLength(f)))<h&&(i=s,o=f,h=a);for(c*=.5;c>.5;){var p,d,v,m,g,y;(v=o-c)>=0&&(g=r(p=u.getPointAtLength(v)))<h?(i=p,o=v,h=g):(m=o+c)<=l&&(y=r(d=u.getPointAtLength(m)))<h?(i=d,o=m,h=y):c*=.5}return i={x:i.x,y:i.y,length:o,distance:Math.sqrt(h)}},n.is=i,n.snapTo=function(t,e,n){if(n=i(n,"finite")?n:10,i(t,"array")){for(var r=t.length;r--;)if(O(t[r]-e)<=n)return t[r]}else{t=+t;var o=e%t;if(o<n)return e-o;if(o>t-n)return e-o+t}return e},n.getRGB=a(function(t){if(!t||(t=C(t)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Z};if("none"==t)return{r:-1,g:-1,b:-1,hex:"none",toString:Z};if(!(q[_](t.toLowerCase().substring(0,2))||"#"==t.charAt())&&(t=W(t)),!t)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Z};var e,r,o,s,a,u,l=t.match(B);return l?(l[2]&&(o=E(l[2].substring(5),16),r=E(l[2].substring(3,5),16),e=E(l[2].substring(1,3),16)),l[3]&&(o=E((a=l[3].charAt(3))+a,16),r=E((a=l[3].charAt(2))+a,16),e=E((a=l[3].charAt(1))+a,16)),l[4]&&(u=l[4].split(F),e=N(u[0]),"%"==u[0].slice(-1)&&(e*=2.55),r=N(u[1]),"%"==u[1].slice(-1)&&(r*=2.55),o=N(u[2]),"%"==u[2].slice(-1)&&(o*=2.55),"rgba"==l[1].toLowerCase().slice(0,4)&&(s=N(u[3])),u[3]&&"%"==u[3].slice(-1)&&(s/=100)),l[5]?(u=l[5].split(F),e=N(u[0]),"%"==u[0].slice(-1)&&(e/=100),r=N(u[1]),"%"==u[1].slice(-1)&&(r/=100),o=N(u[2]),"%"==u[2].slice(-1)&&(o/=100),("deg"==u[0].slice(-3)||"°"==u[0].slice(-1))&&(e/=360),"hsba"==l[1].toLowerCase().slice(0,4)&&(s=N(u[3])),u[3]&&"%"==u[3].slice(-1)&&(s/=100),n.hsb2rgb(e,r,o,s)):l[6]?(u=l[6].split(F),e=N(u[0]),"%"==u[0].slice(-1)&&(e/=100),r=N(u[1]),"%"==u[1].slice(-1)&&(r/=100),o=N(u[2]),"%"==u[2].slice(-1)&&(o/=100),("deg"==u[0].slice(-3)||"°"==u[0].slice(-1))&&(e/=360),"hsla"==l[1].toLowerCase().slice(0,4)&&(s=N(u[3])),u[3]&&"%"==u[3].slice(-1)&&(s/=100),n.hsl2rgb(e,r,o,s)):(e=A(P.round(e),255),r=A(P.round(r),255),o=A(P.round(o),255),s=A(j(s,0),1),l={r:e,g:r,b:o,toString:Z},l.hex="#"+(16777216|o|r<<8|e<<16).toString(16).slice(1),l.opacity=i(s,"finite")?s:1,l)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Z}},n),n.hsb=a(function(t,e,r){return n.hsb2rgb(t,e,r).hex}),n.hsl=a(function(t,e,r){return n.hsl2rgb(t,e,r).hex}),n.rgb=a(function(t,e,n,r){if(i(r,"finite")){var o=P.round;return"rgba("+[o(t),o(e),o(n),+r.toFixed(2)]+")"}return"#"+(16777216|n|e<<8|t<<16).toString(16).slice(1)});var W=function(t){var e=T.doc.getElementsByTagName("head")[0]||T.doc.getElementsByTagName("svg")[0],n="rgb(255, 0, 0)";return(W=a(function(t){if("red"==t.toLowerCase())return n;e.style.color=n,e.style.color=t;var r=T.doc.defaultView.getComputedStyle(e,R).getPropertyValue("color");return r==n?null:r}))(t)},$=function(){return"hsb("+[this.h,this.s,this.b]+")"},Q=function(){return"hsl("+[this.h,this.s,this.l]+")"},Z=function(){return 1==this.opacity||null==this.opacity?this.hex:"rgba("+[this.r,this.g,this.b,this.opacity]+")"},J=function(t,e,r){if(null==e&&i(t,"object")&&"r"in t&&"g"in t&&"b"in t&&(r=t.b,e=t.g,t=t.r),null==e&&i(t,string)){var o=n.getRGB(t);t=o.r,e=o.g,r=o.b}return(t>1||e>1||r>1)&&(t/=255,e/=255,r/=255),[t,e,r]},K=function(t,e,r,o){t=P.round(255*t),e=P.round(255*e),r=P.round(255*r);var s={r:t,g:e,b:r,opacity:i(o,"finite")?o:1,hex:n.rgb(t,e,r),toString:Z};return i(o,"finite")&&(s.opacity=o),s};n.color=function(t){var e;return i(t,"object")&&"h"in t&&"s"in t&&"b"in t?(e=n.hsb2rgb(t),t.r=e.r,t.g=e.g,t.b=e.b,t.opacity=1,t.hex=e.hex):i(t,"object")&&"h"in t&&"s"in t&&"l"in t?(e=n.hsl2rgb(t),t.r=e.r,t.g=e.g,t.b=e.b,t.opacity=1,t.hex=e.hex):(i(t,"string")&&(t=n.getRGB(t)),i(t,"object")&&"r"in t&&"g"in t&&"b"in t&&!("error"in t)?(e=n.rgb2hsl(t),t.h=e.h,t.s=e.s,t.l=e.l,e=n.rgb2hsb(t),t.v=e.b):(t={hex:"none"},t.r=t.g=t.b=t.h=t.s=t.v=t.l=-1,t.error=1)),t.toString=Z,t},n.hsb2rgb=function(t,e,n,r){i(t,"object")&&"h"in t&&"s"in t&&"b"in t&&(n=t.b,e=t.s,r=t.o,t=t.h),t*=360;var o,s,a,u,l;return t=t%360/60,l=n*e,u=l*(1-O(t%2-1)),o=s=a=n-l,t=~~t,o+=[l,u,0,0,u,l][t],s+=[u,l,l,u,0,0][t],a+=[0,0,u,l,l,u][t],K(o,s,a,r)},n.hsl2rgb=function(t,e,n,r){i(t,"object")&&"h"in t&&"s"in t&&"l"in t&&(n=t.l,e=t.s,t=t.h),(t>1||e>1||n>1)&&(t/=360,e/=100,n/=100),t*=360;var o,s,a,u,l;return t=t%360/60,l=2*e*(n<.5?n:1-n),u=l*(1-O(t%2-1)),o=s=a=n-l/2,t=~~t,o+=[l,u,0,0,u,l][t],s+=[u,l,l,u,0,0][t],a+=[0,0,u,l,l,u][t],K(o,s,a,r)},n.rgb2hsb=function(t,e,n){n=J(t,e,n),t=n[0],e=n[1],n=n[2];var r,i,o,s;return o=j(t,e,n),s=o-A(t,e,n),r=0==s?null:o==t?(e-n)/s:o==e?(n-t)/s+2:(t-e)/s+4,r=(r+360)%6*60/360,i=0==s?0:s/o,{h:r,s:i,b:o,toString:$}},n.rgb2hsl=function(t,e,n){n=J(t,e,n),t=n[0],e=n[1],n=n[2];var r,i,o,s,a,u;return s=j(t,e,n),a=A(t,e,n),u=s-a,r=0==u?null:s==t?(e-n)/u:s==e?(n-t)/u+2:(t-e)/u+4,r=(r+360)%6*60/360,o=(s+a)/2,i=0==u?0:o<.5?u/(2*o):u/(2-2*o),{h:r,s:i,l:o,toString:Q}},n.parsePathString=function(t){if(!t)return null;var e=n.path(t);if(e.arr)return n.path.clone(e.arr);var r={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},o=[];return i(t,"array")&&i(t[0],"array")&&(o=n.path.clone(t)),o.length||C(t).replace(D,function(t,e,n){var i=[],s=e.toLowerCase();if(n.replace(I,function(t,e){e&&i.push(+e)}),"m"==s&&i.length>2&&(o.push([e].concat(i.splice(0,2))),s="l",e="m"==e?"l":"L"),"o"==s&&1==i.length&&o.push([e,i[0]]),"r"==s)o.push([e].concat(i));else for(;i.length>=r[s]&&(o.push([e].concat(i.splice(0,r[s]))),r[s]););}),o.toString=n.path.toString,e.arr=n.path.clone(o),o};var tt=n.parseTransformString=function(t){if(!t)return null;var e=[];return i(t,"array")&&i(t[0],"array")&&(e=n.path.clone(t)),e.length||C(t).replace(V,function(t,n,r){var i=[];n.toLowerCase();r.replace(I,function(t,e){e&&i.push(+e)}),e.push([n].concat(i))}),e.toString=n.path.toString,e};n._.svgTransform2string=h,n._.rgTransform=/^[a-z][\s]*-?\.?\d/i,n._.transform2matrix=f,n._unit2px=v;T.doc.contains||T.doc.compareDocumentPosition?function(t,e){var n=9==t.nodeType?t.documentElement:t,r=e&&e.parentNode;return t==r||!(!r||1!=r.nodeType||!(n.contains?n.contains(r):t.compareDocumentPosition&&16&t.compareDocumentPosition(r)))}:function(t,e){if(e)for(;e;)if(e=e.parentNode,e==t)return!0;return!1};n._.getSomeDefs=p,n._.getSomeSVG=d,n.select=function(t){return t=C(t).replace(/([^\\]):/g,"$1\\:"),k(T.doc.querySelector(t))},n.selectAll=function(t){for(var e=T.doc.querySelectorAll(t),r=(n.set||Array)(),i=0;i<e.length;i++)r.push(k(e[i]));return r},setInterval(function(){for(var t in H)if(H[_](t)){var e=H[t],n=e.node;("svg"!=e.type&&!n.ownerSVGElement||"svg"==e.type&&(!n.parentNode||"ownerSVGElement"in n.parentNode&&!n.ownerSVGElement))&&delete H[t]}},1e4),y.prototype.attr=function(t,n){var r=this,o=r.node;if(!t){if(1!=o.nodeType)return{text:o.nodeValue};for(var s=o.attributes,a={},u=0,l=s.length;u<l;u++)a[s[u].nodeName]=s[u].nodeValue;return a}if(i(t,"string")){if(!(arguments.length>1))return e("snap.util.getattr."+t,r).firstDefined();var c={};c[t]=n,t=c}for(var h in t)t[_](h)&&e("snap.util.attr."+h,r,t[h]);return r},n.parse=function(t){var e=T.doc.createDocumentFragment(),n=!0,r=T.doc.createElement("div");if(t=C(t),t.match(/^\s*<\s*svg(?:\s|>)/)||(t="<svg>"+t+"</svg>",n=!1),r.innerHTML=t,t=r.getElementsByTagName("svg")[0])if(n)e=t;else for(;t.firstChild;)e.appendChild(t.firstChild);return new x(e)},n.fragment=function(){for(var t=Array.prototype.slice.call(arguments,0),e=T.doc.createDocumentFragment(),r=0,i=t.length;r<i;r++){var o=t[r];o.node&&o.node.nodeType&&e.appendChild(o.node),o.nodeType&&e.appendChild(o),"string"==typeof o&&e.appendChild(n.parse(o).node)}return new x(e)},n._.make=b,n._.wrap=k,w.prototype.el=function(t,e){var n=b(t,this.node);return e&&n.attr(e),n},y.prototype.children=function(){for(var t=[],e=this.node.childNodes,r=0,i=e.length;r<i;r++)t[r]=n(e[r]);return t},y.prototype.toJSON=function(){var t=[];return S([this],t),t[0]},e.on("snap.util.getattr",function(){var t=e.nt();t=t.substring(t.lastIndexOf(".")+1);var n=t.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()});return et[_](n)?this.node.ownerDocument.defaultView.getComputedStyle(this.node,null).getPropertyValue(n):r(this.node,t)});var et={"alignment-baseline":0,"baseline-shift":0,clip:0,"clip-path":0,"clip-rule":0,color:0,"color-interpolation":0,"color-interpolation-filters":0,"color-profile":0,"color-rendering":0,cursor:0,direction:0,display:0,"dominant-baseline":0,"enable-background":0,fill:0,"fill-opacity":0,"fill-rule":0,filter:0,"flood-color":0,"flood-opacity":0,font:0,"font-family":0,"font-size":0,"font-size-adjust":0,"font-stretch":0,"font-style":0,"font-variant":0,"font-weight":0,"glyph-orientation-horizontal":0,"glyph-orientation-vertical":0,"image-rendering":0,kerning:0,"letter-spacing":0,"lighting-color":0,marker:0,"marker-end":0,"marker-mid":0,"marker-start":0,mask:0,opacity:0,overflow:0,"pointer-events":0,"shape-rendering":0,"stop-color":0,"stop-opacity":0,stroke:0,"stroke-dasharray":0,"stroke-dashoffset":0,"stroke-linecap":0,"stroke-linejoin":0,"stroke-miterlimit":0,"stroke-opacity":0,"stroke-width":0,"text-anchor":0,"text-decoration":0,"text-rendering":0,"unicode-bidi":0,visibility:0,"word-spacing":0,"writing-mode":0};e.on("snap.util.attr",function(t){var n=e.nt(),i={};n=n.substring(n.lastIndexOf(".")+1),i[n]=t;var o=n.replace(/-(\w)/gi,function(t,e){return e.toUpperCase()}),s=n.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()});et[_](s)?this.node.style[o]=null==t?R:t:r(this.node,i)}),function(t){}(w.prototype),n.ajax=function(t,n,r,o){var s=new XMLHttpRequest,a=U();if(s){if(i(n,"function"))o=r,r=n,n=null;else if(i(n,"object")){var u=[];for(var l in n)n.hasOwnProperty(l)&&u.push(encodeURIComponent(l)+"="+encodeURIComponent(n[l]));n=u.join("&")}return s.open(n?"POST":"GET",t,!0),n&&(s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.setRequestHeader("Content-type","application/x-www-form-urlencoded")),r&&(e.once("snap.ajax."+a+".0",r),e.once("snap.ajax."+a+".200",r),e.once("snap.ajax."+a+".304",r)),s.onreadystatechange=function(){4==s.readyState&&e("snap.ajax."+a+"."+s.status,o,s)},4==s.readyState?s:(s.send(n),s)}},n.load=function(t,e,r){n.ajax(t,function(t){var i=n.parse(t.responseText);r?e.call(r,i):e(i)})};var nt=function(t){var e=t.getBoundingClientRect(),n=t.ownerDocument,r=n.body,i=n.documentElement,o=i.clientTop||r.clientTop||0,s=i.clientLeft||r.clientLeft||0,a=e.top+(g.win.pageYOffset||i.scrollTop||r.scrollTop)-o,u=e.left+(g.win.pageXOffset||i.scrollLeft||r.scrollLeft)-s;return{y:a,x:u}};return n.getElementByPoint=function(t,e){var n=this,r=(n.canvas,T.doc.elementFromPoint(t,e));if(T.win.opera&&"svg"==r.tagName){var i=nt(r),o=r.createSVGRect();o.x=t-i.x,o.y=e-i.y,o.width=o.height=1;var s=r.getIntersectionList(o,null);s.length&&(r=s[s.length-1])}return r?k(r):null},n.plugin=function(t){t(n,y,w,T,x)},T.win.Snap=n,n}(t||this);return r.plugin(function(r,i,o,s,a){function u(t,e){if(null==e){var n=!0;if(e="linearGradient"==t.type||"radialGradient"==t.type?t.node.getAttribute("gradientTransform"):"pattern"==t.type?t.node.getAttribute("patternTransform"):t.node.getAttribute("transform"),!e)return new r.Matrix;e=r._.svgTransform2string(e)}else e=r._.rgTransform.test(e)?d(e).replace(/\.{3}|\u2026/g,t._.transform||""):r._.svgTransform2string(e),p(e,"array")&&(e=r.path?r.path.toString.call(e):d(e)),t._.transform=e;var i=r._.transform2matrix(e,t.getBBox(1));return n?i:void(t.matrix=i)}function l(t){function e(t,e){var n=m(t.node,e);n=n&&n.match(o),n=n&&n[2],n&&"#"==n.charAt()&&(n=n.substring(1),n&&(a[n]=(a[n]||[]).concat(function(n){var r={};r[e]=URL(n),m(t.node,r)})))}function n(t){var e=m(t.node,"xlink:href");e&&"#"==e.charAt()&&(e=e.substring(1),e&&(a[e]=(a[e]||[]).concat(function(e){t.attr("xlink:href","#"+e)})))}for(var r,i=t.selectAll("*"),o=/^\s*url\(("|'|)(.*)\1\)\s*$/,s=[],a={},u=0,l=i.length;u<l;u++){r=i[u],e(r,"fill"),e(r,"stroke"),e(r,"filter"),e(r,"mask"),e(r,"clip-path"),n(r);var c=m(r.node,"id");c&&(m(r.node,{id:r.id}),s.push({old:c,id:r.id}))}for(u=0,l=s.length;u<l;u++){var h=a[s[u].old];if(h)for(var f=0,p=h.length;f<p;f++)h[f](s[u].id)}}function c(t,e,n){return function(r){var i=r.slice(t,e);return 1==i.length&&(i=i[0]),n?n(i):i}}function h(t){return function(){var e=t?"<"+this.type:"",n=this.node.attributes,r=this.node.childNodes;if(t)for(var i=0,o=n.length;i<o;i++)e+=" "+n[i].name+'="'+n[i].value.replace(/"/g,'\\"')+'"';if(r.length){for(t&&(e+=">"),i=0,o=r.length;i<o;i++)3==r[i].nodeType?e+=r[i].nodeValue:1==r[i].nodeType&&(e+=b(r[i]).toString());t&&(e+="</"+this.type+">")}else t&&(e+="/>");return e}}var f=i.prototype,p=r.is,d=String,v=r._unit2px,m=r._.$,g=r._.make,y=r._.getSomeDefs,x="hasOwnProperty",b=r._.wrap;f.getBBox=function(t){if(!r.Matrix||!r.path)return this.node.getBBox();var e=this,n=new r.Matrix;if(e.removed)return r._.box();for(;"use"==e.type;)if(t||(n=n.add(e.transform().localMatrix.translate(e.attr("x")||0,e.attr("y")||0))),e.original)e=e.original;else{var i=e.attr("xlink:href");e=e.original=e.node.ownerDocument.getElementById(i.substring(i.indexOf("#")+1))}var o=e._,s=r.path.get[e.type]||r.path.get.deflt;try{return t?(o.bboxwt=s?r.path.getBBox(e.realPath=s(e)):r._.box(e.node.getBBox()),r._.box(o.bboxwt)):(e.realPath=s(e),e.matrix=e.transform().localMatrix,o.bbox=r.path.getBBox(r.path.map(e.realPath,n.add(e.matrix))),r._.box(o.bbox))}catch(t){return r._.box()}};var w=function(){return this.string};f.transform=function(t){var e=this._;if(null==t){for(var n,i=this,o=new r.Matrix(this.node.getCTM()),s=u(this),a=[s],l=new r.Matrix,c=s.toTransformString(),h=d(s)==d(this.matrix)?d(e.transform):c;"svg"!=i.type&&(i=i.parent());)a.push(u(i));for(n=a.length;n--;)l.add(a[n]);return{string:h,globalMatrix:o,totalMatrix:l,localMatrix:s,diffMatrix:o.clone().add(s.invert()),global:o.toTransformString(),total:l.toTransformString(),local:c,toString:w}}return t instanceof r.Matrix?(this.matrix=t,this._.transform=t.toTransformString()):u(this,t),this.node&&("linearGradient"==this.type||"radialGradient"==this.type?m(this.node,{gradientTransform:this.matrix}):"pattern"==this.type?m(this.node,{patternTransform:this.matrix}):m(this.node,{transform:this.matrix})),this},f.parent=function(){return b(this.node.parentNode)},f.append=f.add=function(t){if(t){if("set"==t.type){var e=this;return t.forEach(function(t){e.add(t)}),this}t=b(t),this.node.appendChild(t.node),t.paper=this.paper}return this},f.appendTo=function(t){return t&&(t=b(t),t.append(this)),this},f.prepend=function(t){if(t){if("set"==t.type){var e,n=this;return t.forEach(function(t){e?e.after(t):n.prepend(t),e=t}),this}t=b(t);var r=t.parent();this.node.insertBefore(t.node,this.node.firstChild),this.add&&this.add(),t.paper=this.paper,this.parent()&&this.parent().add(),r&&r.add()}return this},f.prependTo=function(t){return t=b(t),t.prepend(this),this},f.before=function(t){if("set"==t.type){var e=this;return t.forEach(function(t){var n=t.parent();e.node.parentNode.insertBefore(t.node,e.node),n&&n.add()}),this.parent().add(),this}t=b(t);var n=t.parent();return this.node.parentNode.insertBefore(t.node,this.node),this.parent()&&this.parent().add(),n&&n.add(),t.paper=this.paper,this},f.after=function(t){t=b(t);var e=t.parent();return this.node.nextSibling?this.node.parentNode.insertBefore(t.node,this.node.nextSibling):this.node.parentNode.appendChild(t.node),this.parent()&&this.parent().add(),e&&e.add(),t.paper=this.paper,this},f.insertBefore=function(t){t=b(t);var e=this.parent();return t.node.parentNode.insertBefore(this.node,t.node),this.paper=t.paper,e&&e.add(),t.parent()&&t.parent().add(),this},f.insertAfter=function(t){t=b(t);var e=this.parent();return t.node.parentNode.insertBefore(this.node,t.node.nextSibling),this.paper=t.paper,e&&e.add(),t.parent()&&t.parent().add(),
this},f.remove=function(){var t=this.parent();return this.node.parentNode&&this.node.parentNode.removeChild(this.node),delete this.paper,this.removed=!0,t&&t.add(),this},f.select=function(t){return b(this.node.querySelector(t))},f.selectAll=function(t){for(var e=this.node.querySelectorAll(t),n=(r.set||Array)(),i=0;i<e.length;i++)n.push(b(e[i]));return n},f.asPX=function(t,e){return null==e&&(e=this.attr(t)),+v(this,t,e)},f.use=function(){var t,e=this.node.id;return e||(e=this.id,m(this.node,{id:e})),t="linearGradient"==this.type||"radialGradient"==this.type||"pattern"==this.type?g(this.type,this.node.parentNode):g("use",this.node.parentNode),m(t.node,{"xlink:href":"#"+e}),t.original=this,t},f.clone=function(){var t=b(this.node.cloneNode(!0));return m(t.node,"id")&&m(t.node,{id:t.id}),l(t),t.insertAfter(this),t},f.toDefs=function(){var t=y(this);return t.appendChild(this.node),this},f.pattern=f.toPattern=function(t,e,n,r){var i=g("pattern",y(this));return null==t&&(t=this.getBBox()),p(t,"object")&&"x"in t&&(e=t.y,n=t.width,r=t.height,t=t.x),m(i.node,{x:t,y:e,width:n,height:r,patternUnits:"userSpaceOnUse",id:i.id,viewBox:[t,e,n,r].join(" ")}),i.node.appendChild(this.node),i},f.marker=function(t,e,n,r,i,o){var s=g("marker",y(this));return null==t&&(t=this.getBBox()),p(t,"object")&&"x"in t&&(e=t.y,n=t.width,r=t.height,i=t.refX||t.cx,o=t.refY||t.cy,t=t.x),m(s.node,{viewBox:[t,e,n,r].join(" "),markerWidth:n,markerHeight:r,orient:"auto",refX:i||0,refY:o||0,id:s.id}),s.node.appendChild(this.node),s};var k=function(t,e,r,i){"function"!=typeof r||r.length||(i=r,r=n.linear),this.attr=t,this.dur=e,r&&(this.easing=r),i&&(this.callback=i)};r._.Animation=k,r.animation=function(t,e,n,r){return new k(t,e,n,r)},f.inAnim=function(){var t=this,e=[];for(var n in t.anims)t.anims[x](n)&&!function(t){e.push({anim:new k(t._attrs,t.dur,t.easing,t._callback),mina:t,curStatus:t.status(),status:function(e){return t.status(e)},stop:function(){t.stop()}})}(t.anims[n]);return e},r.animate=function(t,r,i,o,s,a){"function"!=typeof s||s.length||(a=s,s=n.linear);var u=n.time(),l=n(t,r,u,u+o,n.time,i,s);return a&&e.once("mina.finish."+l.id,a),l},f.stop=function(){for(var t=this.inAnim(),e=0,n=t.length;e<n;e++)t[e].stop();return this},f.animate=function(t,r,i,o){"function"!=typeof i||i.length||(o=i,i=n.linear),t instanceof k&&(o=t.callback,i=t.easing,r=t.dur,t=t.attr);var s,a,u,l,h=[],f=[],v={},m=this;for(var g in t)if(t[x](g)){m.equal?(l=m.equal(g,d(t[g])),s=l.from,a=l.to,u=l.f):(s=+m.attr(g),a=+t[g]);var y=p(s,"array")?s.length:1;v[g]=c(h.length,h.length+y,u),h=h.concat(s),f=f.concat(a)}var b=n.time(),w=n(h,f,b,b+r,n.time,function(t){var e={};for(var n in v)v[x](n)&&(e[n]=v[n](t));m.attr(e)},i);return m.anims[w.id]=w,w._attrs=t,w._callback=o,e("snap.animcreated."+m.id,w),e.once("mina.finish."+w.id,function(){delete m.anims[w.id],o&&o.call(m)}),e.once("mina.stop."+w.id,function(){delete m.anims[w.id]}),m};var S={};f.data=function(t,n){var i=S[this.id]=S[this.id]||{};if(0==arguments.length)return e("snap.data.get."+this.id,this,i,null),i;if(1==arguments.length){if(r.is(t,"object")){for(var o in t)t[x](o)&&this.data(o,t[o]);return this}return e("snap.data.get."+this.id,this,i[t],t),i[t]}return i[t]=n,e("snap.data.set."+this.id,this,n,t),this},f.removeData=function(t){return null==t?S[this.id]={}:S[this.id]&&delete S[this.id][t],this},f.outerSVG=f.toString=h(1),f.innerSVG=h(),f.toDataURL=function(){if(t&&t.btoa){var e=this.getBBox(),n=r.format('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="{width}" height="{height}" viewBox="{x} {y} {width} {height}">{contents}</svg>',{x:+e.x.toFixed(3),y:+e.y.toFixed(3),width:+e.width.toFixed(3),height:+e.height.toFixed(3),contents:this.outerSVG()});return"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(n)))}},a.prototype.select=f.select,a.prototype.selectAll=f.selectAll}),r.plugin(function(t,e,n,r,i){function o(t,e,n,r,i,o){return null==e&&"[object SVGMatrix]"==s.call(t)?(this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.e=t.e,void(this.f=t.f)):void(null!=t?(this.a=+t,this.b=+e,this.c=+n,this.d=+r,this.e=+i,this.f=+o):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0))}var s=Object.prototype.toString,a=String,u=Math,l="";!function(e){function n(t){return t[0]*t[0]+t[1]*t[1]}function r(t){var e=u.sqrt(n(t));t[0]&&(t[0]/=e),t[1]&&(t[1]/=e)}e.add=function(t,e,n,r,i,s){var a,u,l,c,h=[[],[],[]],f=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],p=[[t,n,i],[e,r,s],[0,0,1]];for(t&&t instanceof o&&(p=[[t.a,t.c,t.e],[t.b,t.d,t.f],[0,0,1]]),a=0;a<3;a++)for(u=0;u<3;u++){for(c=0,l=0;l<3;l++)c+=f[a][l]*p[l][u];h[a][u]=c}return this.a=h[0][0],this.b=h[1][0],this.c=h[0][1],this.d=h[1][1],this.e=h[0][2],this.f=h[1][2],this},e.invert=function(){var t=this,e=t.a*t.d-t.b*t.c;return new o(t.d/e,-t.b/e,-t.c/e,t.a/e,(t.c*t.f-t.d*t.e)/e,(t.b*t.e-t.a*t.f)/e)},e.clone=function(){return new o(this.a,this.b,this.c,this.d,this.e,this.f)},e.translate=function(t,e){return this.add(1,0,0,1,t,e)},e.scale=function(t,e,n,r){return null==e&&(e=t),(n||r)&&this.add(1,0,0,1,n,r),this.add(t,0,0,e,0,0),(n||r)&&this.add(1,0,0,1,-n,-r),this},e.rotate=function(e,n,r){e=t.rad(e),n=n||0,r=r||0;var i=+u.cos(e).toFixed(9),o=+u.sin(e).toFixed(9);return this.add(i,o,-o,i,n,r),this.add(1,0,0,1,-n,-r)},e.x=function(t,e){return t*this.a+e*this.c+this.e},e.y=function(t,e){return t*this.b+e*this.d+this.f},e.get=function(t){return+this[a.fromCharCode(97+t)].toFixed(4)},e.toString=function(){return"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")"},e.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},e.determinant=function(){return this.a*this.d-this.b*this.c},e.split=function(){var e={};e.dx=this.e,e.dy=this.f;var i=[[this.a,this.c],[this.b,this.d]];e.scalex=u.sqrt(n(i[0])),r(i[0]),e.shear=i[0][0]*i[1][0]+i[0][1]*i[1][1],i[1]=[i[1][0]-i[0][0]*e.shear,i[1][1]-i[0][1]*e.shear],e.scaley=u.sqrt(n(i[1])),r(i[1]),e.shear/=e.scaley,this.determinant()<0&&(e.scalex=-e.scalex);var o=-i[0][1],s=i[1][1];return s<0?(e.rotate=t.deg(u.acos(s)),o<0&&(e.rotate=360-e.rotate)):e.rotate=t.deg(u.asin(o)),e.isSimple=!(+e.shear.toFixed(9)||e.scalex.toFixed(9)!=e.scaley.toFixed(9)&&e.rotate),e.isSuperSimple=!+e.shear.toFixed(9)&&e.scalex.toFixed(9)==e.scaley.toFixed(9)&&!e.rotate,e.noRotation=!+e.shear.toFixed(9)&&!e.rotate,e},e.toTransformString=function(t){var e=t||this.split();return+e.shear.toFixed(9)?"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]:(e.scalex=+e.scalex.toFixed(4),e.scaley=+e.scaley.toFixed(4),e.rotate=+e.rotate.toFixed(4),(e.dx||e.dy?"t"+[+e.dx.toFixed(4),+e.dy.toFixed(4)]:l)+(1!=e.scalex||1!=e.scaley?"s"+[e.scalex,e.scaley,0,0]:l)+(e.rotate?"r"+[+e.rotate.toFixed(4),0,0]:l))}}(o.prototype),t.Matrix=o,t.matrix=function(t,e,n,r,i,s){return new o(t,e,n,r,i,s)}}),r.plugin(function(t,n,r,i,o){function s(r){return function(i){if(e.stop(),i instanceof o&&1==i.node.childNodes.length&&("radialGradient"==i.node.firstChild.tagName||"linearGradient"==i.node.firstChild.tagName||"pattern"==i.node.firstChild.tagName)&&(i=i.node.firstChild,p(this).appendChild(i),i=h(i)),i instanceof n)if("radialGradient"==i.type||"linearGradient"==i.type||"pattern"==i.type){i.node.id||v(i.node,{id:i.id});var s=m(i.node.id)}else s=i.attr(r);else if(s=t.color(i),s.error){var a=t(p(this).ownerSVGElement).gradient(i);a?(a.node.id||v(a.node,{id:a.id}),s=m(a.node.id)):s=i}else s=g(s);var u={};u[r]=s,v(this.node,u),this.node.style[r]=x}}function a(t){e.stop(),t==+t&&(t+="px"),this.node.style.fontSize=t}function u(t){for(var e=[],n=t.childNodes,r=0,i=n.length;r<i;r++){var o=n[r];3==o.nodeType&&e.push(o.nodeValue),"tspan"==o.tagName&&(1==o.childNodes.length&&3==o.firstChild.nodeType?e.push(o.firstChild.nodeValue):e.push(u(o)))}return e}function l(){return e.stop(),this.node.style.fontSize}var c=t._.make,h=t._.wrap,f=t.is,p=t._.getSomeDefs,d=/^url\(#?([^)]+)\)$/,v=t._.$,m=t.url,g=String,y=t._.separator,x="";e.on("snap.util.attr.mask",function(t){if(t instanceof n||t instanceof o){if(e.stop(),t instanceof o&&1==t.node.childNodes.length&&(t=t.node.firstChild,p(this).appendChild(t),t=h(t)),"mask"==t.type)var r=t;else r=c("mask",p(this)),r.node.appendChild(t.node);!r.node.id&&v(r.node,{id:r.id}),v(this.node,{mask:m(r.id)})}}),function(t){e.on("snap.util.attr.clip",t),e.on("snap.util.attr.clip-path",t),e.on("snap.util.attr.clipPath",t)}(function(t){if(t instanceof n||t instanceof o){if(e.stop(),"clipPath"==t.type)var r=t;else r=c("clipPath",p(this)),r.node.appendChild(t.node),!r.node.id&&v(r.node,{id:r.id});v(this.node,{"clip-path":m(r.node.id||r.id)})}}),e.on("snap.util.attr.fill",s("fill")),e.on("snap.util.attr.stroke",s("stroke"));var b=/^([lr])(?:\(([^)]*)\))?(.*)$/i;e.on("snap.util.grad.parse",function(t){t=g(t);var e=t.match(b);if(!e)return null;var n=e[1],r=e[2],i=e[3];return r=r.split(/\s*,\s*/).map(function(t){return+t==t?+t:t}),1==r.length&&0==r[0]&&(r=[]),i=i.split("-"),i=i.map(function(t){t=t.split(":");var e={color:t[0]};return t[1]&&(e.offset=parseFloat(t[1])),e}),{type:n,params:r,stops:i}}),e.on("snap.util.attr.d",function(n){e.stop(),f(n,"array")&&f(n[0],"array")&&(n=t.path.toString.call(n)),n=g(n),n.match(/[ruo]/i)&&(n=t.path.toAbsolute(n)),v(this.node,{d:n})})(-1),e.on("snap.util.attr.#text",function(t){e.stop(),t=g(t);for(var n=i.doc.createTextNode(t);this.node.firstChild;)this.node.removeChild(this.node.firstChild);this.node.appendChild(n)})(-1),e.on("snap.util.attr.path",function(t){e.stop(),this.attr({d:t})})(-1),e.on("snap.util.attr.class",function(t){e.stop(),this.node.className.baseVal=t})(-1),e.on("snap.util.attr.viewBox",function(t){var n;n=f(t,"object")&&"x"in t?[t.x,t.y,t.width,t.height].join(" "):f(t,"array")?t.join(" "):t,v(this.node,{viewBox:n}),e.stop()})(-1),e.on("snap.util.attr.transform",function(t){this.transform(t),e.stop()})(-1),e.on("snap.util.attr.r",function(t){"rect"==this.type&&(e.stop(),v(this.node,{rx:t,ry:t}))})(-1),e.on("snap.util.attr.textpath",function(t){if(e.stop(),"text"==this.type){var r,i,o;if(!t&&this.textPath){for(i=this.textPath;i.node.firstChild;)this.node.appendChild(i.node.firstChild);return i.remove(),void delete this.textPath}if(f(t,"string")){var s=p(this),a=h(s.parentNode).path(t);s.appendChild(a.node),r=a.id,a.attr({id:r})}else t=h(t),t instanceof n&&(r=t.attr("id"),r||(r=t.id,t.attr({id:r})));if(r)if(i=this.textPath,o=this.node,i)i.attr({"xlink:href":"#"+r});else{for(i=v("textPath",{"xlink:href":"#"+r});o.firstChild;)i.appendChild(o.firstChild);o.appendChild(i),this.textPath=h(i)}}})(-1),e.on("snap.util.attr.text",function(t){if("text"==this.type){for(var n=this.node,r=function(t){var e=v("tspan");if(f(t,"array"))for(var n=0;n<t.length;n++)e.appendChild(r(t[n]));else e.appendChild(i.doc.createTextNode(t));return e.normalize&&e.normalize(),e};n.firstChild;)n.removeChild(n.firstChild);for(var o=r(t);o.firstChild;)n.appendChild(o.firstChild)}e.stop()})(-1),e.on("snap.util.attr.fontSize",a)(-1),e.on("snap.util.attr.font-size",a)(-1),e.on("snap.util.getattr.transform",function(){return e.stop(),this.transform()})(-1),e.on("snap.util.getattr.textpath",function(){return e.stop(),this.textPath})(-1),function(){function n(n){return function(){e.stop();var r=i.doc.defaultView.getComputedStyle(this.node,null).getPropertyValue("marker-"+n);return"none"==r?r:t(i.doc.getElementById(r.match(d)[1]))}}function r(t){return function(n){e.stop();var r="marker"+t.charAt(0).toUpperCase()+t.substring(1);if(""==n||!n)return void(this.node.style[r]="none");if("marker"==n.type){var i=n.node.id;return i||v(n.node,{id:n.id}),void(this.node.style[r]=m(i))}}}e.on("snap.util.getattr.marker-end",n("end"))(-1),e.on("snap.util.getattr.markerEnd",n("end"))(-1),e.on("snap.util.getattr.marker-start",n("start"))(-1),e.on("snap.util.getattr.markerStart",n("start"))(-1),e.on("snap.util.getattr.marker-mid",n("mid"))(-1),e.on("snap.util.getattr.markerMid",n("mid"))(-1),e.on("snap.util.attr.marker-end",r("end"))(-1),e.on("snap.util.attr.markerEnd",r("end"))(-1),e.on("snap.util.attr.marker-start",r("start"))(-1),e.on("snap.util.attr.markerStart",r("start"))(-1),e.on("snap.util.attr.marker-mid",r("mid"))(-1),e.on("snap.util.attr.markerMid",r("mid"))(-1)}(),e.on("snap.util.getattr.r",function(){if("rect"==this.type&&v(this.node,"rx")==v(this.node,"ry"))return e.stop(),v(this.node,"rx")})(-1),e.on("snap.util.getattr.text",function(){if("text"==this.type||"tspan"==this.type){e.stop();var t=u(this.node);return 1==t.length?t[0]:t}})(-1),e.on("snap.util.getattr.#text",function(){return this.node.textContent})(-1),e.on("snap.util.getattr.viewBox",function(){e.stop();var n=v(this.node,"viewBox");return n?(n=n.split(y),t._.box(+n[0],+n[1],+n[2],+n[3])):void 0})(-1),e.on("snap.util.getattr.points",function(){var t=v(this.node,"points");return e.stop(),t?t.split(y):void 0})(-1),e.on("snap.util.getattr.path",function(){var t=v(this.node,"d");return e.stop(),t})(-1),e.on("snap.util.getattr.class",function(){return this.node.className.baseVal})(-1),e.on("snap.util.getattr.fontSize",l)(-1),e.on("snap.util.getattr.font-size",l)(-1)}),r.plugin(function(t,e,n,r,i){var o=/\S+/g,s=String,a=e.prototype;a.addClass=function(t){var e,n,r,i,a=s(t||"").match(o)||[],u=this.node,l=u.className.baseVal,c=l.match(o)||[];if(a.length){for(e=0;r=a[e++];)n=c.indexOf(r),~n||c.push(r);i=c.join(" "),l!=i&&(u.className.baseVal=i)}return this},a.removeClass=function(t){var e,n,r,i,a=s(t||"").match(o)||[],u=this.node,l=u.className.baseVal,c=l.match(o)||[];if(c.length){for(e=0;r=a[e++];)n=c.indexOf(r),~n&&c.splice(n,1);i=c.join(" "),l!=i&&(u.className.baseVal=i)}return this},a.hasClass=function(t){var e=this.node,n=e.className.baseVal,r=n.match(o)||[];return!!~r.indexOf(t)},a.toggleClass=function(t,e){if(null!=e)return e?this.addClass(t):this.removeClass(t);var n,r,i,s,a=(t||"").match(o)||[],u=this.node,l=u.className.baseVal,c=l.match(o)||[];for(n=0;i=a[n++];)r=c.indexOf(i),~r?c.splice(r,1):c.push(i);return s=c.join(" "),l!=s&&(u.className.baseVal=s),this}}),r.plugin(function(t,n,r,i,o){function s(t){return t}function a(t){return function(e){return+e.toFixed(3)+t}}var u={"+":function(t,e){return t+e},"-":function(t,e){return t-e},"/":function(t,e){return t/e},"*":function(t,e){return t*e}},l=String,c=/[a-z]+$/i,h=/^\s*([+\-\/*])\s*=\s*([\d.eE+\-]+)\s*([^\d\s]+)?\s*$/;e.on("snap.util.attr",function(t){var n=l(t).match(h);if(n){var r=e.nt(),i=r.substring(r.lastIndexOf(".")+1),o=this.attr(i),s={};e.stop();var a=n[3]||"",f=o.match(c),p=u[n[1]];if(f&&f==a?t=p(parseFloat(o),+n[2]):(o=this.asPX(i),t=p(this.asPX(i),this.asPX(i,n[2]+a))),isNaN(o)||isNaN(t))return;s[i]=t,this.attr(s)}})(-10),e.on("snap.util.equal",function(t,n){var r=l(this.attr(t)||""),i=l(n).match(h);if(i){e.stop();var o=i[3]||"",f=r.match(c),p=u[i[1]];return f&&f==o?{from:parseFloat(r),to:p(parseFloat(r),+i[2]),f:a(f)}:(r=this.asPX(t),{from:r,to:p(r,this.asPX(t,i[2]+o)),f:s})}})(-10)}),r.plugin(function(n,r,i,o,s){var a=i.prototype,u=n.is;a.rect=function(t,e,n,r,i,o){var s;return null==o&&(o=i),u(t,"object")&&"[object Object]"==t?s=t:null!=t&&(s={x:t,y:e,width:n,height:r},null!=i&&(s.rx=i,s.ry=o)),this.el("rect",s)},a.circle=function(t,e,n){var r;return u(t,"object")&&"[object Object]"==t?r=t:null!=t&&(r={cx:t,cy:e,r:n}),this.el("circle",r)};var l=function(){function t(){this.parentNode.removeChild(this)}return function(e,n){var r=o.doc.createElement("img"),i=o.doc.body;r.style.cssText="position:absolute;left:-9999em;top:-9999em",r.onload=function(){n.call(r),r.onload=r.onerror=null,i.removeChild(r)},r.onerror=t,i.appendChild(r),r.src=e}}();a.image=function(t,e,r,i,o){var s=this.el("image");if(u(t,"object")&&"src"in t)s.attr(t);else if(null!=t){var a={"xlink:href":t,preserveAspectRatio:"none"};null!=e&&null!=r&&(a.x=e,a.y=r),null!=i&&null!=o?(a.width=i,a.height=o):l(t,function(){n._.$(s.node,{width:this.offsetWidth,height:this.offsetHeight})}),n._.$(s.node,a)}return s},a.ellipse=function(t,e,n,r){var i;return u(t,"object")&&"[object Object]"==t?i=t:null!=t&&(i={cx:t,cy:e,rx:n,ry:r}),this.el("ellipse",i)},a.path=function(t){var e;return u(t,"object")&&!u(t,"array")?e=t:t&&(e={d:t}),this.el("path",e)},a.group=a.g=function(t){var e=this.el("g");return 1==arguments.length&&t&&!t.type?e.attr(t):arguments.length&&e.add(Array.prototype.slice.call(arguments,0)),e},a.svg=function(t,e,n,r,i,o,s,a){var l={};return u(t,"object")&&null==e?l=t:(null!=t&&(l.x=t),null!=e&&(l.y=e),null!=n&&(l.width=n),null!=r&&(l.height=r),null!=i&&null!=o&&null!=s&&null!=a&&(l.viewBox=[i,o,s,a])),this.el("svg",l)},a.mask=function(t){var e=this.el("mask");return 1==arguments.length&&t&&!t.type?e.attr(t):arguments.length&&e.add(Array.prototype.slice.call(arguments,0)),e},a.ptrn=function(t,e,n,r,i,o,s,a){if(u(t,"object"))var l=t;else l={patternUnits:"userSpaceOnUse"},t&&(l.x=t),e&&(l.y=e),null!=n&&(l.width=n),null!=r&&(l.height=r),null!=i&&null!=o&&null!=s&&null!=a?l.viewBox=[i,o,s,a]:l.viewBox=[t||0,e||0,n||0,r||0];return this.el("pattern",l)},a.use=function(t){return null!=t?(t instanceof r&&(t.attr("id")||t.attr({id:n._.id(t)}),t=t.attr("id")),"#"==String(t).charAt()&&(t=t.substring(1)),this.el("use",{"xlink:href":"#"+t})):r.prototype.use.call(this)},a.symbol=function(t,e,n,r){var i={};return null!=t&&null!=e&&null!=n&&null!=r&&(i.viewBox=[t,e,n,r]),this.el("symbol",i)},a.text=function(t,e,n){var r={};return u(t,"object")?r=t:null!=t&&(r={x:t,y:e,text:n||""}),this.el("text",r)},a.line=function(t,e,n,r){var i={};return u(t,"object")?i=t:null!=t&&(i={x1:t,x2:n,y1:e,y2:r}),this.el("line",i)},a.polyline=function(t){arguments.length>1&&(t=Array.prototype.slice.call(arguments,0));var e={};return u(t,"object")&&!u(t,"array")?e=t:null!=t&&(e={points:t}),this.el("polyline",e)},a.polygon=function(t){arguments.length>1&&(t=Array.prototype.slice.call(arguments,0));var e={};return u(t,"object")&&!u(t,"array")?e=t:null!=t&&(e={points:t}),this.el("polygon",e)},function(){function r(){return this.selectAll("stop")}function i(t,e){var r=c("stop"),i={offset:+e+"%"};return t=n.color(t),i["stop-color"]=t.hex,t.opacity<1&&(i["stop-opacity"]=t.opacity),c(r,i),this.node.appendChild(r),this}function o(){if("linearGradient"==this.type){var t=c(this.node,"x1")||0,e=c(this.node,"x2")||1,r=c(this.node,"y1")||0,i=c(this.node,"y2")||0;return n._.box(t,r,math.abs(e-t),math.abs(i-r))}var o=this.node.cx||.5,s=this.node.cy||.5,a=this.node.r||0;return n._.box(o-a,s-a,2*a,2*a)}function s(t,n){function r(t,e){for(var n=(e-h)/(t-f),r=f;r<t;r++)s[r].offset=+(+h+n*(r-f)).toFixed(2);f=t,h=e}var i,o=e("snap.util.grad.parse",null,n).firstDefined();if(!o)return null;o.params.unshift(t),i="l"==o.type.toLowerCase()?u.apply(0,o.params):l.apply(0,o.params),o.type!=o.type.toLowerCase()&&c(i.node,{gradientUnits:"userSpaceOnUse"});var s=o.stops,a=s.length,h=0,f=0;a--;for(var p=0;p<a;p++)"offset"in s[p]&&r(p,s[p].offset);for(s[a].offset=s[a].offset||100,r(a,s[a].offset),p=0;p<=a;p++){var d=s[p];i.addStop(d.color,d.offset)}return i}function u(t,e,s,a,u){var l=n._.make("linearGradient",t);return l.stops=r,l.addStop=i,l.getBBox=o,null!=e&&c(l.node,{x1:e,y1:s,x2:a,y2:u}),l}function l(t,e,s,a,u,l){var h=n._.make("radialGradient",t);return h.stops=r,h.addStop=i,h.getBBox=o,null!=e&&c(h.node,{cx:e,cy:s,r:a}),null!=u&&null!=l&&c(h.node,{fx:u,fy:l}),h}var c=n._.$;a.gradient=function(t){return s(this.defs,t)},a.gradientLinear=function(t,e,n,r){return u(this.defs,t,e,n,r)},a.gradientRadial=function(t,e,n,r,i){return l(this.defs,t,e,n,r,i)},a.toString=function(){var t,e=this.node.ownerDocument,r=e.createDocumentFragment(),i=e.createElement("div"),o=this.node.cloneNode(!0);return r.appendChild(i),i.appendChild(o),n._.$(o,{xmlns:"http://www.w3.org/2000/svg"}),t=i.innerHTML,r.removeChild(r.firstChild),t},a.toDataURL=function(){if(t&&t.btoa)return"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(this)))},a.clear=function(){for(var t,e=this.node.firstChild;e;)t=e.nextSibling,"defs"!=e.tagName?e.parentNode.removeChild(e):a.clear.call({node:e}),e=t}}()}),r.plugin(function(t,e,n,r){function i(t){var e=i.ps=i.ps||{};return e[t]?e[t].sleep=100:e[t]={sleep:100},setTimeout(function(){for(var n in e)e[q](n)&&n!=t&&(e[n].sleep--,!e[n].sleep&&delete e[n])}),e[t]}function o(t,e,n,r){return null==t&&(t=e=n=r=0),null==e&&(e=t.y,n=t.width,r=t.height,t=t.x),{x:t,y:e,width:n,w:n,height:r,h:r,x2:t+n,y2:e+r,cx:t+n/2,cy:e+r/2,r1:I.min(n,r)/2,r2:I.max(n,r)/2,r0:I.sqrt(n*n+r*r)/2,path:T(t,e,n,r),vb:[t,e,n,r].join(" ")}}function s(){return this.join(",").replace(D,"$1")}function a(t){var e=F(t);return e.toString=s,e}function u(t,e,n,r,i,o,s,a,u){return null==u?v(t,e,n,r,i,o,s,a):c(t,e,n,r,i,o,s,a,m(t,e,n,r,i,o,s,a,u))}function l(n,r){function i(t){return+(+t).toFixed(3)}return t._.cacher(function(t,o,s){t instanceof e&&(t=t.attr("d")),t=O(t);for(var a,l,h,f,p,d="",v={},m=0,g=0,y=t.length;g<y;g++){if(h=t[g],"M"==h[0])a=+h[1],l=+h[2];else{if(f=u(a,l,h[1],h[2],h[3],h[4],h[5],h[6]),m+f>o){if(r&&!v.start){if(p=u(a,l,h[1],h[2],h[3],h[4],h[5],h[6],o-m),d+=["C"+i(p.start.x),i(p.start.y),i(p.m.x),i(p.m.y),i(p.x),i(p.y)],s)return d;v.start=d,d=["M"+i(p.x),i(p.y)+"C"+i(p.n.x),i(p.n.y),i(p.end.x),i(p.end.y),i(h[5]),i(h[6])].join(),m+=f,a=+h[5],l=+h[6];continue}if(!n&&!r)return p=u(a,l,h[1],h[2],h[3],h[4],h[5],h[6],o-m)}m+=f,a=+h[5],l=+h[6]}d+=h.shift()+h}return v.end=d,p=n?m:r?v:c(a,l,h[0],h[1],h[2],h[3],h[4],h[5],1)},null,t._.clone)}function c(t,e,n,r,i,o,s,a,u){var l=1-u,c=G(l,3),h=G(l,2),f=u*u,p=f*u,d=c*t+3*h*u*n+3*l*u*u*i+p*s,v=c*e+3*h*u*r+3*l*u*u*o+p*a,m=t+2*u*(n-t)+f*(i-2*n+t),g=e+2*u*(r-e)+f*(o-2*r+e),y=n+2*u*(i-n)+f*(s-2*i+n),x=r+2*u*(o-r)+f*(a-2*o+r),b=l*t+u*n,w=l*e+u*r,k=l*i+u*s,S=l*o+u*a,T=90-180*I.atan2(m-y,g-x)/z;return{x:d,y:v,m:{x:m,y:g},n:{x:y,y:x},start:{x:b,y:w},end:{x:k,y:S},alpha:T}}function h(e,n,r,i,s,a,u,l){t.is(e,"array")||(e=[e,n,r,i,s,a,u,l]);var c=A.apply(null,e);return o(c.min.x,c.min.y,c.max.x-c.min.x,c.max.y-c.min.y)}function f(t,e,n){return e>=t.x&&e<=t.x+t.width&&n>=t.y&&n<=t.y+t.height}function p(t,e){return t=o(t),e=o(e),f(e,t.x,t.y)||f(e,t.x2,t.y)||f(e,t.x,t.y2)||f(e,t.x2,t.y2)||f(t,e.x,e.y)||f(t,e.x2,e.y)||f(t,e.x,e.y2)||f(t,e.x2,e.y2)||(t.x<e.x2&&t.x>e.x||e.x<t.x2&&e.x>t.x)&&(t.y<e.y2&&t.y>e.y||e.y<t.y2&&e.y>t.y)}function d(t,e,n,r,i){var o=-3*e+9*n-9*r+3*i,s=t*o+6*e-12*n+6*r;return t*s-3*e+3*n}function v(t,e,n,r,i,o,s,a,u){null==u&&(u=1),u=u>1?1:u<0?0:u;for(var l=u/2,c=12,h=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],f=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],p=0,v=0;v<c;v++){var m=l*h[v]+l,g=d(m,t,n,i,s),y=d(m,e,r,o,a),x=g*g+y*y;p+=f[v]*I.sqrt(x)}return l*p}function m(t,e,n,r,i,o,s,a,u){if(!(u<0||v(t,e,n,r,i,o,s,a)<u)){var l,c=1,h=c/2,f=c-h,p=.01;for(l=v(t,e,n,r,i,o,s,a,f);Y(l-u)>p;)h/=2,f+=(l<u?1:-1)*h,l=v(t,e,n,r,i,o,s,a,f);return f}}function g(t,e,n,r,i,o,s,a){if(!(U(t,n)<X(i,s)||X(t,n)>U(i,s)||U(e,r)<X(o,a)||X(e,r)>U(o,a))){var u=(t*r-e*n)*(i-s)-(t-n)*(i*a-o*s),l=(t*r-e*n)*(o-a)-(e-r)*(i*a-o*s),c=(t-n)*(o-a)-(e-r)*(i-s);if(c){var h=u/c,f=l/c,p=+h.toFixed(2),d=+f.toFixed(2);if(!(p<+X(t,n).toFixed(2)||p>+U(t,n).toFixed(2)||p<+X(i,s).toFixed(2)||p>+U(i,s).toFixed(2)||d<+X(e,r).toFixed(2)||d>+U(e,r).toFixed(2)||d<+X(o,a).toFixed(2)||d>+U(o,a).toFixed(2)))return{x:h,y:f}}}}function y(t,e,n){var r=h(t),i=h(e);if(!p(r,i))return n?0:[];for(var o=v.apply(0,t),s=v.apply(0,e),a=~~(o/8),u=~~(s/8),l=[],f=[],d={},m=n?0:[],y=0;y<a+1;y++){var x=c.apply(0,t.concat(y/a));l.push({x:x.x,y:x.y,t:y/a})}for(y=0;y<u+1;y++)x=c.apply(0,e.concat(y/u)),f.push({x:x.x,y:x.y,t:y/u});for(y=0;y<a;y++)for(var b=0;b<u;b++){var w=l[y],k=l[y+1],S=f[b],T=f[b+1],_=Y(k.x-w.x)<.001?"y":"x",C=Y(T.x-S.x)<.001?"y":"x",N=g(w.x,w.y,k.x,k.y,S.x,S.y,T.x,T.y);if(N){if(d[N.x.toFixed(4)]==N.y.toFixed(4))continue;d[N.x.toFixed(4)]=N.y.toFixed(4);var E=w.t+Y((N[_]-w[_])/(k[_]-w[_]))*(k.t-w.t),P=S.t+Y((N[C]-S[C])/(T[C]-S[C]))*(T.t-S.t);E>=0&&E<=1&&P>=0&&P<=1&&(n?m++:m.push({x:N.x,y:N.y,t1:E,t2:P}))}}return m}function x(t,e){return w(t,e)}function b(t,e){return w(t,e,1)}function w(t,e,n){t=O(t),e=O(e);for(var r,i,o,s,a,u,l,c,h,f,p=n?0:[],d=0,v=t.length;d<v;d++){var m=t[d];if("M"==m[0])r=a=m[1],i=u=m[2];else{"C"==m[0]?(h=[r,i].concat(m.slice(1)),r=h[6],i=h[7]):(h=[r,i,r,i,a,u,a,u],r=a,i=u);for(var g=0,x=e.length;g<x;g++){var b=e[g];if("M"==b[0])o=l=b[1],s=c=b[2];else{"C"==b[0]?(f=[o,s].concat(b.slice(1)),o=f[6],s=f[7]):(f=[o,s,o,s,l,c,l,c],o=l,s=c);var w=y(h,f,n);if(n)p+=w;else{for(var k=0,S=w.length;k<S;k++)w[k].segment1=d,w[k].segment2=g,w[k].bez1=h,w[k].bez2=f;p=p.concat(w)}}}}}return p}function k(t,e,n){var r=S(t);return f(r,e,n)&&w(t,[["M",e,n],["H",r.x2+10]],1)%2==1}function S(t){var e=i(t);if(e.bbox)return F(e.bbox);if(!t)return o();t=O(t);for(var n,r=0,s=0,a=[],u=[],l=0,c=t.length;l<c;l++)if(n=t[l],"M"==n[0])r=n[1],s=n[2],a.push(r),u.push(s);else{var h=A(r,s,n[1],n[2],n[3],n[4],n[5],n[6]);a=a.concat(h.min.x,h.max.x),u=u.concat(h.min.y,h.max.y),r=n[5],s=n[6]}var f=X.apply(0,a),p=X.apply(0,u),d=U.apply(0,a),v=U.apply(0,u),m=o(f,p,d-f,v-p);return e.bbox=F(m),m}function T(t,e,n,r,i){if(i)return[["M",+t+ +i,e],["l",n-2*i,0],["a",i,i,0,0,1,i,i],["l",0,r-2*i],["a",i,i,0,0,1,-i,i],["l",2*i-n,0],["a",i,i,0,0,1,-i,-i],["l",0,2*i-r],["a",i,i,0,0,1,i,-i],["z"]];var o=[["M",t,e],["l",n,0],["l",0,r],["l",-n,0],["z"]];return o.toString=s,o}function _(t,e,n,r,i){if(null==i&&null==r&&(r=n),t=+t,e=+e,n=+n,r=+r,null!=i)var o=Math.PI/180,a=t+n*Math.cos(-r*o),u=t+n*Math.cos(-i*o),l=e+n*Math.sin(-r*o),c=e+n*Math.sin(-i*o),h=[["M",a,l],["A",n,n,0,+(i-r>180),0,u,c]];else h=[["M",t,e],["m",0,-r],["a",n,r,0,1,1,0,2*r],["a",n,r,0,1,1,0,-2*r],["z"]];return h.toString=s,h}function C(e){var n=i(e),r=String.prototype.toLowerCase;if(n.rel)return a(n.rel);t.is(e,"array")&&t.is(e&&e[0],"array")||(e=t.parsePathString(e));var o=[],u=0,l=0,c=0,h=0,f=0;"M"==e[0][0]&&(u=e[0][1],l=e[0][2],c=u,h=l,f++,o.push(["M",u,l]));for(var p=f,d=e.length;p<d;p++){var v=o[p]=[],m=e[p];if(m[0]!=r.call(m[0]))switch(v[0]=r.call(m[0]),v[0]){case"a":v[1]=m[1],v[2]=m[2],v[3]=m[3],v[4]=m[4],v[5]=m[5],v[6]=+(m[6]-u).toFixed(3),v[7]=+(m[7]-l).toFixed(3);break;case"v":v[1]=+(m[1]-l).toFixed(3);break;case"m":c=m[1],h=m[2];default:for(var g=1,y=m.length;g<y;g++)v[g]=+(m[g]-(g%2?u:l)).toFixed(3)}else{v=o[p]=[],"m"==m[0]&&(c=m[1]+u,h=m[2]+l);for(var x=0,b=m.length;x<b;x++)o[p][x]=m[x]}var w=o[p].length;switch(o[p][0]){case"z":u=c,l=h;break;case"h":u+=+o[p][w-1];break;case"v":l+=+o[p][w-1];break;default:u+=+o[p][w-2],l+=+o[p][w-1]}}return o.toString=s,n.rel=a(o),o}function N(e){var n=i(e);if(n.abs)return a(n.abs);if(B(e,"array")&&B(e&&e[0],"array")||(e=t.parsePathString(e)),!e||!e.length)return[["M",0,0]];var r,o=[],u=0,l=0,c=0,h=0,f=0;"M"==e[0][0]&&(u=+e[0][1],l=+e[0][2],c=u,h=l,f++,o[0]=["M",u,l]);for(var p,d,v=3==e.length&&"M"==e[0][0]&&"R"==e[1][0].toUpperCase()&&"Z"==e[2][0].toUpperCase(),m=f,g=e.length;m<g;m++){if(o.push(p=[]),d=e[m],r=d[0],r!=r.toUpperCase())switch(p[0]=r.toUpperCase(),p[0]){case"A":p[1]=d[1],p[2]=d[2],p[3]=d[3],p[4]=d[4],p[5]=d[5],p[6]=+d[6]+u,p[7]=+d[7]+l;break;case"V":p[1]=+d[1]+l;break;case"H":p[1]=+d[1]+u;break;case"R":for(var y=[u,l].concat(d.slice(1)),x=2,b=y.length;x<b;x++)y[x]=+y[x]+u,y[++x]=+y[x]+l;o.pop(),o=o.concat(R(y,v));break;case"O":o.pop(),y=_(u,l,d[1],d[2]),y.push(y[0]),o=o.concat(y);break;case"U":o.pop(),o=o.concat(_(u,l,d[1],d[2],d[3])),p=["U"].concat(o[o.length-1].slice(-2));break;case"M":c=+d[1]+u,h=+d[2]+l;default:for(x=1,b=d.length;x<b;x++)p[x]=+d[x]+(x%2?u:l)}else if("R"==r)y=[u,l].concat(d.slice(1)),o.pop(),o=o.concat(R(y,v)),p=["R"].concat(d.slice(-2));else if("O"==r)o.pop(),y=_(u,l,d[1],d[2]),y.push(y[0]),o=o.concat(y);else if("U"==r)o.pop(),o=o.concat(_(u,l,d[1],d[2],d[3])),p=["U"].concat(o[o.length-1].slice(-2));else for(var w=0,k=d.length;w<k;w++)p[w]=d[w];if(r=r.toUpperCase(),"O"!=r)switch(p[0]){case"Z":u=+c,l=+h;break;case"H":u=p[1];break;case"V":l=p[1];break;case"M":c=p[p.length-2],h=p[p.length-1];default:u=p[p.length-2],l=p[p.length-1]}}return o.toString=s,n.abs=a(o),o}function E(t,e,n,r){return[t,e,n,r,n,r]}function P(t,e,n,r,i,o){var s=1/3,a=2/3;return[s*t+a*n,s*e+a*r,s*i+a*n,s*o+a*r,i,o]}function j(e,n,r,i,o,s,a,u,l,c){var h,f=120*z/180,p=z/180*(+o||0),d=[],v=t._.cacher(function(t,e,n){var r=t*I.cos(n)-e*I.sin(n),i=t*I.sin(n)+e*I.cos(n);return{x:r,y:i}});if(c)T=c[0],_=c[1],k=c[2],S=c[3];else{h=v(e,n,-p),e=h.x,n=h.y,h=v(u,l,-p),u=h.x,l=h.y;var m=(I.cos(z/180*o),I.sin(z/180*o),(e-u)/2),g=(n-l)/2,y=m*m/(r*r)+g*g/(i*i);y>1&&(y=I.sqrt(y),r*=y,i*=y);var x=r*r,b=i*i,w=(s==a?-1:1)*I.sqrt(Y((x*b-x*g*g-b*m*m)/(x*g*g+b*m*m))),k=w*r*g/i+(e+u)/2,S=w*-i*m/r+(n+l)/2,T=I.asin(((n-S)/i).toFixed(9)),_=I.asin(((l-S)/i).toFixed(9));T=e<k?z-T:T,_=u<k?z-_:_,T<0&&(T=2*z+T),_<0&&(_=2*z+_),a&&T>_&&(T-=2*z),!a&&_>T&&(_-=2*z)}var C=_-T;if(Y(C)>f){var N=_,E=u,P=l;_=T+f*(a&&_>T?1:-1),u=k+r*I.cos(_),l=S+i*I.sin(_),d=j(u,l,r,i,o,0,a,E,P,[_,N,k,S])}C=_-T;var A=I.cos(T),O=I.sin(T),M=I.cos(_),R=I.sin(_),L=I.tan(C/4),B=4/3*r*L,F=4/3*i*L,q=[e,n],D=[e+B*O,n-F*A],V=[u+B*R,l-F*M],X=[u,l];if(D[0]=2*q[0]-D[0],D[1]=2*q[1]-D[1],c)return[D,V,X].concat(d);d=[D,V,X].concat(d).join().split(",");for(var U=[],G=0,H=d.length;G<H;G++)U[G]=G%2?v(d[G-1],d[G],p).y:v(d[G],d[G+1],p).x;return U}function A(t,e,n,r,i,o,s,a){for(var u,l,c,h,f,p,d,v,m=[],g=[[],[]],y=0;y<2;++y)if(0==y?(l=6*t-12*n+6*i,u=-3*t+9*n-9*i+3*s,c=3*n-3*t):(l=6*e-12*r+6*o,u=-3*e+9*r-9*o+3*a,c=3*r-3*e),Y(u)<1e-12){if(Y(l)<1e-12)continue;h=-c/l,0<h&&h<1&&m.push(h)}else d=l*l-4*c*u,v=I.sqrt(d),d<0||(f=(-l+v)/(2*u),0<f&&f<1&&m.push(f),p=(-l-v)/(2*u),0<p&&p<1&&m.push(p));for(var x,b=m.length,w=b;b--;)h=m[b],x=1-h,g[0][b]=x*x*x*t+3*x*x*h*n+3*x*h*h*i+h*h*h*s,g[1][b]=x*x*x*e+3*x*x*h*r+3*x*h*h*o+h*h*h*a;return g[0][w]=t,g[1][w]=e,g[0][w+1]=s,g[1][w+1]=a,g[0].length=g[1].length=w+2,{min:{x:X.apply(0,g[0]),y:X.apply(0,g[1])},max:{x:U.apply(0,g[0]),y:U.apply(0,g[1])}}}function O(t,e){var n=!e&&i(t);if(!e&&n.curve)return a(n.curve);for(var r=N(t),o=e&&N(e),s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},u={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},l=(function(t,e,n){var r,i;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in{T:1,Q:1})&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"].concat(j.apply(0,[e.x,e.y].concat(t.slice(1))));break;case"S":"C"==n||"S"==n?(r=2*e.x-e.bx,i=2*e.y-e.by):(r=e.x,i=e.y),t=["C",r,i].concat(t.slice(1));break;case"T":"Q"==n||"T"==n?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),t=["C"].concat(P(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"].concat(P(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"].concat(E(e.x,e.y,t[1],t[2]));break;case"H":t=["C"].concat(E(e.x,e.y,t[1],e.y));break;case"V":t=["C"].concat(E(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"].concat(E(e.x,e.y,e.X,e.Y))}return t}),c=function(t,e){if(t[e].length>7){t[e].shift();for(var n=t[e];n.length;)f[e]="A",o&&(p[e]="A"),t.splice(e++,0,["C"].concat(n.splice(0,6)));t.splice(e,1),g=U(r.length,o&&o.length||0)}},h=function(t,e,n,i,s){t&&e&&"M"==t[s][0]&&"M"!=e[s][0]&&(e.splice(s,0,["M",i.x,i.y]),n.bx=0,n.by=0,n.x=t[s][1],n.y=t[s][2],g=U(r.length,o&&o.length||0))},f=[],p=[],d="",v="",m=0,g=U(r.length,o&&o.length||0);m<g;m++){r[m]&&(d=r[m][0]),"C"!=d&&(f[m]=d,m&&(v=f[m-1])),r[m]=l(r[m],s,v),"A"!=f[m]&&"C"==d&&(f[m]="C"),c(r,m),o&&(o[m]&&(d=o[m][0]),"C"!=d&&(p[m]=d,m&&(v=p[m-1])),o[m]=l(o[m],u,v),"A"!=p[m]&&"C"==d&&(p[m]="C"),c(o,m)),h(r,o,s,u,m),h(o,r,u,s,m);var y=r[m],x=o&&o[m],b=y.length,w=o&&x.length;s.x=y[b-2],s.y=y[b-1],s.bx=V(y[b-4])||s.x,s.by=V(y[b-3])||s.y,u.bx=o&&(V(x[w-4])||u.x),u.by=o&&(V(x[w-3])||u.y),u.x=o&&x[w-2],u.y=o&&x[w-1]}return o||(n.curve=a(r)),o?[r,o]:r}function M(t,e){if(!e)return t;var n,r,i,o,s,a,u;for(t=O(t),i=0,s=t.length;i<s;i++)for(u=t[i],o=1,a=u.length;o<a;o+=2)n=e.x(u[o],u[o+1]),r=e.y(u[o],u[o+1]),u[o]=n,u[o+1]=r;return t}function R(t,e){for(var n=[],r=0,i=t.length;i-2*!e>r;r+=2){var o=[{x:+t[r-2],y:+t[r-1]},{x:+t[r],y:+t[r+1]},{x:+t[r+2],y:+t[r+3]},{x:+t[r+4],y:+t[r+5]}];e?r?i-4==r?o[3]={
x:+t[0],y:+t[1]}:i-2==r&&(o[2]={x:+t[0],y:+t[1]},o[3]={x:+t[2],y:+t[3]}):o[0]={x:+t[i-2],y:+t[i-1]}:i-4==r?o[3]=o[2]:r||(o[0]={x:+t[r],y:+t[r+1]}),n.push(["C",(-o[0].x+6*o[1].x+o[2].x)/6,(-o[0].y+6*o[1].y+o[2].y)/6,(o[1].x+6*o[2].x-o[3].x)/6,(o[1].y+6*o[2].y-o[3].y)/6,o[2].x,o[2].y])}return n}var L=e.prototype,B=t.is,F=t._.clone,q="hasOwnProperty",D=/,?([a-z]),?/gi,V=parseFloat,I=Math,z=I.PI,X=I.min,U=I.max,G=I.pow,Y=I.abs,H=l(1),W=l(),$=l(0,1),Q=t._unit2px,Z={path:function(t){return t.attr("path")},circle:function(t){var e=Q(t);return _(e.cx,e.cy,e.r)},ellipse:function(t){var e=Q(t);return _(e.cx||0,e.cy||0,e.rx,e.ry)},rect:function(t){var e=Q(t);return T(e.x||0,e.y||0,e.width,e.height,e.rx,e.ry)},image:function(t){var e=Q(t);return T(e.x||0,e.y||0,e.width,e.height)},line:function(t){return"M"+[t.attr("x1")||0,t.attr("y1")||0,t.attr("x2"),t.attr("y2")]},polyline:function(t){return"M"+t.attr("points")},polygon:function(t){return"M"+t.attr("points")+"z"},deflt:function(t){var e=t.node.getBBox();return T(e.x,e.y,e.width,e.height)}};t.path=i,t.path.getTotalLength=H,t.path.getPointAtLength=W,t.path.getSubpath=function(t,e,n){if(this.getTotalLength(t)-n<1e-6)return $(t,e).end;var r=$(t,n,1);return e?$(r,e).end:r},L.getTotalLength=function(){if(this.node.getTotalLength)return this.node.getTotalLength()},L.getPointAtLength=function(t){return W(this.attr("d"),t)},L.getSubpath=function(e,n){return t.path.getSubpath(this.attr("d"),e,n)},t._.box=o,t.path.findDotsAtSegment=c,t.path.bezierBBox=h,t.path.isPointInsideBBox=f,t.closest=function(e,n,r,i){for(var s=100,a=o(e-s/2,n-s/2,s,s),u=[],l=r[0].hasOwnProperty("x")?function(t){return{x:r[t].x,y:r[t].y}}:function(t){return{x:r[t],y:i[t]}},c=0;s<=1e6&&!c;){for(var h=0,p=r.length;h<p;h++){var d=l(h);if(f(a,d.x,d.y)){c++,u.push(d);break}}c||(s*=2,a=o(e-s/2,n-s/2,s,s))}if(1e6!=s){var v,m=1/0;for(h=0,p=u.length;h<p;h++){var g=t.len(e,n,u[h].x,u[h].y);m>g&&(m=g,u[h].len=g,v=u[h])}return v}},t.path.isBBoxIntersect=p,t.path.intersection=x,t.path.intersectionNumber=b,t.path.isPointInside=k,t.path.getBBox=S,t.path.get=Z,t.path.toRelative=C,t.path.toAbsolute=N,t.path.toCubic=O,t.path.map=M,t.path.toString=s,t.path.clone=a}),r.plugin(function(t,r,i,o){var s=Math.max,a=Math.min,u=function(t){if(this.items=[],this.bindings={},this.length=0,this.type="set",t)for(var e=0,n=t.length;e<n;e++)t[e]&&(this[this.items.length]=this.items[this.items.length]=t[e],this.length++)},l=u.prototype;l.push=function(){for(var t,e,n=0,r=arguments.length;n<r;n++)t=arguments[n],t&&(e=this.items.length,this[e]=this.items[e]=t,this.length++);return this},l.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},l.forEach=function(t,e){for(var n=0,r=this.items.length;n<r;n++)if(t.call(e,this.items[n],n)===!1)return this;return this},l.animate=function(r,i,o,s){"function"!=typeof o||o.length||(s=o,o=n.linear),r instanceof t._.Animation&&(s=r.callback,o=r.easing,i=o.dur,r=r.attr);var a=arguments;if(t.is(r,"array")&&t.is(a[a.length-1],"array"))var u=!0;var l,c=function(){l?this.b=l:l=this.b},h=0,f=this,p=s&&function(){++h==f.length&&s.call(this)};return this.forEach(function(t,n){e.once("snap.animcreated."+t.id,c),u?a[n]&&t.animate.apply(t,a[n]):t.animate(r,i,o,p)})},l.remove=function(){for(;this.length;)this.pop().remove();return this},l.bind=function(t,e,n){var r={};if("function"==typeof e)this.bindings[t]=e;else{var i=n||t;this.bindings[t]=function(t){r[i]=t,e.attr(r)}}return this},l.attr=function(t){var e={};for(var n in t)this.bindings[n]?this.bindings[n](t[n]):e[n]=t[n];for(var r=0,i=this.items.length;r<i;r++)this.items[r].attr(e);return this},l.clear=function(){for(;this.length;)this.pop()},l.splice=function(t,e,n){t=t<0?s(this.length+t,0):t,e=s(0,a(this.length-t,e));var r,i=[],o=[],l=[];for(r=2;r<arguments.length;r++)l.push(arguments[r]);for(r=0;r<e;r++)o.push(this[t+r]);for(;r<this.length-t;r++)i.push(this[t+r]);var c=l.length;for(r=0;r<c+i.length;r++)this.items[t+r]=this[t+r]=r<c?l[r]:i[r-c];for(r=this.items.length=this.length-=e-c;this[r];)delete this[r++];return new u(o)},l.exclude=function(t){for(var e=0,n=this.length;e<n;e++)if(this[e]==t)return this.splice(e,1),!0;return!1},l.insertAfter=function(t){for(var e=this.items.length;e--;)this.items[e].insertAfter(t);return this},l.getBBox=function(){for(var t=[],e=[],n=[],r=[],i=this.items.length;i--;)if(!this.items[i].removed){var o=this.items[i].getBBox();t.push(o.x),e.push(o.y),n.push(o.x+o.width),r.push(o.y+o.height)}return t=a.apply(0,t),e=a.apply(0,e),n=s.apply(0,n),r=s.apply(0,r),{x:t,y:e,x2:n,y2:r,width:n-t,height:r-e,cx:t+(n-t)/2,cy:e+(r-e)/2}},l.clone=function(t){t=new u;for(var e=0,n=this.items.length;e<n;e++)t.push(this.items[e].clone());return t},l.toString=function(){return"Snap‘s set"},l.type="set",t.Set=u,t.set=function(){var t=new u;return arguments.length&&t.push.apply(t,Array.prototype.slice.call(arguments,0)),t}}),r.plugin(function(t,n,r,i){function o(t){var e=t[0];switch(e.toLowerCase()){case"t":return[e,0,0];case"m":return[e,1,0,0,1,0,0];case"r":return 4==t.length?[e,0,t[2],t[3]]:[e,0];case"s":return 5==t.length?[e,1,1,t[3],t[4]]:3==t.length?[e,1,1]:[e,1]}}function s(e,n,r){n=g(n).replace(/\.{3}|\u2026/g,e),e=t.parseTransformString(e)||[],n=t.parseTransformString(n)||[];for(var i,s,a,u,l=Math.max(e.length,n.length),c=[],p=[],d=0;d<l;d++){if(a=e[d]||o(n[d]),u=n[d]||o(a),a[0]!=u[0]||"r"==a[0].toLowerCase()&&(a[2]!=u[2]||a[3]!=u[3])||"s"==a[0].toLowerCase()&&(a[3]!=u[3]||a[4]!=u[4])){e=t._.transform2matrix(e,r()),n=t._.transform2matrix(n,r()),c=[["m",e.a,e.b,e.c,e.d,e.e,e.f]],p=[["m",n.a,n.b,n.c,n.d,n.e,n.f]];break}for(c[d]=[],p[d]=[],i=0,s=Math.max(a.length,u.length);i<s;i++)i in a&&(c[d][i]=a[i]),i in u&&(p[d][i]=u[i])}return{from:f(c),to:f(p),f:h(c)}}function a(t){return t}function u(t){return function(e){return+e.toFixed(3)+t}}function l(t){return t.join(" ")}function c(e){return t.rgb(e[0],e[1],e[2])}function h(t){var e,n,r,i,o,s,a=0,u=[];for(e=0,n=t.length;e<n;e++){for(o="[",s=['"'+t[e][0]+'"'],r=1,i=t[e].length;r<i;r++)s[r]="val["+a++ +"]";o+=s+"]",u[e]=o}return Function("val","return Snap.path.toString.call(["+u+"])")}function f(t){for(var e=[],n=0,r=t.length;n<r;n++)for(var i=1,o=t[n].length;i<o;i++)e.push(t[n][i]);return e}function p(t){return isFinite(parseFloat(t))}function d(e,n){return!(!t.is(e,"array")||!t.is(n,"array"))&&e.toString()==n.toString()}var v={},m=/[a-z]+$/i,g=String;v.stroke=v.fill="colour",n.prototype.equal=function(t,n){return e("snap.util.equal",this,t,n).firstDefined()},e.on("snap.util.equal",function(e,n){var r,i,o=g(this.attr(e)||""),y=this;if(p(o)&&p(n))return{from:parseFloat(o),to:parseFloat(n),f:a};if("colour"==v[e])return r=t.color(o),i=t.color(n),{from:[r.r,r.g,r.b,r.opacity],to:[i.r,i.g,i.b,i.opacity],f:c};if("viewBox"==e)return r=this.attr(e).vb.split(" ").map(Number),i=n.split(" ").map(Number),{from:r,to:i,f:l};if("transform"==e||"gradientTransform"==e||"patternTransform"==e)return n instanceof t.Matrix&&(n=n.toTransformString()),t._.rgTransform.test(n)||(n=t._.svgTransform2string(n)),s(o,n,function(){return y.getBBox(1)});if("d"==e||"path"==e)return r=t.path.toCubic(o,n),{from:f(r[0]),to:f(r[1]),f:h(r[0])};if("points"==e)return r=g(o).split(t._.separator),i=g(n).split(t._.separator),{from:r,to:i,f:function(t){return t}};var x=o.match(m),b=g(n).match(m);return x&&d(x,b)?{from:parseFloat(o),to:parseFloat(n),f:u(x)}:{from:this.asPX(e),to:this.asPX(e,n),f:a}})}),r.plugin(function(t,n,r,i){for(var o=n.prototype,s="hasOwnProperty",a=("createTouch"in i.doc),u=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","touchstart","touchmove","touchend","touchcancel"],l={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},c=(function(t,e){var n="y"==t?"scrollTop":"scrollLeft",r=e&&e.node?e.node.ownerDocument:i.doc;return r[n in r.documentElement?"documentElement":"body"][n]}),h=function(){return this.originalEvent.preventDefault()},f=function(){return this.originalEvent.stopPropagation()},p=function(t,e,n,r){var i=a&&l[e]?l[e]:e,o=function(i){var o=c("y",r),u=c("x",r);if(a&&l[s](e))for(var p=0,d=i.targetTouches&&i.targetTouches.length;p<d;p++)if(i.targetTouches[p].target==t||t.contains(i.targetTouches[p].target)){var v=i;i=i.targetTouches[p],i.originalEvent=v,i.preventDefault=h,i.stopPropagation=f;break}var m=i.clientX+u,g=i.clientY+o;return n.call(r,i,m,g)};return e!==i&&t.addEventListener(e,o,!1),t.addEventListener(i,o,!1),function(){return e!==i&&t.removeEventListener(e,o,!1),t.removeEventListener(i,o,!1),!0}},d=[],v=function(t){for(var n,r=t.clientX,i=t.clientY,o=c("y"),s=c("x"),u=d.length;u--;){if(n=d[u],a){for(var l,h=t.touches&&t.touches.length;h--;)if(l=t.touches[h],l.identifier==n.el._drag.id||n.el.node.contains(l.target)){r=l.clientX,i=l.clientY,(t.originalEvent?t.originalEvent:t).preventDefault();break}}else t.preventDefault();var f=n.el.node;f.nextSibling,f.parentNode,f.style.display;r+=s,i+=o,e("snap.drag.move."+n.el.id,n.move_scope||n.el,r-n.el._drag.x,i-n.el._drag.y,r,i,t)}},m=function(n){t.unmousemove(v).unmouseup(m);for(var r,i=d.length;i--;)r=d[i],r.el._drag={},e("snap.drag.end."+r.el.id,r.end_scope||r.start_scope||r.move_scope||r.el,n),e.off("snap.drag.*."+r.el.id);d=[]},g=u.length;g--;)!function(e){t[e]=o[e]=function(n,r){if(t.is(n,"function"))this.events=this.events||[],this.events.push({name:e,f:n,unbind:p(this.node||document,e,n,r||this)});else for(var i=0,o=this.events.length;i<o;i++)if(this.events[i].name==e)try{this.events[i].f.call(this)}catch(t){}return this},t["un"+e]=o["un"+e]=function(t){for(var n=this.events||[],r=n.length;r--;)if(n[r].name==e&&(n[r].f==t||!t))return n[r].unbind(),n.splice(r,1),!n.length&&delete this.events,this;return this}}(u[g]);o.hover=function(t,e,n,r){return this.mouseover(t,n).mouseout(e,r||n)},o.unhover=function(t,e){return this.unmouseover(t).unmouseout(e)};var y=[];o.drag=function(n,r,i,o,s,a){function u(u,l,h){(u.originalEvent||u).preventDefault(),c._drag.x=l,c._drag.y=h,c._drag.id=u.identifier,!d.length&&t.mousemove(v).mouseup(m),d.push({el:c,move_scope:o,start_scope:s,end_scope:a}),r&&e.on("snap.drag.start."+c.id,r),n&&e.on("snap.drag.move."+c.id,n),i&&e.on("snap.drag.end."+c.id,i),e("snap.drag.start."+c.id,s||o||c,l,h,u)}function l(t,n,r){e("snap.draginit."+c.id,c,t,n,r)}var c=this;if(!arguments.length){var h;return c.drag(function(t,e){this.attr({transform:h+(h?"T":"t")+[t,e]})},function(){h=this.transform().local})}return e.on("snap.draginit."+c.id,u),c._drag={},y.push({el:c,start:u,init:l}),c.mousedown(l),c},o.undrag=function(){for(var n=y.length;n--;)y[n].el==this&&(this.unmousedown(y[n].init),y.splice(n,1),e.unbind("snap.drag.*."+this.id),e.unbind("snap.draginit."+this.id));return!y.length&&t.unmousemove(v).unmouseup(m),this}}),r.plugin(function(t,n,r,i){var o=(n.prototype,r.prototype),s=/^\s*url\((.+)\)/,a=String,u=t._.$;t.filter={},o.filter=function(e){var r=this;"svg"!=r.type&&(r=r.paper);var i=t.parse(a(e)),o=t._.id(),s=(r.node.offsetWidth,r.node.offsetHeight,u("filter"));return u(s,{id:o,filterUnits:"userSpaceOnUse"}),s.appendChild(i.node),r.defs.appendChild(s),new n(s)},e.on("snap.util.getattr.filter",function(){e.stop();var n=u(this.node,"filter");if(n){var r=a(n).match(s);return r&&t.select(r[1])}}),e.on("snap.util.attr.filter",function(r){if(r instanceof n&&"filter"==r.type){e.stop();var i=r.node.id;i||(u(r.node,{id:r.id}),i=r.id),u(this.node,{filter:t.url(i)})}r&&"none"!=r||(e.stop(),this.node.removeAttribute("filter"))}),t.filter.blur=function(e,n){null==e&&(e=2);var r=null==n?e:[e,n];return t.format('<feGaussianBlur stdDeviation="{def}"/>',{def:r})},t.filter.blur.toString=function(){return this()},t.filter.shadow=function(e,n,r,i,o){return"string"==typeof r&&(i=r,o=i,r=4),"string"!=typeof i&&(o=i,i="#000"),i=i||"#000",null==r&&(r=4),null==o&&(o=1),null==e&&(e=0,n=2),null==n&&(n=e),i=t.color(i),t.format('<feGaussianBlur in="SourceAlpha" stdDeviation="{blur}"/><feOffset dx="{dx}" dy="{dy}" result="offsetblur"/><feFlood flood-color="{color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="{opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>',{color:i,dx:e,dy:n,blur:r,opacity:o})},t.filter.shadow.toString=function(){return this()},t.filter.grayscale=function(e){return null==e&&(e=1),t.format('<feColorMatrix type="matrix" values="{a} {b} {c} 0 0 {d} {e} {f} 0 0 {g} {b} {h} 0 0 0 0 0 1 0"/>',{a:.2126+.7874*(1-e),b:.7152-.7152*(1-e),c:.0722-.0722*(1-e),d:.2126-.2126*(1-e),e:.7152+.2848*(1-e),f:.0722-.0722*(1-e),g:.2126-.2126*(1-e),h:.0722+.9278*(1-e)})},t.filter.grayscale.toString=function(){return this()},t.filter.sepia=function(e){return null==e&&(e=1),t.format('<feColorMatrix type="matrix" values="{a} {b} {c} 0 0 {d} {e} {f} 0 0 {g} {h} {i} 0 0 0 0 0 1 0"/>',{a:.393+.607*(1-e),b:.769-.769*(1-e),c:.189-.189*(1-e),d:.349-.349*(1-e),e:.686+.314*(1-e),f:.168-.168*(1-e),g:.272-.272*(1-e),h:.534-.534*(1-e),i:.131+.869*(1-e)})},t.filter.sepia.toString=function(){return this()},t.filter.saturate=function(e){return null==e&&(e=1),t.format('<feColorMatrix type="saturate" values="{amount}"/>',{amount:1-e})},t.filter.saturate.toString=function(){return this()},t.filter.hueRotate=function(e){return e=e||0,t.format('<feColorMatrix type="hueRotate" values="{angle}"/>',{angle:e})},t.filter.hueRotate.toString=function(){return this()},t.filter.invert=function(e){return null==e&&(e=1),t.format('<feComponentTransfer><feFuncR type="table" tableValues="{amount} {amount2}"/><feFuncG type="table" tableValues="{amount} {amount2}"/><feFuncB type="table" tableValues="{amount} {amount2}"/></feComponentTransfer>',{amount:e,amount2:1-e})},t.filter.invert.toString=function(){return this()},t.filter.brightness=function(e){return null==e&&(e=1),t.format('<feComponentTransfer><feFuncR type="linear" slope="{amount}"/><feFuncG type="linear" slope="{amount}"/><feFuncB type="linear" slope="{amount}"/></feComponentTransfer>',{amount:e})},t.filter.brightness.toString=function(){return this()},t.filter.contrast=function(e){return null==e&&(e=1),t.format('<feComponentTransfer><feFuncR type="linear" slope="{amount}" intercept="{amount2}"/><feFuncG type="linear" slope="{amount}" intercept="{amount2}"/><feFuncB type="linear" slope="{amount}" intercept="{amount2}"/></feComponentTransfer>',{amount:e,amount2:.5-e/2})},t.filter.contrast.toString=function(){return this()}}),r.plugin(function(t,e,n,r,i){var o=t._.box,s=t.is,a=/^[^a-z]*([tbmlrc])/i,u=function(){return"T"+this.dx+","+this.dy};e.prototype.getAlign=function(t,e){null==e&&s(t,"string")&&(e=t,t=null),t=t||this.paper;var n=t.getBBox?t.getBBox():o(t),r=this.getBBox(),i={};switch(e=e&&e.match(a),e=e?e[1].toLowerCase():"c"){case"t":i.dx=0,i.dy=n.y-r.y;break;case"b":i.dx=0,i.dy=n.y2-r.y2;break;case"m":i.dx=0,i.dy=n.cy-r.cy;break;case"l":i.dx=n.x-r.x,i.dy=0;break;case"r":i.dx=n.x2-r.x2,i.dy=0;break;default:i.dx=n.cx-r.cx,i.dy=0}return i.toString=u,i},e.prototype.align=function(t,e){return this.transform("..."+this.getAlign(t,e))}}),r}),n("draw",["require","exports","./runtime","./util","../bower_components/hammerjs/hammer","../bower_components/Snap.svg/dist/snap.svg"],function(t,e,n,r){"use strict";function i(t,e){var n=t.getAttribute("class");n?t.setAttribute("class",n+" "+e):t.setAttribute("class",e)}function o(t,e){return void 0===e&&(e=1e-7),Math.abs(t)<e}function s(t,e,n){return void 0===n&&(n=1e-7),o(t-e,n)}function a(t){return!isFinite(t)||t>2e14}function u(t){return Math.pow(t,2)}function l(t,e){if(void 0===e&&(e="bottom"),t.labelSide){var n=t.labelSide;return"center"===n?e:n}if(t.hasOwnProperty("labelAngle")){var r=(t.labelAngle+45)%360,i=r/90|0;return z[i]}return e}function c(t,e,n){var r=2*C/j,i="matrix("+r+", 0, 0, "+r+", "+(e-C)+", "+(n-C)+")";return t.path(P).attr({fill:"#ffffff",stroke:"#6388dc","stroke-width":2,"stroke-linejoin":"round","stroke-miterlimit":4}).transform(i)}function h(t,e,n){var r=u(e.x)+u(e.y),i=(u(t.x)+u(t.y)-r)/2,s=(r-u(n.x)-u(n.y))/2,a=(t.x-e.x)*(e.y-n.y)-(e.x-n.x)*(t.y-e.y);if(o(a))return void console.log("blerg");var l=1/a,c=(i*(e.y-n.y)-s*(t.y-e.y))*l,h=(s*(t.x-e.x)-i*(e.x-n.x))*l;return{x:c,y:h,r:_(u(e.x-c)+u(e.y-h))}}function f(t,e,n,r,o,s,a){void 0===s&&(s=C),void 0===a&&(a=C);var u,l;switch(r){case"top":u=e,l=n-a-N;break;case"bottom":u=e,l=n+a+N;break;case"left":u=e-s-N,l=n;break;case"right":u=e+s+N,l=n;break;default:console.log("unknown case "+r)}var c,h=t.text(u,l,o.split("\n")).attr(R),f=h.attr("text");c="string"==typeof f?[f]:f;var p=h.node.getElementsByTagName("tspan"),d=Number.MIN_VALUE,v=Number.MIN_VALUE;if(I)for(var m=0;m<p.length;m++){var g=p[m],y=g.getBBox();y.height>d&&(d=y.height),y.width>v&&(v=y.width)}else for(var m=0;m<c.length;m++){var x=t.text(0,0,c[m]).attr(R),y=x.getBBox();y.height>d&&(d=y.height),y.width>v&&(v=y.width),x.remove()}for(var m=0;m<p.length;m++)m>0&&(p[m].setAttribute("x",String(u)),p[m].setAttribute("dy",String(.9*d)));var b;switch(r){case"bottom":h.attr({y:l+N});break;case"top":h.attr({y:l-(p.length-1)*(d/2)-N*+(p.length>1)});break;case"left":b=p.length>1?(p.length-2)*(d/2):-d/4,i(h.node,"right-aligned"),h.node.setAttribute("style",h.node.getAttribute("style").replace("middle","right")),h.attr({y:l-b,x:u});break;case"right":i(h.node,"left-aligned"),h.node.setAttribute("style",h.node.getAttribute("style").replace("middle","left")),h.attr({y:l-(p.length-2)*(d/2)});break;default:console.log("unknown case "+r)}return h}function p(t){var e=(360-t)%360;return e>180&&(e-=360),e}function d(t){return t/180*b}function v(t){return 180*t/b}function m(t){return t+=b,t>b&&(t-=2*b),t}function g(t){return t[t.length-1]}function y(t,e,n,r){var i="M"+e+","+n+"L"+(e-r)+","+(n+r/2)+"A"+3*r+","+3*r+" 0 0,1 "+(e-r)+","+(n-r/2)+"z";return t.path(i)}function x(t,e,n,i,o,s,a,u){for(var l=e-i/2,c=n-o/2,h=s[0],f=g(s),p=f-h,d=Math.min(0,Math.min.apply(null,a)),v=Math.max.apply(null,a),m=v-d||1,y="",x=0;x<a.length;x++)r.isNaN(a[x])&&console.log("NaN at "+s[x]),y+=(0===x?"M":"L")+(l+i*(s[x]-h)/p)+","+(c+o-o*(a[x]-d)/m);var b="M"+l+","+(c+o-o*(0-d)/m)+"L"+(l+i)+","+(c+o-o*(0-d)/m);if(u){var w=u.node.querySelector(".spark-line");return w.setAttribute("d",y),u}return t.group(t.path(b).attr({class:"spark-axis","stroke-width":.125,"stroke-linecap":"round",stroke:"#999",fill:"none"}),t.path(y).attr({class:"spark-line","stroke-width":.5,"stroke-linecap":"round",stroke:"#2299dd",fill:"none"}))}var b=Math.PI,w=Math.sin,k=Math.cos,S=Math.tan,T=Math.atan2,_=Math.sqrt,C=(Math.abs,9),N=6,E=1,P="M 25.731189,3.8741489 C 21.525742,3.8741489 18.07553,7.4486396 17.497605,12.06118 C 16.385384,10.910965 14.996889,10.217536 13.45908,10.217535 C 9.8781481,10.217535 6.9473481,13.959873 6.9473482,18.560807 C 6.9473482,19.228828 7.0507906,19.875499 7.166493,20.498196 C 3.850265,21.890233 1.5000346,25.3185 1.5000346,29.310191 C 1.5000346,34.243794 5.1009986,38.27659 9.6710049,38.715902 C 9.6186538,39.029349 9.6083922,39.33212 9.6083922,39.653348 C 9.6083922,45.134228 17.378069,49.59028 26.983444,49.590279 C 36.58882,49.590279 44.389805,45.134229 44.389803,39.653348 C 44.389803,39.35324 44.341646,39.071755 44.295883,38.778399 C 44.369863,38.780301 44.440617,38.778399 44.515029,38.778399 C 49.470875,38.778399 53.499966,34.536825 53.499965,29.310191 C 53.499965,24.377592 49.928977,20.313927 45.360301,19.873232 C 45.432415,19.39158 45.485527,18.91118 45.485527,18.404567 C 45.485527,13.821862 42.394553,10.092543 38.598118,10.092543 C 36.825927,10.092543 35.215888,10.918252 33.996078,12.248669 C 33.491655,7.5434856 29.994502,3.8741489 25.731189,3.8741489 z",j=55,A=4,O=8,M=5,R={"font-size":"10px","font-family":'Roboto, "Open Sans", sans-serif',"font-weight":"300","text-anchor":"middle","white-space":"nowrap","vertical-align":"middle"},L="gray",B="black",F={flow:1,module:2,stock:3,aux:4,connector:5},q=.2,D=6,V=12,I="undefined"!=typeof navigator&&navigator.userAgent.match(/Chrome/)&&!navigator.userAgent.match(/Edge/),z={0:"right",1:"bottom",2:"left",3:"top"};e.xmileToCanvasAngle=p;var X=function(){function t(t,e){this.drawing=t,this.e=e,this.ident=e.ident,this.dName=r.dName(e.name),this.cx=e.x,this.cy=e.y,e.width?(t.stocksXYCenter||(this.cx+=.5*e.width),this.w=e.width):this.w=45,e.height?(t.stocksXYCenter||(this.cy+=.5*e.height),this.h=e.height):this.h=35,this.color=this.drawing.colorOverride?B:e.color||B,this.labelSide=l(e,"top")}return t.prototype.init=function(){for(var t=this.drawing.model.vars[this.ident],e=0;e<t.inflows.length;e++){var n=t.inflows[e],r=this.drawing.namedEnts[n];r?r.to=this.ident:console.log("failed connecting "+this.ident+" .to "+n)}for(var e=0;e<t.outflows.length;e++){var n=t.outflows[e],r=this.drawing.namedEnts[n];r?this.drawing.namedEnts[n].from=this.ident:console.log("failed connecting "+this.ident+" .from "+n)}},t.prototype.draw=function(){var t=this.drawing.paper,e=this.w,n=this.h;this.set=this.drawing.group(t.rect(Math.ceil(this.cx-e/2),Math.ceil(this.cy-n/2),e,n).attr({fill:"white","stroke-width":E,stroke:this.color}))},t.prototype.drawLabel=function(){var t=this.drawing.paper,e=this.w,n=this.h;this.set.add(f(t,this.cx,this.cy,this.labelSide,this.dName,e/2,n/2))},t.prototype.visualize=function(t,e){var n=!!this.graph;this.graph=x(this.drawing.paper,this.cx,this.cy,this.w-4,this.h-4,t,e,this.graph),n||this.set.add(this.graph)},t}(),U=function(){function t(t,e){this.drawing=t,this.e=e,this.ident=e.ident,this.dName=r.dName(e.name),this.cx=e.x,this.cy=e.y,this.w=55,this.h=45,this.color=this.drawing.colorOverride?B:e.color||B,this.labelSide=l(e)}return t.prototype.init=function(){},t.prototype.draw=function(){var t=this.drawing.paper,e=this.w,n=this.h;this.set=this.drawing.group(t.rect(Math.ceil(this.cx-e/2),Math.ceil(this.cy-n/2),e,n,M,M).attr({fill:"white","stroke-width":E,stroke:this.color}))},t.prototype.drawLabel=function(){var t=this.drawing.paper,e=this.w,n=this.h;this.set.add(f(t,this.cx,this.cy,this.labelSide,this.dName,e/2,n/2))},t.prototype.visualize=function(t,e){var n=!!this.graph;this.graph=x(this.drawing.paper,this.cx,this.cy,this.w-6,this.h-6,t,e,this.graph),n||this.set.add(this.graph)},t}(),G=function(){function t(t,e){this.drawing=t,this.e=e,this.ident=e.ident,this.dName=r.dName(e.name),this.cx=e.x,this.cy=e.y,e.width?this.r=e.width/2:this.r=C,e.height?this.r=e.height/2:this.r=C,this.color=this.drawing.colorOverride?B:e.color||B,this.labelSide=l(e)}return t.prototype.init=function(){},t.prototype.draw=function(){var t=this.drawing.paper;this.set=this.drawing.group(t.circle(this.cx,this.cy,this.r).attr({fill:"white","stroke-width":E,stroke:this.color}))},t.prototype.drawLabel=function(){var t=this.drawing.paper;this.set.add(f(t,this.cx,this.cy,this.labelSide,this.dName))},t.prototype.visualize=function(t,e){var n=!!this.graph;this.graph=x(this.drawing.paper,this.cx,this.cy,C,C,t,e,this.graph),n||this.set.add(this.graph)},t}(),Y=function(){function t(t,e){this.drawing=t,this.e=e,this.ident=e.ident,this.dName=r.dName(e.name),this.cx=e.x,this.cy=e.y,this.to=null,this.from=null,this.color=this.drawing.colorOverride?B:e.color||B,this.labelSide=l(e)}return t.prototype.init=function(){},t.prototype.draw=function(){var t=this.drawing.paper,e=this.cx,n=this.cy,r=this.e.pts;if(r.length<2)return void console.log("ERROR: too few points for flow: "+JSON.stringify(this));for(var i="",o=0;o<r.length;o++){var s=r[o];i+=(0===o?"M":"L")+s.x+","+s.y}var a,u;if(this.set=this.drawing.group(),this.from||(u=c(t,r[0].x,r[0].y),a=u),!this.to){var l=void 0,h=void 0,f=void 0,p=void 0;l=r[r.length-1].x,h=r[r.length-1].y,f=r[r.length-2].x,p=r[r.length-2].y,u=c(t,l,h),this.set.add(u),f<l&&(r[r.length-1].x=l-O),f>l&&(r[r.length-1].x=l+O),p<h&&(r[r.length-1].y=h-O),p>h&&(r[r.length-1].y=h+O)}i="";for(var d,o=0;o<r.length;o++){var l=r[o].x,h=r[o].y;if(o===r.length-1){var v=l-r[o-1].x,m=h-r[o-1].y,x=180*T(m,v)/b;x<0&&(x+=360),x>=315||x<45?(l-=4,d=0):x>=45&&x<135?(h-=4,d=90):x>=135&&x<225?(l+=4,d=180):(h+=4,d=270)}i+=(0===o?"M":"L")+l+","+h}this.set.add(t.path(i).attr({"stroke-width":4*E,stroke:this.color,fill:"none"}));var w=g(r);this.set.add(y(t,w.x,w.y,2*A).attr({transform:"rotate("+d+","+w.x+","+w.y+")",stroke:this.color,"stroke-width":1,fill:"white","stroke-linejoin":"round"})),this.set.add(t.path(i).attr({stroke:"white","stroke-width":2*E,fill:"none"})),this.set.add(t.circle(e,n,C).attr({fill:"white","stroke-width":E,stroke:this.color})),a&&this.set.append(a)},t.prototype.drawLabel=function(){var t=this.drawing.paper;this.set.add(f(t,this.cx,this.cy,this.labelSide,this.dName))},t.prototype.visualize=function(t,e){var n=!!this.graph;this.graph=x(this.drawing.paper,this.cx,this.cy,C,C,t,e,this.graph),n||this.set.add(this.graph)},t}(),H=function(){function t(t,e){this.drawing=t,this.e=e,this.color=this.drawing.colorOverride?L:e.color||L}return t.prototype.init=function(){},t.prototype.takeoffθ=function(){var t=this.drawing.namedEnts[this.e.from];return t?this.e.hasOwnProperty("angle")?d(p(this.e.angle)):this.e.hasOwnProperty("x")&&this.e.hasOwnProperty("y")?T(this.e.y-t.cy,this.e.x-t.cx):(console.log('connector from "'+this.e.from+"\" doesn't have x, y, or angle"),NaN):(console.log("connector with unknown origin: "+this.e.from),NaN)},t.prototype.isStraight=function(){var t=this.drawing.namedEnts[this.e.from];if(!t)return!1;var e=this.drawing.namedEnts[this.e.to];if(!e)return!1;var n=this.takeoffθ(),r=T(e.cy-t.cy,e.cx-t.cx);return Math.abs(r-n)<d(V)},t.prototype.draw=function(){this.isStraight()?this.drawStraight():this.drawArc()},t.prototype.drawLabel=function(){},t.prototype.visualize=function(){},t.prototype.arcCircle=function(){var t=this.drawing.namedEnts[this.e.from],e=this.drawing.namedEnts[this.e.to];if(t&&e){if(!this.e.hasOwnProperty("angle"))return h({x:t.cx,y:t.cy},{x:e.cx,y:e.cy},{x:this.e.x,y:this.e.y});var n=S(this.takeoffθ()),r=-1/n;o(r)?r=0:a(r)&&(r=1/0);var i,s=(Math.atan(r),t.cy-r*t.cx);if(t.cy===e.cy)i=(t.cx+e.cx)/2;else{var l=(t.cy-e.cy)/(t.cx-e.cx),c=-1/l,f=(t.cx+e.cx)/2,p=(t.cy+e.cy)/2,d=p-c*f;i=(s-d)/(c-r)}var v=r*i+s,m=_(u(t.cx-i)+u(t.cy-v));return{r:m,x:i,y:v}}},t.prototype.intersectEntStraight=function(t,e){var n=C;return t instanceof U?n=25:t instanceof X&&(n=20),{x:t.cx+n*k(e),y:t.cy+n*w(e)}},t.prototype.intersectEntArc=function(t,e,n){var r=C;t instanceof U?r=25:t instanceof X&&(r=20);var i=S(r/e.r),o=T(t.cy-e.y,t.cx-e.x);return{x:e.x+e.r*k(o+(n?1:-1)*i),y:e.y+e.r*w(o+(n?1:-1)*i)}},t.prototype.drawStraight=function(){var t=this.drawing.paper,e=this.drawing.namedEnts[this.e.from],n=this.drawing.namedEnts[this.e.to];if(e&&n){var r=T(n.cy-e.cy,n.cx-e.cx),i=this.intersectEntStraight(e,r),o=this.intersectEntStraight(n,m(r)),s=v(r),a="M"+i.x+","+i.y+"L"+o.x+","+o.y;this.set=this.drawing.group(t.path(a).attr({"stroke-width":E/2,stroke:this.color,fill:"none"}),y(t,o.x,o.y,A).attr({transform:"rotate("+s+","+o.x+","+o.y+")",stroke:this.color,"stroke-width":1,fill:this.color,"stroke-linejoin":"round"}))}},t.prototype.drawArc=function(){var t=this.drawing.paper,e=this.drawing.namedEnts[this.e.from],n=this.drawing.namedEnts[this.e.to];if(e&&n){var r=this.takeoffθ(),i=this.arcCircle(),o=T(e.cy-i.y,e.cx-i.x),a=T(n.cy-i.y,n.cx-i.x),l=a-o;l>d(180)&&(l-=d(360));var c=l>0||l<=d(-180),h=this.intersectEntArc(e,i,c),f=this.intersectEntArc(n,i,!c),p=_(u(h.x-e.cx)+u(h.y-e.cy)),m=e.cx+p*k(r),g=e.cy+p*w(r),x=!s(m,h.x,5)||!s(g,h.y,5);x&&(c=!c,h=this.intersectEntArc(e,i,c),f=this.intersectEntArc(n,i,!c));var b="M"+h.x+","+h.y+"A"+i.r+","+i.r+" 0 "+ +x+","+ +c+" "+f.x+","+f.y,S=v(T(f.y-i.y,f.x-i.x))-90;c&&(S+=180),this.set=this.drawing.group(t.path(b).attr({"stroke-width":E/2,stroke:this.color,fill:"none"}),y(t,f.x,f.y,A).attr({transform:"rotate("+S+","+f.x+","+f.y+")",stroke:this.color,"stroke-width":1,fill:this.color,"stroke-linejoin":"round"}))}},t}(),W={stock:X,flow:Y,aux:G,connector:H,module:U},$=function(){function t(t,e,r,i,o,s){this.model=t,this.xmile=e;var a,u;if("string"==typeof r){var l=r;l.length>0&&"#"===l[0]&&(l=l.substr(1)),a=document.getElementById(l)}else a=r;u=a,a.innerHTML="",this.paper=Snap(u);var c=u.getElementsByTagName("defs")[0];c?c.outerHTML=n.drawCSS:a.innerHTML+=n.drawCSS,this._g=this.paper.g(),this._g.node.id="viewport",this.colorOverride=i,this.stocksXYCenter=s,a.setAttribute("preserveAspectRatio","xMinYMin");var h="translateZ(0px)",f=a.style;f["-webkit-transform"]=h,f["-moz-transform"]=h,f["-ms-transform"]=h,f["-o-transform"]=h,f.transform=h,this.dEnts=[],this.zEnts=new Array(D);for(var p=0;p<D;p++)this.zEnts[p]=[];this.namedEnts={};for(var p=0;p<e.elements.length;p++){var d=e.elements[p];if("style"!==d.type)if(W.hasOwnProperty(d.type)){var v=new W[d.type](this,d);this.dEnts.push(v),this.zEnts[F[d.type]].push(v),v.ident&&(this.namedEnts[v.ident]=v)}else console.log("unknown draw ent type "+d.type)}for(var p=0;p<this.dEnts.length;p++)this.dEnts[p].init();for(var p=0;p<D;p++)for(var m=0;m<this.zEnts[p].length;m++)this.zEnts[p][m].draw();for(var p=0;p<D;p++)for(var m=0;m<this.zEnts[p].length;m++)this.zEnts[p][m].drawLabel();this._t={scale:1,dscale:0,x:0,y:0,dx:0,dy:0};var g=this;o&&(u.onwheel=function(t){var e=g,n=-t.deltaY/20;e.applyDScaleAt(n,t),e.normalizeTransform(),e.transform()})}return t.prototype.applyDScaleAt=function(t,e){this._t.dscale=t,this._t.scale+this._t.dscale<q&&(this._t.dscale=q-this._t.scale),this._t.dx=-(e.pageX-this._t.x)*this._t.dscale/this._t.scale,this._t.dy=-(e.pageY-this._t.y)*this._t.dscale/this._t.scale},t.prototype.transform=function(t,e,n){3===arguments.length&&(this._t.scale=t,this._t.x=e,this._t.y=n),e=this._t.x+this._t.dx,n=this._t.y+this._t.dy,t=this._t.scale+this._t.dscale;var r="translateZ(0px) matrix("+t+",0,0,"+t+","+e+","+n+")";this._g.node.style["-webkit-transform"]=r,this._g.node.style["-moz-transform"]=r,this._g.node.style["-ms-transform"]=r,this._g.node.style.transform=r},t.prototype.normalizeTransform=function(){this._t.x+=this._t.dx,this._t.y+=this._t.dy,this._t.scale+=this._t.dscale,this._t.scale<q&&(this._t.scale=q),this._t.dx=0,this._t.dy=0,this._t.dscale=0},t.prototype.visualize=function(t){if(t.project){var e=t,n=this;e.series.apply(e,Object.keys(this.namedEnts)).then(function(e){for(var r in e)if(e.hasOwnProperty(r)){t=e[r];var i=n.namedEnts[r];i?i.visualize(t.time,t.values):console.log("sim data for non-drawn "+r)}}).done()}else{var r=t;for(var i in r)if(r.hasOwnProperty(i)){t=r[i];var o=this.namedEnts[i];o?o.visualize(t.time,t.values):console.log("sim data for non-drawn "+i)}}},t.prototype.group=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var n=this.paper.g.apply(this.paper,t);return this._g.append(n),n},t}();e.Drawing=$}),function(t){"use strict";if("function"==typeof bootstrap)bootstrap("promise",t);else if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof n&&n.amd)n("q",t);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=t}else{if("undefined"==typeof window&&"undefined"==typeof self)throw new Error("This environment was not anticipated by Q. Please file a bug.");var e="undefined"!=typeof window?window:self,r=e.Q;e.Q=t(),e.Q.noConflict=function(){return e.Q=r,this}}}(function(){"use strict";function t(t){return function(){return H.apply(t,arguments)}}function e(t){return t===Object(t)}function n(t){return"[object StopIteration]"===nt(t)||t instanceof X}function r(t,e){if(I&&e.stack&&"object"==typeof t&&null!==t&&t.stack){for(var n=[],r=e;r;r=r.source)r.stack&&(!t.__minimumStackCounter__||t.__minimumStackCounter__>r.stackCounter)&&(K(t,"__minimumStackCounter__",{value:r.stackCounter,configurable:!0}),n.unshift(r.stack));n.unshift(t.stack);var o=n.join("\n"+rt+"\n"),s=i(o);K(t,"stack",{value:s,configurable:!0})}}function i(t){for(var e=t.split("\n"),n=[],r=0;r<e.length;++r){var i=e[r];a(i)||o(i)||!i||n.push(i)}return n.join("\n")}function o(t){return t.indexOf("(module.js:")!==-1||t.indexOf("(node.js:")!==-1}function s(t){var e=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(e)return[e[1],Number(e[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(n)return[n[1],Number(n[2])];
var r=/.*@(.+):(\d+)$/.exec(t);return r?[r[1],Number(r[2])]:void 0}function a(t){var e=s(t);if(!e)return!1;var n=e[0],r=e[1];return n===z&&r>=U&&r<=lt}function u(){if(I)try{throw new Error}catch(r){var t=r.stack.split("\n"),e=t[0].indexOf("@")>0?t[1]:t[2],n=s(e);if(!n)return;return z=n[0],n[1]}}function l(t,e,n){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(e+" is deprecated, use "+n+" instead.",new Error("").stack),t.apply(t,arguments)}}function c(t){return t instanceof d?t:y(t)?N(t):C(t)}function h(){function t(t){e=t,c.longStackSupport&&I&&(o.source=t),$(n,function(e,n){c.nextTick(function(){t.promiseDispatch.apply(t,n)})},void 0),n=void 0,r=void 0}var e,n=[],r=[],i=J(h.prototype),o=J(d.prototype);if(o.promiseDispatch=function(t,i,o){var s=W(arguments);n?(n.push(s),"when"===i&&o[1]&&r.push(o[1])):c.nextTick(function(){e.promiseDispatch.apply(e,s)})},o.valueOf=function(){if(n)return o;var t=m(e);return g(t)&&(e=t),t},o.inspect=function(){return e?e.inspect():{state:"pending"}},c.longStackSupport&&I)try{throw new Error}catch(t){o.stack=t.stack.substring(t.stack.indexOf("\n")+1),o.stackCounter=it++}return i.promise=o,i.resolve=function(n){e||t(c(n))},i.fulfill=function(n){e||t(C(n))},i.reject=function(n){e||t(_(n))},i.notify=function(t){e||$(r,function(e,n){c.nextTick(function(){n(t)})},void 0)},i}function f(t){if("function"!=typeof t)throw new TypeError("resolver must be a function.");var e=h();try{t(e.resolve,e.reject,e.notify)}catch(t){e.reject(t)}return e.promise}function p(t){return f(function(e,n){for(var r=0,i=t.length;r<i;r++)c(t[r]).then(e,n)})}function d(t,e,n){void 0===e&&(e=function(t){return _(new Error("Promise does not support operation: "+t))}),void 0===n&&(n=function(){return{state:"unknown"}});var r=J(d.prototype);if(r.promiseDispatch=function(n,i,o){var s;try{s=t[i]?t[i].apply(r,o):e.call(r,i,o)}catch(t){s=_(t)}n&&n(s)},r.inspect=n,n){var i=n();"rejected"===i.state&&(r.exception=i.reason),r.valueOf=function(){var t=n();return"pending"===t.state||"rejected"===t.state?r:t.value}}return r}function v(t,e,n,r){return c(t).then(e,n,r)}function m(t){if(g(t)){var e=t.inspect();if("fulfilled"===e.state)return e.value}return t}function g(t){return t instanceof d}function y(t){return e(t)&&"function"==typeof t.then}function x(t){return g(t)&&"pending"===t.inspect().state}function b(t){return!g(t)||"fulfilled"===t.inspect().state}function w(t){return g(t)&&"rejected"===t.inspect().state}function k(){ot.length=0,st.length=0,ut||(ut=!0)}function S(t,e){ut&&("object"==typeof process&&"function"==typeof process.emit&&c.nextTick.runAfter(function(){Q(st,t)!==-1&&(process.emit("unhandledRejection",e,t),at.push(t))}),st.push(t),e&&"undefined"!=typeof e.stack?ot.push(e.stack):ot.push("(no stack) "+e))}function T(t){if(ut){var e=Q(st,t);e!==-1&&("object"==typeof process&&"function"==typeof process.emit&&c.nextTick.runAfter(function(){var n=Q(at,t);n!==-1&&(process.emit("rejectionHandled",ot[e],t),at.splice(n,1))}),st.splice(e,1),ot.splice(e,1))}}function _(t){var e=d({when:function(e){return e&&T(this),e?e(t):this}},function(){return this},function(){return{state:"rejected",reason:t}});return S(e,t),e}function C(t){return d({when:function(){return t},get:function(e){return t[e]},set:function(e,n){t[e]=n},delete:function(e){delete t[e]},post:function(e,n){return null===e||void 0===e?t.apply(void 0,n):t[e].apply(t,n)},apply:function(e,n){return t.apply(e,n)},keys:function(){return et(t)}},void 0,function(){return{state:"fulfilled",value:t}})}function N(t){var e=h();return c.nextTick(function(){try{t.then(e.resolve,e.reject,e.notify)}catch(t){e.reject(t)}}),e.promise}function E(t){return d({isDef:function(){}},function(e,n){return R(t,e,n)},function(){return c(t).inspect()})}function P(t,e,n){return c(t).spread(e,n)}function j(t){return function(){function e(t,e){var s;if("undefined"==typeof StopIteration){try{s=r[t](e)}catch(t){return _(t)}return s.done?c(s.value):v(s.value,i,o)}try{s=r[t](e)}catch(t){return n(t)?c(t.value):_(t)}return v(s,i,o)}var r=t.apply(this,arguments),i=e.bind(e,"next"),o=e.bind(e,"throw");return i()}}function A(t){c.done(c.async(t)())}function O(t){throw new X(t)}function M(t){return function(){return P([this,L(arguments)],function(e,n){return t.apply(e,n)})}}function R(t,e,n){return c(t).dispatch(e,n)}function L(t){return v(t,function(t){var e=0,n=h();return $(t,function(r,i,o){var s;g(i)&&"fulfilled"===(s=i.inspect()).state?t[o]=s.value:(++e,v(i,function(r){t[o]=r,0===--e&&n.resolve(t)},n.reject,function(t){n.notify({index:o,value:t})}))},void 0),0===e&&n.resolve(t),n.promise})}function B(t){if(0===t.length)return c.resolve();var e=c.defer(),n=0;return $(t,function(r,i,o){function s(t){e.resolve(t)}function a(t){n--,0===n&&(t.message="Q can't get fulfillment value from any promise, all promises were rejected. Last error message: "+t.message,e.reject(t))}function u(t){e.notify({index:o,value:t})}var l=t[o];n++,v(l,s,a,u)},void 0),e.promise}function F(t){return v(t,function(t){return t=Z(t,c),v(L(Z(t,function(t){return v(t,G,G)})),function(){return t})})}function q(t){return c(t).allSettled()}function D(t,e){return c(t).then(void 0,void 0,e)}function V(t,e){return c(t).nodeify(e)}var I=!1;try{throw new Error}catch(t){I=!!t.stack}var z,X,U=u(),G=function(){},Y=function(){function t(){for(var t,r;n.next;)n=n.next,t=n.task,n.task=void 0,r=n.domain,r&&(n.domain=void 0,r.enter()),e(t,r);for(;a.length;)t=a.pop(),e(t);i=!1}function e(e,n){try{e()}catch(e){if(s)throw n&&n.exit(),setTimeout(t,0),n&&n.enter(),e;setTimeout(function(){throw e},0)}n&&n.exit()}var n={task:void 0,next:null},r=n,i=!1,o=void 0,s=!1,a=[];if(Y=function(t){r=r.next={task:t,domain:s&&process.domain,next:null},i||(i=!0,o())},"object"==typeof process&&"[object process]"===process.toString()&&process.nextTick)s=!0,o=function(){process.nextTick(t)};else if("function"==typeof setImmediate)o="undefined"!=typeof window?setImmediate.bind(window,t):function(){setImmediate(t)};else if("undefined"!=typeof MessageChannel){var u=new MessageChannel;u.port1.onmessage=function(){o=l,u.port1.onmessage=t,t()};var l=function(){u.port2.postMessage(0)};o=function(){setTimeout(t,0),l()}}else o=function(){setTimeout(t,0)};return Y.runAfter=function(t){a.push(t),i||(i=!0,o())},Y}(),H=Function.call,W=t(Array.prototype.slice),$=t(Array.prototype.reduce||function(t,e){var n=0,r=this.length;if(1===arguments.length)for(;;){if(n in this){e=this[n++];break}if(++n>=r)throw new TypeError}for(;n<r;n++)n in this&&(e=t(e,this[n],n));return e}),Q=t(Array.prototype.indexOf||function(t){for(var e=0;e<this.length;e++)if(this[e]===t)return e;return-1}),Z=t(Array.prototype.map||function(t,e){var n=this,r=[];return $(n,function(i,o,s){r.push(t.call(e,o,s,n))},void 0),r}),J=Object.create||function(t){function e(){}return e.prototype=t,new e},K=Object.defineProperty||function(t,e,n){return t[e]=n.value,t},tt=t(Object.prototype.hasOwnProperty),et=Object.keys||function(t){var e=[];for(var n in t)tt(t,n)&&e.push(n);return e},nt=t(Object.prototype.toString);X="undefined"!=typeof ReturnValue?ReturnValue:function(t){this.value=t};var rt="From previous event:";c.resolve=c,c.nextTick=Y,c.longStackSupport=!1;var it=1;"object"==typeof process&&process&&process.env&&process.env.Q_DEBUG&&(c.longStackSupport=!0),c.defer=h,h.prototype.makeNodeResolver=function(){var t=this;return function(e,n){e?t.reject(e):arguments.length>2?t.resolve(W(arguments,1)):t.resolve(n)}},c.Promise=f,c.promise=f,f.race=p,f.all=L,f.reject=_,f.resolve=c,c.passByCopy=function(t){return t},d.prototype.passByCopy=function(){return this},c.join=function(t,e){return c(t).join(e)},d.prototype.join=function(t){return c([this,t]).spread(function(t,e){if(t===e)return t;throw new Error("Q can't join: not the same: "+t+" "+e)})},c.race=p,d.prototype.race=function(){return this.then(c.race)},c.makePromise=d,d.prototype.toString=function(){return"[object Promise]"},d.prototype.then=function(t,e,n){function i(e){try{return"function"==typeof t?t(e):e}catch(t){return _(t)}}function o(t){if("function"==typeof e){r(t,a);try{return e(t)}catch(t){return _(t)}}return _(t)}function s(t){return"function"==typeof n?n(t):t}var a=this,u=h(),l=!1;return c.nextTick(function(){a.promiseDispatch(function(t){l||(l=!0,u.resolve(i(t)))},"when",[function(t){l||(l=!0,u.resolve(o(t)))}])}),a.promiseDispatch(void 0,"when",[void 0,function(t){var e,n=!1;try{e=s(t)}catch(t){if(n=!0,!c.onerror)throw t;c.onerror(t)}n||u.notify(e)}]),u.promise},c.tap=function(t,e){return c(t).tap(e)},d.prototype.tap=function(t){return t=c(t),this.then(function(e){return t.fcall(e).thenResolve(e)})},c.when=v,d.prototype.thenResolve=function(t){return this.then(function(){return t})},c.thenResolve=function(t,e){return c(t).thenResolve(e)},d.prototype.thenReject=function(t){return this.then(function(){throw t})},c.thenReject=function(t,e){return c(t).thenReject(e)},c.nearer=m,c.isPromise=g,c.isPromiseAlike=y,c.isPending=x,d.prototype.isPending=function(){return"pending"===this.inspect().state},c.isFulfilled=b,d.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},c.isRejected=w,d.prototype.isRejected=function(){return"rejected"===this.inspect().state};var ot=[],st=[],at=[],ut=!0;c.resetUnhandledRejections=k,c.getUnhandledReasons=function(){return ot.slice()},c.stopUnhandledRejectionTracking=function(){k(),ut=!1},k(),c.reject=_,c.fulfill=C,c.master=E,c.spread=P,d.prototype.spread=function(t,e){return this.all().then(function(e){return t.apply(void 0,e)},e)},c.async=j,c.spawn=A,c.return=O,c.promised=M,c.dispatch=R,d.prototype.dispatch=function(t,e){var n=this,r=h();return c.nextTick(function(){n.promiseDispatch(r.resolve,t,e)}),r.promise},c.get=function(t,e){return c(t).dispatch("get",[e])},d.prototype.get=function(t){return this.dispatch("get",[t])},c.set=function(t,e,n){return c(t).dispatch("set",[e,n])},d.prototype.set=function(t,e){return this.dispatch("set",[t,e])},c.del=c.delete=function(t,e){return c(t).dispatch("delete",[e])},d.prototype.del=d.prototype.delete=function(t){return this.dispatch("delete",[t])},c.mapply=c.post=function(t,e,n){return c(t).dispatch("post",[e,n])},d.prototype.mapply=d.prototype.post=function(t,e){return this.dispatch("post",[t,e])},c.send=c.mcall=c.invoke=function(t,e){return c(t).dispatch("post",[e,W(arguments,2)])},d.prototype.send=d.prototype.mcall=d.prototype.invoke=function(t){return this.dispatch("post",[t,W(arguments,1)])},c.fapply=function(t,e){return c(t).dispatch("apply",[void 0,e])},d.prototype.fapply=function(t){return this.dispatch("apply",[void 0,t])},c.try=c.fcall=function(t){return c(t).dispatch("apply",[void 0,W(arguments,1)])},d.prototype.fcall=function(){return this.dispatch("apply",[void 0,W(arguments)])},c.fbind=function(t){var e=c(t),n=W(arguments,1);return function(){return e.dispatch("apply",[this,n.concat(W(arguments))])}},d.prototype.fbind=function(){var t=this,e=W(arguments);return function(){return t.dispatch("apply",[this,e.concat(W(arguments))])}},c.keys=function(t){return c(t).dispatch("keys",[])},d.prototype.keys=function(){return this.dispatch("keys",[])},c.all=L,d.prototype.all=function(){return L(this)},c.any=B,d.prototype.any=function(){return B(this)},c.allResolved=l(F,"allResolved","allSettled"),d.prototype.allResolved=function(){return F(this)},c.allSettled=q,d.prototype.allSettled=function(){return this.then(function(t){return L(Z(t,function(t){function e(){return t.inspect()}return t=c(t),t.then(e,e)}))})},c.fail=c.catch=function(t,e){return c(t).then(void 0,e)},d.prototype.fail=d.prototype.catch=function(t){return this.then(void 0,t)},c.progress=D,d.prototype.progress=function(t){return this.then(void 0,void 0,t)},c.fin=c.finally=function(t,e){return c(t).finally(e)},d.prototype.fin=d.prototype.finally=function(t){if(!t||"function"!=typeof t.apply)throw new Error("Q can't apply finally callback");return t=c(t),this.then(function(e){return t.fcall().then(function(){return e})},function(e){return t.fcall().then(function(){throw e})})},c.done=function(t,e,n,r){return c(t).done(e,n,r)},d.prototype.done=function(t,e,n){var i=function(t){c.nextTick(function(){if(r(t,o),!c.onerror)throw t;c.onerror(t)})},o=t||e||n?this.then(t,e,n):this;"object"==typeof process&&process&&process.domain&&(i=process.domain.bind(i)),o.then(void 0,i)},c.timeout=function(t,e,n){return c(t).timeout(e,n)},d.prototype.timeout=function(t,e){var n=h(),r=setTimeout(function(){e&&"string"!=typeof e||(e=new Error(e||"Timed out after "+t+" ms"),e.code="ETIMEDOUT"),n.reject(e)},t);return this.then(function(t){clearTimeout(r),n.resolve(t)},function(t){clearTimeout(r),n.reject(t)},n.notify),n.promise},c.delay=function(t,e){return void 0===e&&(e=t,t=void 0),c(t).delay(e)},d.prototype.delay=function(t){return this.then(function(e){var n=h();return setTimeout(function(){n.resolve(e)},t),n.promise})},c.nfapply=function(t,e){return c(t).nfapply(e)},d.prototype.nfapply=function(t){var e=h(),n=W(t);return n.push(e.makeNodeResolver()),this.fapply(n).fail(e.reject),e.promise},c.nfcall=function(t){var e=W(arguments,1);return c(t).nfapply(e)},d.prototype.nfcall=function(){var t=W(arguments),e=h();return t.push(e.makeNodeResolver()),this.fapply(t).fail(e.reject),e.promise},c.nfbind=c.denodeify=function(t){if(void 0===t)throw new Error("Q can't wrap an undefined function");var e=W(arguments,1);return function(){var n=e.concat(W(arguments)),r=h();return n.push(r.makeNodeResolver()),c(t).fapply(n).fail(r.reject),r.promise}},d.prototype.nfbind=d.prototype.denodeify=function(){var t=W(arguments);return t.unshift(this),c.denodeify.apply(void 0,t)},c.nbind=function(t,e){var n=W(arguments,2);return function(){function r(){return t.apply(e,arguments)}var i=n.concat(W(arguments)),o=h();return i.push(o.makeNodeResolver()),c(r).fapply(i).fail(o.reject),o.promise}},d.prototype.nbind=function(){var t=W(arguments,0);return t.unshift(this),c.nbind.apply(void 0,t)},c.nmapply=c.npost=function(t,e,n){return c(t).npost(e,n)},d.prototype.nmapply=d.prototype.npost=function(t,e){var n=W(e||[]),r=h();return n.push(r.makeNodeResolver()),this.dispatch("post",[t,n]).fail(r.reject),r.promise},c.nsend=c.nmcall=c.ninvoke=function(t,e){var n=W(arguments,2),r=h();return n.push(r.makeNodeResolver()),c(t).dispatch("post",[e,n]).fail(r.reject),r.promise},d.prototype.nsend=d.prototype.nmcall=d.prototype.ninvoke=function(t){var e=W(arguments,1),n=h();return e.push(n.makeNodeResolver()),this.dispatch("post",[t,e]).fail(n.reject),n.promise},c.nodeify=V,d.prototype.nodeify=function(t){return t?void this.then(function(e){c.nextTick(function(){t(null,e)})},function(e){c.nextTick(function(){t(e)})}):this},c.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var lt=u();return c}),function(t,e){"object"==typeof exports&&exports&&"string"!=typeof exports.nodeName?e(exports):"function"==typeof n&&n.amd?n("mustache",["exports"],e):(t.Mustache={},e(t.Mustache))}(this,function(t){function e(t){return"function"==typeof t}function n(t){return v(t)?"array":typeof t}function r(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function i(t,e){return null!=t&&"object"==typeof t&&e in t}function o(t,e){return m.call(t,e)}function s(t){return!o(g,t)}function a(t){return String(t).replace(/[&<>"'`=\/]/g,function(t){return y[t]})}function u(e,n){function i(){if(g&&!y)for(;m.length;)delete d[m.pop()];else m=[];g=!1,y=!1}function o(t){if("string"==typeof t&&(t=t.split(b,2)),!v(t)||2!==t.length)throw new Error("Invalid tags: "+t);a=new RegExp(r(t[0])+"\\s*"),u=new RegExp("\\s*"+r(t[1])),f=new RegExp("\\s*"+r("}"+t[1]))}if(!e)return[];var a,u,f,p=[],d=[],m=[],g=!1,y=!1;o(n||t.tags);for(var T,_,C,N,E,P,j=new h(e);!j.eos();){if(T=j.pos,C=j.scanUntil(a))for(var A=0,O=C.length;A<O;++A)N=C.charAt(A),s(N)?m.push(d.length):y=!0,d.push(["text",N,T,T+1]),T+=1,"\n"===N&&i();if(!j.scan(a))break;if(g=!0,_=j.scan(S)||"name",j.scan(x),"="===_?(C=j.scanUntil(w),j.scan(w),j.scanUntil(u)):"{"===_?(C=j.scanUntil(f),j.scan(k),j.scanUntil(u),_="&"):C=j.scanUntil(u),!j.scan(u))throw new Error("Unclosed tag at "+j.pos);if(E=[_,C,T,j.pos],d.push(E),"#"===_||"^"===_)p.push(E);else if("/"===_){if(P=p.pop(),!P)throw new Error('Unopened section "'+C+'" at '+T);if(P[1]!==C)throw new Error('Unclosed section "'+P[1]+'" at '+T)}else"name"===_||"{"===_||"&"===_?y=!0:"="===_&&o(C)}if(P=p.pop())throw new Error('Unclosed section "'+P[1]+'" at '+j.pos);return c(l(d))}function l(t){for(var e,n,r=[],i=0,o=t.length;i<o;++i)e=t[i],e&&("text"===e[0]&&n&&"text"===n[0]?(n[1]+=e[1],n[3]=e[3]):(r.push(e),n=e));return r}function c(t){for(var e,n,r=[],i=r,o=[],s=0,a=t.length;s<a;++s)switch(e=t[s],e[0]){case"#":case"^":i.push(e),o.push(e),i=e[4]=[];break;case"/":n=o.pop(),n[5]=e[2],i=o.length>0?o[o.length-1][4]:r;break;default:i.push(e)}return r}function h(t){this.string=t,this.tail=t,this.pos=0}function f(t,e){this.view=t,this.cache={".":this.view},this.parent=e}function p(){this.cache={}}var d=Object.prototype.toString,v=Array.isArray||function(t){return"[object Array]"===d.call(t)},m=RegExp.prototype.test,g=/\S/,y={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},x=/\s*/,b=/\s+/,w=/\s*=/,k=/\s*\}/,S=/#|\^|\/|>|\{|&|=|!/;h.prototype.eos=function(){return""===this.tail},h.prototype.scan=function(t){var e=this.tail.match(t);if(!e||0!==e.index)return"";var n=e[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},h.prototype.scanUntil=function(t){var e,n=this.tail.search(t);switch(n){case-1:e=this.tail,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=e.length,e},f.prototype.push=function(t){return new f(t,this)},f.prototype.lookup=function(t){var n,r=this.cache;if(r.hasOwnProperty(t))n=r[t];else{for(var o,s,a=this,u=!1;a;){if(t.indexOf(".")>0)for(n=a.view,o=t.split("."),s=0;null!=n&&s<o.length;)s===o.length-1&&(u=i(n,o[s])),n=n[o[s++]];else n=a.view[t],u=i(a.view,t);if(u)break;a=a.parent}r[t]=n}return e(n)&&(n=n.call(this.view)),n},p.prototype.clearCache=function(){this.cache={}},p.prototype.parse=function(t,e){var n=this.cache,r=n[t];return null==r&&(r=n[t]=u(t,e)),r},p.prototype.render=function(t,e,n){var r=this.parse(t),i=e instanceof f?e:new f(e);return this.renderTokens(r,i,n,t)},p.prototype.renderTokens=function(t,e,n,r){for(var i,o,s,a="",u=0,l=t.length;u<l;++u)s=void 0,i=t[u],o=i[0],"#"===o?s=this.renderSection(i,e,n,r):"^"===o?s=this.renderInverted(i,e,n,r):">"===o?s=this.renderPartial(i,e,n,r):"&"===o?s=this.unescapedValue(i,e):"name"===o?s=this.escapedValue(i,e):"text"===o&&(s=this.rawValue(i)),void 0!==s&&(a+=s);return a},p.prototype.renderSection=function(t,n,r,i){function o(t){return s.render(t,n,r)}var s=this,a="",u=n.lookup(t[1]);if(u){if(v(u))for(var l=0,c=u.length;l<c;++l)a+=this.renderTokens(t[4],n.push(u[l]),r,i);else if("object"==typeof u||"string"==typeof u||"number"==typeof u)a+=this.renderTokens(t[4],n.push(u),r,i);else if(e(u)){if("string"!=typeof i)throw new Error("Cannot use higher-order sections without the original template");u=u.call(n.view,i.slice(t[3],t[5]),o),null!=u&&(a+=u)}else a+=this.renderTokens(t[4],n,r,i);return a}},p.prototype.renderInverted=function(t,e,n,r){var i=e.lookup(t[1]);if(!i||v(i)&&0===i.length)return this.renderTokens(t[4],e,n,r)},p.prototype.renderPartial=function(t,n,r){if(r){var i=e(r)?r(t[1]):r[t[1]];return null!=i?this.renderTokens(this.parse(i),n,r,i):void 0}},p.prototype.unescapedValue=function(t,e){var n=e.lookup(t[1]);if(null!=n)return n},p.prototype.escapedValue=function(e,n){var r=n.lookup(e[1]);if(null!=r)return t.escape(r)},p.prototype.rawValue=function(t){return t[1]},t.name="mustache.js",t.version="2.3.0",t.tags=["{{","}}"];var T=new p;return t.clearCache=function(){return T.clearCache()},t.parse=function(t,e){return T.parse(t,e)},t.render=function(t,e,r){if("string"!=typeof t)throw new TypeError('Invalid template! Template should be a "string" but "'+n(t)+'" was given as the first argument for mustache#render(template, view, partials)');return T.render(t,e,r)},t.to_html=function(n,r,i,o){var s=t.render(n,r,i);return e(o)?void o(s):s},t.escape=a,t.Scanner=h,t.Context=f,t.Writer=p,t}),n("sim",["require","exports","./util","./vars","./runtime","q","mustache"],function(t,e,n,r,i,o,s){"use strict";var a=!0,u=a?"\t":"",l=a?"\n\t":"",c="{{&preamble}}\n\n{{#models}}\nvar {{&className}} = function {{&className}}(name, parent, offset, symRefs) {\n\tthis.name = name;\n\tthis.parent = parent;\n\t// if we are a module, record the offset in the curr & next\n\t// arrays we should be writing at\n\tthis._shift = i32(offset);\n\t{{&init}}\n\tthis.modules = {{&modules}};\n\t// symbolic references, which will get resolved into integer\n\t// offsets in the ref map after all Simulation objects have\n\t// been initialized.\n\tthis.symRefs = symRefs || {};\n\tthis.ref = {};\n\tthis.nVars = this.getNVars();\n\tif (name === 'main')\n\t\tthis.reset();\n};\n\n{{&className}}.prototype = new Simulation();\n{{&className}}.prototype.initials = {{&initialVals}};\n{{&className}}.prototype.simSpec = {{&simSpecVals}};\n{{&className}}.prototype.offsets = {{&offsets}};\n{{&className}}.prototype.tables = {{&tableVals}};\n{{&className}}.prototype.calcInitial = function(dt, curr) {\n\tdt = +dt;\n{{#isModule}}\n\tvar globalCurr = curr;\n\tcurr = curr.subarray(this._shift, this._shift + this.nVars);\n{{/isModule}}\n\t{{&calcI}}\n};\n{{&className}}.prototype.calcFlows = function(dt, curr) {\n\tdt = +dt;\n{{#isModule}}\n\tvar globalCurr = curr;\n\tcurr = curr.subarray(this._shift, this._shift + this.nVars);\n{{/isModule}}\n\t{{&calcF}}\n};\n{{&className}}.prototype.calcStocks = function(dt, curr, next) {\n\tdt = +dt;\n{{#isModule}}\n\tvar globalCurr = curr;\n\tcurr = curr.subarray(this._shift, this._shift + this.nVars);\n\tnext = next.subarray(this._shift, this._shift + this.nVars);\n{{/isModule}}\n\t{{&calcS}}\n};\n\n{{/models}}\nvar main = new {{&mainClassName}}('main');\n\nmain.resolveAllSymbolicRefs();\n\nvar cmds = initCmds(main);\n\n{{&epilogue}}",h=function(){function t(t,e,r,i,o,s,a,c,h){this.name=t.name,this.className=n.titleCase(t.name),this.isModule="main"!==t.name,this.modules=e.join(l),this.init=r.join(l),this.initialVals=JSON.stringify(i,null,u),this.simSpecVals=JSON.stringify(t.simSpec,null,u),this.tableVals=JSON.stringify(o,null,u),this.calcI=a.join(l),this.calcF=c.join(l),this.calcS=h.join(l),this.offsets=JSON.stringify(s,null,u)}return t}();e.TemplateContext=h;var f=function(){function t(t,e){this.root=t,this.project=t.project,this.seq=1,this.promised={},this.idSeq={};var r=t.referencedModels(),o=[];for(var a in r)r.hasOwnProperty(a)&&("main"===a?this.idSeq[a]=1:this.idSeq[a]=0,o.push(this._process(r[a].model,r[a].modules)));var u=s.render(c,{preamble:i.preamble,epilogue:e?i.epilogue:"onmessage = handleMessage;",mainClassName:n.titleCase(t.modelName),models:o});if(e)return void console.log(u);var l=new Blob([u],{type:"text/javascript"});this.worker=new Worker(window.URL.createObjectURL(l)),l=null,u=null;var h=this;this.worker.addEventListener("message",function(t){var e=t.data[0],n=t.data[1],r=h.promised[e];delete h.promised[e],r&&(n[1]?r.reject(n[1]):r.resolve(n[0]))})}return t.prototype._process=function(t,e){function i(t){for(var n=0;n<e.length;n++)if(t in e[n].refs)return!0;return!1}var o=[],s=[],u=[],l={},c={};for(var f in t.vars)if(t.vars.hasOwnProperty(f)){var p=t.vars[f];if(p instanceof r.Module?(o.push(p),s.push(p),u.push(p)):p instanceof r.Stock?(o.push(p),u.push(p)):p instanceof r.Table?s.push(p):p.isConst()?(o.push(p),u.push(p)):s.push(p),!(p instanceof r.Module||i(f))){var d=this.nextID(t.name);c[f]=d,a?l[f]=d+"/*"+f+"*/":l[f]=d}}n.sort(o),n.sort(s);for(var v={},m={},g=[],y=[],x=[],b=0;b<o.length;b++){var w=void 0,p=o[b];if(p instanceof r.Module)w='this.modules["'+p.ident+'"].calcInitial(dt, curr);';else{if(i(p.ident))continue;p.isConst()&&(v[p.ident]=parseFloat(p.eqn)),w="curr["+l[p.ident]+"] = "+r.Variable.prototype.code.apply(p,[l])+";"}g.push(w)}for(var b=0;b<s.length;b++){var w=void 0,p=s[b];w=null,p instanceof r.Module?w='this.modules["'+p.ident+'"].calcFlows(dt, curr);':i(p.ident)||(w="curr["+l[p.ident]+"] = "+p.code(l)+";"),w&&y.push(w)}for(var b=0;b<u.length;b++){var w=void 0,p=u[b];p instanceof r.Module?x.push('this.modules["'+p.ident+'"].calcStocks(dt, curr, next);'):p.hasOwnProperty("initial")?x.push("next["+l[p.ident]+"] = "+p.code(l)+";"):x.push("next["+l[p.ident]+"] = curr["+l[p.ident]+"];")}for(var f in t.tables)t.tables.hasOwnProperty(f)&&(m[f]={x:t.tables[f].x,y:t.tables[f].y});var k="",S=[];Object.keys(t.modules).length&&("main"===t.ident&&(k=" + 1"),S.push("var off = Object.keys(this.offsets).length"+k+";"));var T=[];T.push("{");for(var f in t.modules)if(t.modules.hasOwnProperty(f)){S.push("var "+f+"Refs = {");for(var _ in t.modules[f].refs)t.modules[f].refs.hasOwnProperty(_)&&S.push('    "'+_+'": "'+t.modules[f].refs[_].ptr+'",');S.push("};"),S.push("var "+f+" = new "+n.titleCase(t.modules[f].modelName)+'("'+f+'", this, off, '+f+"Refs);"),S.push("off += "+f+".nVars;"),T.push('    "'+f+'": '+f+",")}return T.push("}"),new h(t,T,S,v,m,c,g,y,x)},t.prototype.nextID=function(t){return this.idSeq[t]++},t.prototype._post=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var n=this.seq++,r=o.defer();return this.promised[n]=r,this.worker.postMessage([n].concat(t)),r.promise},t.prototype.close=function(){this.worker.terminate(),this.worker=null},t.prototype.reset=function(){return this._post("reset")},t.prototype.setValue=function(t,e){return this._post("set_val",t,e)},t.prototype.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var n=["get_val"].concat(t);return this._post.apply(this,n)},t.prototype.series=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var n=["get_series"].concat(t);return this._post.apply(this,n)},t.prototype.dominance=function(t,e){return this._post("dominance",t,e)},t.prototype.runTo=function(t){return this._post("run_to",t)},t.prototype.runToEnd=function(){return this._post("run_to_end")},t.prototype.setDesiredSeries=function(t){return this._post("set_desired_series",t)},t.prototype.varNames=function(){return this._post("var_names")},t.prototype.csv=function(t){function e(t){return r=t,this.series.apply(this,t)}function n(e){for(var n,o="",s={},a="time"+t,u=0;u<r.length;u++){var l=r[u];"time"!==l?(a+=l+t,s[l]=e[l]):n=e[l]}o+=a.substr(0,a.length-1),o+="\n";for(var c=n.values.length,u=0;u<c;u++){var h="";for(var l in s)s.hasOwnProperty(l)&&(""===h&&(h+=s[l].time[u]+t),h+=s[l].values[u]+t);o+=h.substr(0,h.length-1),o+="\n"}i.resolve(o)}void 0===t&&(t=",");var r,i=o.defer();return this.varNames().then(e.bind(this)).then(n.bind(this)),i.promise},t}();e.Sim=f}),n("model",["require","exports","./util","./vars","./draw","./sim","./xmile"],function(t,e,n,r,i,o,s){"use strict";var a=(n.set("module","stock","aux","flow"),function(){function t(t,e,n){this.modules={},this.tables={},this.vars={},this.project=t,this.xModel=n,this.name=e,this.vars={},this.tables={},this.modules={},this.parseVars(n.variables),this.spec=n.simSpec||null,this.valid=!0}return Object.defineProperty(t.prototype,"ident",{get:function(){return s.canonicalize(this.name)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"simSpec",{get:function(){return this.spec||this.project.simSpec},enumerable:!0,configurable:!0}),t.prototype.lookup=function(t){if("."===t[0]&&(t=t.substr(1)),t in this.vars)return this.vars[t];var e=t.split("."),n=this.modules[e[0]],r=this.project.model(n.modelName);return r.lookup(e.slice(1).join("."))},t.prototype.sim=function(t){var e;return"main"===this.name?e=this.project.main:(e=null,console.log("FIXME: sim of non-main model")),new o.Sim(e,t)},t.prototype.drawing=function(t,e,n,r){return void 0===r&&(r=!1),new i.Drawing(this,this.xModel.views[0],t,e,n,r)},t.prototype.parseVars=function(t){for(var e in t)if(t.hasOwnProperty(e)){var n=t[e],i=n.ident;if(i in this.vars)return new s.Error("duplicate var "+i);switch(n.type){case"module":var o=new r.Module(this.project,this,n);this.modules[i]=o,this.vars[i]=o;break;case"stock":var a=new r.Stock(this,n);this.vars[i]=a;break;case"aux":var u=null;if(n.gf){var l=new r.Table(this,n);l.ok&&(this.tables[i]=l,u=l)}u||(u=new r.Variable(this,n)),this.vars[i]=u;break;case"flow":var c=null;if(n.gf){var l=new r.Table(this,n);l.ok&&(this.tables[i]=l,c=l)}c||(c=new r.Variable(this,n)),this.vars[i]=c}}return null},t}());e.Model=a}),n("project",["require","exports","./common","./xmile","./model","./vars"],function(t,e,n,r,i,o){"use strict";function s(t){var e;for(e=0;e<t.childNodes.length;e++){var n=t.childNodes.item(e);if("xmile"===n.tagName)return n}return null}var a=function(){function t(t){n.err=null,this.files=[],this.models={},this.valid=!1,this.addDocument(t,!0)}return t.prototype.model=function(t){return t||(t="main"),this.models[t]},t.prototype.addDocument=function(t,e){if(void 0===e&&(e=!1),!t||0!==t.getElementsByTagName("parsererror").length)return n.err=n.Errors.ERR_VERSION,this.valid=!1,!1;var a=s(t);if(!a)return this.valid=!1,!1;var u=r.File.Build(a),l=u[0],c=u[1];if(c)return console.log("File.Build: "+c.error),this.valid=!1,!1;if(this.files.push(l),e&&(this.name=l.header.name||"sd project",this.simSpec=l.simSpec,!l.simSpec))return this.valid=!1,!1;for(var h in l.models)if(l.models.hasOwnProperty(h)){var f=l.models[h],p=f.ident;""!==p||"main"in this.models||(p="main"),this.models[p]=new i.Model(this,p,f)}var d=new r.Variable;return d.name="main",this.main=new o.Module(this,null,d),this.valid=!0,!0},t}();e.Project=a}),n("sd",["require","exports","./common","./project","./project","./model"],function(t,e,n,r,i,o){"use strict";function s(t){var e=new r.Project(t);return e.valid?e.model():null}function a(t,e,n){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState)if(r.status>=200&&r.status<300){var t=r.responseXML;t||(t=(new DOMParser).parseFromString(r.responseText,"application/xml"));var i=s(t);e(i)}else n&&n(r)},r.open("GET",t,!0),r.send()}function u(){return n.err}e.Project=i.Project,e.Model=o.Model,e.Errors=n.Errors,e.newModel=s,e.load=a,e.error=u}),e("sd")});